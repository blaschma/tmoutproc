<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.2"/>
    <title>tmoutproc.tmoutproc API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="function" href="#read_packed_matrix">read_packed_matrix</a>
            </li>
            <li>
                    <a class="function" href="#write_matrix_packed">write_matrix_packed</a>
            </li>
            <li>
                    <a class="function" href="#read_qpenergies">read_qpenergies</a>
            </li>
            <li>
                    <a class="function" href="#write_mos_file">write_mos_file</a>
            </li>
            <li>
                    <a class="function" href="#read_mos_file">read_mos_file</a>
            </li>
            <li>
                    <a class="function" href="#diag_F">diag_F</a>
            </li>
            <li>
                    <a class="function" href="#write_plot_data">write_plot_data</a>
            </li>
            <li>
                    <a class="function" href="#read_plot_data">read_plot_data</a>
            </li>
            <li>
                    <a class="function" href="#read_coord_file">read_coord_file</a>
            </li>
            <li>
                    <a class="function" href="#read_xyz_file">read_xyz_file</a>
            </li>
            <li>
                    <a class="function" href="#write_coord_file">write_coord_file</a>
            </li>
            <li>
                    <a class="function" href="#find_c_range_atom">find_c_range_atom</a>
            </li>
            <li>
                    <a class="function" href="#load_xyz_file">load_xyz_file</a>
            </li>
            <li>
                    <a class="function" href="#write_xyz_file">write_xyz_file</a>
            </li>
            <li>
                    <a class="function" href="#read_hessian">read_hessian</a>
            </li>
            <li>
                    <a class="function" href="#create_dynamical_matrix">create_dynamical_matrix</a>
            </li>
            <li>
                    <a class="function" href="#atom_weight">atom_weight</a>
            </li>
            <li>
                    <a class="function" href="#align_molecule">align_molecule</a>
            </li>
            <li>
                    <a class="function" href="#x2t">x2t</a>
            </li>
            <li>
                    <a class="function" href="#fix_atoms">fix_atoms</a>
            </li>
            <li>
                    <a class="function" href="#atom_type_to_number">atom_type_to_number</a>
            </li>
            <li>
                    <a class="function" href="#determine_n_orbitals">determine_n_orbitals</a>
            </li>
            <li>
                    <a class="function" href="#remove_fixed_atoms">remove_fixed_atoms</a>
            </li>
            <li>
                    <a class="function" href="#create_sysinfo">create_sysinfo</a>
            </li>
            <li>
                    <a class="function" href="#get_norb_from_config">get_norb_from_config</a>
            </li>
            <li>
                    <a class="function" href="#shift_xyz_coord">shift_xyz_coord</a>
            </li>
            <li>
                    <a class="function" href="#shift_coord_file">shift_coord_file</a>
            </li>
            <li>
                    <a class="function" href="#sort_xyz_coord">sort_xyz_coord</a>
            </li>
            <li>
                    <a class="function" href="#sort_coord">sort_coord</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
tmoutproc<wbr>.tmoutproc    </h1>

                        <div class="docstring"><p>Package for processing turbomole Output such as mos files</p>
</div>

                        <input id="tmoutproc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="tmoutproc-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">Package for processing turbomole Output such as mos files</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="n">__docformat__</span> <span class="o">=</span> <span class="s2">&quot;google&quot;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span> <span class="nn">fnmatch</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">import</span> <span class="nn">scipy.sparse</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">import</span> <span class="nn">re</span> <span class="k">as</span> <span class="nn">r</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eig</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">coo_matrix</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span>  <span class="n">constants</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="n">__ang2bohr__</span> <span class="o">=</span> <span class="mf">1.88973</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="k">def</span> <span class="nf">read_packed_matrix</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="sd">	read packed symmetric matrix from file and creates matrix</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="sd">	returns matrix in scipy.sparse.csc_matrix</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="sd">	Args:</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="sd">		param1 (string): filename</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd">	Example:</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">		761995      nmat</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">		   1                 1.000000000000000000000000       </span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="sd">		   2                0.9362738788014223212385900       </span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">		   3                 1.000000000000000222044605       </span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd">		   4                0.4813841609941338917089126       </span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">		   5                0.6696882728399407014308053       </span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="sd">		   6                 1.000000000000000000000000  </span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd">		   .</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="sd">		   .</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">		   .</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">	Returns:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">		scipy.sparse.csc_matrix</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">	&quot;&quot;&quot;</span>	
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>	<span class="c1">#matrix data</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a>	<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>	<span class="c1">#matrix rows, cols</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>	<span class="n">i</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>	<span class="n">j</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>	<span class="n">counter</span> <span class="o">=-</span><span class="mi">1</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>	<span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>	<span class="n">col_old</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>	<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>	<span class="c1">#open smat_ao.dat and create sparse matrix</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>			<span class="c1">#skip first line</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>				<span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>				<span class="k">continue</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>			<span class="n">line_split</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>			<span class="n">matrix_entry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">line_split</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>		
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>			<span class="c1">#calculate row and col			</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">col</span> <span class="o">==</span> <span class="n">col_old</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>				<span class="n">col_old</span> <span class="o">=</span> <span class="n">col</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>				<span class="n">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a>				<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>			<span class="c1">#skip zero elemts</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">matrix_entry</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">):</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a>				<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matrix_entry</span><span class="p">)</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>				<span class="n">i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>				<span class="n">j</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>				<span class="c1">#symmetrize matrix</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>				<span class="k">if</span><span class="p">(</span><span class="n">col</span> <span class="o">!=</span> <span class="n">row</span><span class="p">):</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>					<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matrix_entry</span><span class="p">)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>					<span class="n">i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>					<span class="n">j</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>			<span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>				
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>			<span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>	
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>	<span class="n">coo</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>	<span class="n">csc</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">coo</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>	
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>	
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>	<span class="k">return</span><span class="p">(</span><span class="n">csc</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">Test</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="k">def</span> <span class="nf">write_matrix_packed</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">):</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">	write symmetric scipy.sparse.csc_matrix in  in packed storage form</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">	Args:</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">		param1 (scipi.sparse.csc_matrix): input matrix</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">		param2 (string): filename</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">	Returns:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;writing packed matrix&quot;</span><span class="p">)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>	<span class="n">num_rows</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>	<span class="n">num_elements_to_write</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_rows</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">num_rows</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>	
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>	<span class="n">element_counter</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>	<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>	<span class="n">line_beginning_spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">12</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num_elements_to_write</span><span class="p">)))</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_beginning_spaces</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_elements_to_write</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;      nmat</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>	<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">num_rows</span><span class="p">):</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>		<span class="c1">#print(&quot;writing row &quot; +str(r))</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>		<span class="n">num_cols</span> <span class="o">=</span> <span class="n">r</span><span class="o">+</span><span class="mi">1</span>		
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>			<span class="n">matrix_element</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>			<span class="n">line_beginning_spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">20</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element_counter</span><span class="p">))))</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">matrix_element</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>				<span class="n">line_middle_spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">16</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>				<span class="n">line_middle_spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">15</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>			
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_beginning_spaces</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element_counter</span><span class="p">))</span> <span class="o">+</span> <span class="n">line_middle_spaces</span> <span class="o">+</span> <span class="n">eformat</span><span class="p">(</span><span class="n">matrix_element</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>			
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>			<span class="n">element_counter</span> <span class="o">+=</span><span class="mi">1</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;writing done&quot;</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="k">def</span> <span class="nf">read_qpenergies</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">skip_lines</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">	read qpenergies.dat and returns data of given col as list, skip_lines in beginning of file, convert to eV</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">	col = 0 qpenergies, col = 1 Kohn-Sham, 2 = GW</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">	Args:</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">		param1 (string): filename</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">		param2 (int): col=2 (column to read)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">		param3 (int): skip_lines=1 (lines without data at beginning of qpenergiesfile)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">	Returns:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">		list</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>	<span class="n">har_to_ev</span> <span class="o">=</span> <span class="mf">27.21138602</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>	<span class="n">qpenergies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>	
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[(</span><span class="n">skip_lines</span><span class="o">-</span><span class="mi">1</span><span class="p">):]]</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>	<span class="c1">#print(datContent)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>	<span class="c1">#datContent = np.transpose(datContent)</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>	<span class="c1">#print(datContent)	</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">skip_lines</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)):</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>		<span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">])</span><span class="o">/</span><span class="n">har_to_ev</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>		<span class="c1">#print(&quot;qpenergy &quot; + str(energy))</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>		<span class="n">qpenergies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>	<span class="k">return</span> <span class="n">qpenergies</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a><span class="k">def</span> <span class="nf">write_mos_file</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;mos_new.dat&quot;</span><span class="p">):</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="sd">	write mos file, requires python3</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="sd">	Args:</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">		param1 (np.array): eigenvalues</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">		param2 (np.ndarray): eigenvectors</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="sd">		param3 (string): filename=&quot;mos_new.dat&quot;</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>	<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>	<span class="c1">#header</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$scfmo    scfconv=7   format(4d20.14)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;# SCF total energy is    -6459.0496515472 a.u.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> 
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;#</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>   
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)):</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>		<span class="c1">#print(&quot;eigenvalue &quot; + str(eigenvalues[i]) + &quot;\n&quot;)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>		<span class="n">first_string</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">6</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;  a      eigenvalue=&quot;</span> <span class="o">+</span> <span class="n">eformat</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;   nsaos=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">))</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">first_string</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>		<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>		<span class="k">while</span> <span class="n">j</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">):</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>			<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>				<span class="n">num</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>				<span class="n">string_to_write</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">num</span><span class="si">:</span><span class="s2">+20.13E</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">)</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>				<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string_to_write</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>				<span class="c1">#f.write(eformat(eigenvectors[m+j,i], 14,2).replace(&quot;E&quot;, &quot;D&quot;))</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>			<span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span><span class="mi">4</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>			<span class="c1">#print(&quot;j &quot; + str(j))</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$end&quot;</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a><span class="k">def</span> <span class="nf">read_mos_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">skip_lines</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a><span class="sd">	read mos file </span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a><span class="sd">	Args:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="sd">		param1 (string): filename</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a><span class="sd">		param2 (int): skip_lines=1 (lines to skip )</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="sd">	Returns:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">		eigenvalue_list (list),eigenvector_list (np.ndarray)</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>	<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>	<span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>	<span class="n">C_vec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>	
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>	<span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>	<span class="n">eigenvalue_old</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>	<span class="n">eigenvalue</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>	<span class="n">beginning</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>	<span class="n">eigenvalue_list</span><span class="o">=</span> <span class="nb">list</span><span class="p">()</span>	
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>	<span class="n">eigenvector_list</span><span class="o">=</span> <span class="o">-</span><span class="mi">1</span>	
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>	<span class="c1">#open mos file and read linewise</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>			<span class="c1">#skip prefix lines</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>			<span class="c1">#find level and calculate A(i)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">counter</span><span class="o">&gt;</span><span class="n">skip_lines</span><span class="p">):</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>				<span class="n">index1</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;eigenvalue=&quot;</span><span class="p">))</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>				<span class="n">index2</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;nsaos=&quot;</span><span class="p">))</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>				<span class="c1">#eigenvalue and nsaos found -&gt; new orbital</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>				<span class="k">if</span><span class="p">(</span><span class="n">index1</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">index2</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>					<span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span> 
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>					<span class="c1">#find nsaos of new orbital</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>					<span class="n">nsaos</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[(</span><span class="n">index2</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;nsaos=&quot;</span><span class="p">)):</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)]))</span>	
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>					<span class="c1">#find eigenvalue of new orbital and store eigenvalue of current orbital in eigenvalue_old</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>					<span class="k">if</span><span class="p">(</span><span class="n">beginning</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>						<span class="n">eigenvalue_old</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[(</span><span class="n">index1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;eigenvalue=&quot;</span><span class="p">)):</span><span class="n">index2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">))</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>						<span class="n">eigenvalue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[(</span><span class="n">index1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;eigenvalue=&quot;</span><span class="p">)):</span><span class="n">index2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">))</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>						<span class="n">eigenvector_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nsaos</span><span class="p">,</span><span class="n">nsaos</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>						
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>						<span class="n">beginning</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>					<span class="k">else</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>						<span class="n">eigenvalue_old</span> <span class="o">=</span> <span class="n">eigenvalue</span>	
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>						
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>						<span class="n">eigenvalue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[(</span><span class="n">index1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;eigenvalue=&quot;</span><span class="p">)):</span><span class="n">index2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">))</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>												 
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>													
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>						
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>					<span class="c1">#calculate A matrix by adding A_i -&gt; processing of previous orbital		</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>					<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">C_vec</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>							
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>						<span class="n">eigenvalue_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eigenvalue_old</span><span class="p">)</span>	
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>						<span class="c1">#print(&quot;level &quot; + str(level))</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>						<span class="n">eigenvector_list</span><span class="p">[:,(</span><span class="n">level</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">C_vec</span>					
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>						<span class="n">C_vec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>					
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>					<span class="c1">#everything finished (beginning of new orbital)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>					<span class="k">continue</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>				
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>				
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>				<span class="n">line_split</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">n</span><span class="p">)]</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>				<span class="k">try</span><span class="p">:</span>							
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>					<span class="n">C_vec</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line_split</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">))</span>  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">line_split</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>				<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>					<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sorry faulty mos file &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>					<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sorry. faulty mos file&#39;</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>				<span class="c1">#print(len(C_vec))</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>				
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>			<span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>			
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>	<span class="c1">#handle last mos</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>	<span class="n">eigenvalue_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eigenvalue_old</span><span class="p">)</span>	
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>	<span class="n">eigenvector_list</span><span class="p">[:,(</span><span class="n">nsaos</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">C_vec</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>	
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>	<span class="k">return</span> <span class="n">eigenvalue_list</span><span class="p">,</span><span class="n">eigenvector_list</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="k">def</span> <span class="nf">diag_F</span><span class="p">(</span><span class="n">f_mat_path</span><span class="p">,</span> <span class="n">s_mat_path</span><span class="p">,</span> <span class="n">eigenvalue_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()):</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">	diagonalizes f mat (generalized), other eigenvalues can be used (eigenvalue_list). Solves Fx=l*S*x</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">	Args:</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">		param1 (string): filename of fmat</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">		param2 (string): filename of smat</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">		param3 (list()): eigenvalue_list (if specified eigenvalues are taken from eigenvalue_list)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a><span class="sd">	Returns:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a><span class="sd">		fmat (np.ndarray), eigenvalues (np.array), eigenvectors (matrix)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;read f&quot;</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>	<span class="n">F_mat_file</span> <span class="o">=</span> <span class="n">read_packed_matrix</span><span class="p">(</span><span class="n">f_mat_path</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;read s&quot;</span><span class="p">)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>	<span class="n">s_mat</span> <span class="o">=</span> <span class="n">read_packed_matrix</span><span class="p">(</span><span class="n">s_mat_path</span><span class="p">)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>	<span class="n">s_mat_save</span> <span class="o">=</span> <span class="n">s_mat</span>	
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diag F&quot;</span><span class="p">)</span>	
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>	
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>	
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>	<span class="c1">#Konfiguration 1 : Übereinstimmung</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>	<span class="c1">#eigenvalues, eigenvectors = np.linalg.eigh(F_mat_file.todense())</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>	<span class="c1">#Konfiguration 2 : keine Übereinstimmung (sollte eigentlich das gleiche machen wie np.linalg.eigh)</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>	<span class="c1">#eigenvalues, eigenvectors = scipy.linalg.eigh(F_mat_file.todense())</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>	<span class="c1">#Konfiguration 3: keine Übereinstimmung (generalierstes EW Problem)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>	<span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">F_mat_file</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">s_mat</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>	<span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">eigenvectors</span><span class="p">))</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>	<span class="c1">#eigenvectors = np.transpose(eigenvectors)</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>	<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>	<span class="n">eigenvalue_output_list</span> <span class="o">=</span> <span class="n">eigenvalues</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>	<span class="c1">#print(eigenvalues)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>	<span class="c1">#print(&quot;type random&quot;)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>	<span class="c1">#print(type(eigenvalues).__name__)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>	<span class="c1">#print(type(eigenvectors).__name__)</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diag F done&quot;</span><span class="p">)</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calc fmat &quot;</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>	<span class="c1">#take eigenvalues from diagonalization or external eigenvalues (e.g from qpenergies)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eigenvalue_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>		<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>	<span class="k">else</span><span class="p">:</span>		
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>		<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">eigenvalue_list</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>		<span class="n">eigenvalue_output_list</span> <span class="o">=</span> <span class="n">eigenvalue_list</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>	<span class="n">sc</span> <span class="o">=</span> <span class="n">s_mat</span> <span class="o">*</span> <span class="n">eigenvectors</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>	<span class="n">f_mat</span> <span class="o">=</span> <span class="n">eigenvalues</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>	<span class="n">f_mat</span> <span class="o">=</span> <span class="n">sc</span> <span class="o">*</span> <span class="n">f_mat</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calc fmat done&quot;</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>	
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>	<span class="k">return</span> <span class="n">f_mat</span><span class="p">,</span><span class="n">eigenvalue_output_list</span><span class="p">,</span> <span class="n">eigenvectors</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>	
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="k">def</span> <span class="nf">write_plot_data</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">	Writes data in file (eg plot data) </span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">	Args:</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a><span class="sd">		param1 (String): Filename</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">		param2 (tuple): tuple of lists (each entry is one column in data)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">		param3 (String): Fileheader</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">		</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">	Returns:</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">		</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>	<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>	<span class="c1">#file = open(new_file-path,&quot;w&quot;)</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>	<span class="c1">#print(data[0])</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>			
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;	&quot;</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>	<span class="c1">#file.write(data)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="k">def</span> <span class="nf">read_plot_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">	Reads data in file (eg plot data)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">	Args:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">		param1 (String): Filename</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">		</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">		</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">	Returns:</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">		datContent, head (Array of lists and header of file)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>	<span class="k">try</span><span class="p">:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>		<span class="nb">float</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>	<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)])</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>		<span class="c1">#for 1D-01 to 1E-01 conversion</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">defchararray</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">datContent</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datContent</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span><span class="s2">&quot;&quot;</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="k">def</span> <span class="nf">read_coord_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">	Reads data in file (eg plot data). Coordinates are converted to float. Method is implemented in this way to allow</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">	fixed and unfixed atoms and their detection by the length of the lists.</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">	</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a><span class="sd">	Args:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a><span class="sd">		param1 (String): Filename</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a><span class="sd">		</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">		</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">	Returns:</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">		array of lists [line in coordfile][0=x, 1=y, 2=z, 3=atomtype, optional: 4=fixed]</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>	<span class="c1">#filter everything but $coord information</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>	<span class="n">cut</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)):</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">):</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>			<span class="n">cut</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>			<span class="n">datContent</span><span class="o">=</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cut</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>			<span class="k">break</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>	<span class="n">datContent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datContent</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datContent</span><span class="p">):</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>	<span class="k">return</span> <span class="n">datContent</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="k">def</span> <span class="nf">read_xyz_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">	Reads data in file (eg plot data) </span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">	</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">	Args:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">		param1 (String): Filename</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">		</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">		</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">	Returns:</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">		array of lists [line in coordfile][0=x, 1=y, 2=z, 3=atomtype, optional: 4=fixed]</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>	<span class="c1">#filter everything but $coord information</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>	<span class="n">cut</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)):</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">):</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>			<span class="n">cut</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>			<span class="n">datContent</span><span class="o">=</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cut</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>			<span class="k">break</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>	<span class="n">datContent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datContent</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)])</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>	<span class="k">return</span> <span class="n">datContent</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a><span class="k">def</span> <span class="nf">write_coord_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">coord</span><span class="p">):</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a><span class="sd">	writes coord file.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a><span class="sd">	Args:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a><span class="sd">		param1 (String): filename</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a><span class="sd">		param3 (np.ndarray): dat content</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a><span class="sd">	Returns:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="sd">		</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>	<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$coord&quot;</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">):</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>		<span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="mi">5</span><span class="p">):</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coord file seems to be funny&quot;</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$user-defined bonds&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$end&quot;</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="k">def</span> <span class="nf">find_c_range_atom</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">coordfile</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;dev-SV(P)&quot;</span><span class="p">):</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a><span class="sd">	finds atoms range of expansion coef in mos file. number gives wich atoms should be found e.g. two sulfur : first number =1; second = 2</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="sd">	Args:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a><span class="sd">		param1 (String): atom type</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a><span class="sd">		param2 (int): number of atom type atom</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">		param3 (String): filename for coord file</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a><span class="sd">		param4 (String): basis_set=&quot;dev-SV(P)&quot;</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">		</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">	Returns:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a><span class="sd">		tuple (index_start, index_end)</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>	<span class="k">def</span> <span class="nf">atom_type_to_number_coeff</span><span class="p">(</span><span class="n">atom</span><span class="p">):</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>		<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">		returns ordinal number of atom</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">		Args:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">			param1 (String): atom type		</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a><span class="sd">		Returns:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="sd">			ordinal number (int)</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>			<span class="k">return</span> <span class="mi">14</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;h&quot;</span><span class="p">):</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>			<span class="k">return</span> <span class="mi">2</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;au&quot;</span><span class="p">):</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>			<span class="k">return</span> <span class="mi">25</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">):</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>			<span class="k">return</span> <span class="mi">18</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;zn&quot;</span><span class="p">):</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>			<span class="k">return</span> <span class="mi">24</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;o&quot;</span><span class="p">):</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>			<span class="k">return</span> <span class="mi">14</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;fe&quot;</span><span class="p">):</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>			<span class="k">return</span> <span class="mi">24</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;f&quot;</span><span class="p">):</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>			<span class="k">return</span> <span class="mi">14</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;cl&quot;</span><span class="p">):</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>			<span class="k">return</span> <span class="mi">18</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span><span class="p">):</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>			<span class="k">return</span> <span class="mi">32</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;i&quot;</span><span class="p">):</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>			<span class="k">return</span> <span class="mi">13</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sorry. This feature is not implemented for following atom: &#39;</span> <span class="o">+</span> <span class="n">atom</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>	<span class="n">coord_content</span> <span class="o">=</span> <span class="n">read_coord_file</span><span class="p">(</span><span class="n">coordfile</span><span class="p">)</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">basis_set</span><span class="o">==</span><span class="s2">&quot;dev-SV(P)&quot;</span><span class="p">):</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>		<span class="n">number_found_atoms_of_type</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>		<span class="n">number_expansion_coeff</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_content</span><span class="p">)):</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>			<span class="n">current_atom</span> <span class="o">=</span> <span class="n">coord_content</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">current_atom</span> <span class="o">==</span> <span class="n">atom</span><span class="p">):</span>				
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>				<span class="n">number_found_atoms_of_type</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>				<span class="k">if</span><span class="p">(</span><span class="n">number_found_atoms_of_type</span> <span class="o">==</span> <span class="n">number</span><span class="p">):</span>				
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>					<span class="k">return</span> <span class="p">(</span><span class="n">number_expansion_coeff</span><span class="p">,</span> <span class="n">number_expansion_coeff</span><span class="o">+</span><span class="n">atom_type_to_number_coeff</span><span class="p">(</span><span class="n">current_atom</span><span class="p">))</span>	
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>				<span class="n">number_expansion_coeff</span> <span class="o">+=</span> <span class="n">atom_type_to_number_coeff</span><span class="p">(</span><span class="n">current_atom</span><span class="p">)</span>				
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>				<span class="n">number_expansion_coeff</span> <span class="o">+=</span> <span class="n">atom_type_to_number_coeff</span><span class="p">(</span><span class="n">current_atom</span><span class="p">)</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sorry. Could not find the atom&#39;</span><span class="p">)</span>			
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>			
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sorry. This feature is not implemented for following basis_set: &#39;</span> <span class="o">+</span> <span class="n">basis_set</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="k">def</span> <span class="nf">load_xyz_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">	load xyz file and returns data. Returns comment line and coord data. Dat content cols: atoms=0 (Str), x=1 (float), y=2 (float), z=3 (float).</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a><span class="sd">	coord[:,i] ... Entries for atom i</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="sd">	coord[i,:] ... Atoms types (str) [i=0], x (float) [i=1], y (float) [i=2], x (float) [z=3] for all atoms</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a><span class="sd">	Args:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="sd">		param1 (String): filename</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a><span class="sd">	Returns:</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="sd">		(comment_line (String), coord (np.ndarray))</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>	<span class="n">comment_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datContent</span><span class="p">):</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>	<span class="k">return</span> <span class="p">(</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">coord</span><span class="p">)</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="k">def</span> <span class="nf">write_xyz_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">comment_line</span><span class="p">,</span> <span class="n">coord_xyz</span><span class="p">):</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">	writes xyz file.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">	Args:</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">		param1 (String): filename</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">		param2 (String): commment_line</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">		param3 (np.ndarray): dat content</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">	Returns:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">		</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>	<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)))</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">comment_line</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)):</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;	&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;	&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span> <span class="s2">&quot;	&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a><span class="k">def</span> <span class="nf">read_hessian</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a><span class="sd">	Reads hessian from turbomole format and converts it to matrix of float</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a><span class="sd">	Args:</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a><span class="sd">		param1 (String) : Filename</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a><span class="sd">		param2 (int) : Number of atoms</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a><span class="sd">	Returns:</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a><span class="sd">		np.ndarray </span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>	<span class="n">skip_lines</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[(</span><span class="n">skip_lines</span><span class="p">):]]</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>	
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>	<span class="c1">#for three dimensions 3N dimensions</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>	<span class="n">n_atoms</span> <span class="o">=</span> <span class="n">n_atoms</span><span class="o">*</span><span class="n">dimensions</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>	<span class="n">hessian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">))</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>	<span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>	<span class="c1">#output from aoforce calculation</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">7</span><span class="p">):</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>		<span class="n">lower</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>		<span class="n">aoforce_format</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>		<span class="c1"># because of $end statement</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">datContent</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>	<span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">5</span><span class="p">):</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>		<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>		<span class="n">aoforce_format</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>		<span class="n">aoforce_format</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>		<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)):</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>		<span class="c1">#handle aoforce calculation and mismatch of first lines 1 1, .., 1|10  (-&gt; read wrong)</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">aoforce_format</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>			
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>			<span class="k">try</span><span class="p">:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>				<span class="nb">int</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>			<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>				<span class="n">lower</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">j</span><span class="p">])):</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>			<span class="n">counter</span> <span class="o">+=</span><span class="mi">1</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>			<span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">counter</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">))</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>			<span class="n">col</span> <span class="o">=</span> <span class="p">(</span><span class="n">counter</span><span class="o">-</span><span class="n">row</span><span class="o">*</span><span class="n">n_atoms</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>			<span class="n">hessian</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>		<span class="c1">#reset lower for next lines</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">aoforce_format</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>			<span class="n">lower</span> <span class="o">=</span> <span class="mi">2</span>	
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>			
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">counter</span> <span class="o">!=</span> <span class="n">n_atoms</span><span class="o">**</span><span class="mi">2</span><span class="p">):</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;n_atoms wrong. Check dimensions&#39;</span><span class="p">)</span>		
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>	<span class="k">return</span> <span class="n">hessian</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="k">def</span> <span class="nf">create_dynamical_matrix</span><span class="p">(</span><span class="n">filename_hessian</span><span class="p">,</span> <span class="n">filename_coord</span><span class="p">,</span> <span class="n">t2SI</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">	Creates dynamical matrix by mass weighting hessian. Default output in turbomole format (hartree/bohr**2)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="sd">	Args:</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="sd">		param1 (String) : Filename to hessian</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">		param2 (String) : Filename to coord file (xyz or turbomole format)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">		param3 (boolean) : convert ouptput from turbomole (hartree/bohr**2) in SI units</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">		param3 (int) : number of dimensions</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="sd">	Returns:</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="sd">		np.ndarray </span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>	<span class="c1">#read atoms from file</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>	<span class="n">atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>	<span class="c1">#check if xyz or turbomoleformat is parsed</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">filename_coord</span><span class="p">,</span> <span class="s1">&#39;*.xyz&#39;</span><span class="p">)):</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">load_xyz_file</span><span class="p">(</span><span class="n">filename_coord</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>		<span class="n">atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">read_coord_file</span><span class="p">(</span><span class="n">filename_coord</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>		<span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">))]</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>	<span class="c1">#determine atom masses</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>	<span class="n">masses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">t2SI</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>			<span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_weight</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">u2kg</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>			<span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_weight</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>	<span class="c1">#create dynamical matrix by mass weighting hessian</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>	<span class="n">hessian</span> <span class="o">=</span> <span class="n">read_hessian</span><span class="p">(</span><span class="n">filename_hessian</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="n">dimensions</span><span class="p">)</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>	<span class="n">dynamical_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span><span class="o">*</span><span class="n">dimensions</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span><span class="o">*</span><span class="n">dimensions</span><span class="p">))</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span><span class="o">*</span><span class="n">dimensions</span><span class="p">):</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">t2SI</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>			<span class="c1">#har/bohr**2 -&gt; J/m**2</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>			<span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(((</span><span class="mf">1.89</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.294</span><span class="p">))</span><span class="o">*</span><span class="mi">1000</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>		<span class="n">dynamical_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">masses</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">dimensions</span><span class="p">)]</span><span class="o">*</span><span class="n">masses</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">dimensions</span><span class="p">)]))</span><span class="o">*</span><span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>			<span class="c1">#har/bohr**2 -&gt; J/m**2</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">t2SI</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>				<span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(((</span><span class="mf">1.89</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.294</span><span class="p">))</span><span class="o">*</span><span class="mi">1000</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>			<span class="n">dynamical_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">masses</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">dimensions</span><span class="p">)]</span><span class="o">*</span><span class="n">masses</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">dimensions</span><span class="p">)]))</span><span class="o">*</span><span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>			<span class="n">dynamical_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">dynamical_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>	<span class="k">return</span> <span class="n">dynamical_matrix</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="k">def</span> <span class="nf">atom_weight</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">u2kg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">    Return mass of atom in kg or au (au is default)</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">    Args:</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">        param1 (String) : Atom type</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">        param2 (boolean) : convert to kg</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">    Returns:</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">        float</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>	<span class="n">atom</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>	<span class="n">u</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">U2KG</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>	<span class="k">if</span> <span class="p">(</span><span class="n">u2kg</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>		<span class="n">u</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>	<span class="k">if</span> <span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;test&quot;</span><span class="p">):</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>		<span class="k">return</span> <span class="mf">1.0</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>	<span class="k">try</span><span class="p">:</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>		<span class="n">dict_entry</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">ATOM_DICT_SYM</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>		<span class="n">atom_weight</span> <span class="o">=</span> <span class="n">dict_entry</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>	<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>		<span class="n">error_text</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Element </span><span class="si">{</span><span class="n">atom</span><span class="si">}</span><span class="s2"> cannot be found. Raising exception </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_text</span><span class="p">)</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>	<span class="k">return</span> <span class="n">atom_weight</span> <span class="o">*</span> <span class="n">u</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="k">def</span> <span class="nf">align_molecule</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">molecule_axis</span><span class="p">):</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">	Aligns molecule stored in coord along axis. Molecule_axis[0/1] give the indices of molecules which define the molecule</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">	axis. Please note: coord = top.load_xyz_file(filename)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="sd">	Args:</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="sd">		coord: coord file read with top from xyz file (coord = op.load_xyz_file(filename)))</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">		axis: axis is aligned along axis -&gt; axis[x,y,z]</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">		molecule_axis: indices of atoms in coord which define the molecule axis (index1, index2)</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="sd">	Returns:</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="sd">	Rotated coord file</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>	<span class="c1"># calculate vec(molecule_axis[0]-&gt;molecule_axis[1])</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>	<span class="n">x_left</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>	<span class="n">y_left</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>	<span class="n">z_left</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>	<span class="c1"># shift to orgin</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_left</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_left</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">z_left</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>	<span class="n">x_left</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>	<span class="n">y_left</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>	<span class="n">z_left</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>	<span class="n">x_right</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>	<span class="n">y_right</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>	<span class="n">z_right</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>	<span class="n">molecule_axis</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_right</span> <span class="o">-</span> <span class="n">x_left</span><span class="p">,</span> <span class="n">y_right</span> <span class="o">-</span> <span class="n">y_left</span><span class="p">,</span> <span class="n">z_right</span> <span class="o">-</span> <span class="n">z_left</span><span class="p">]</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>	<span class="c1"># calculate rotation angel</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>	<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">molecule_axis</span><span class="p">))</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>	<span class="n">theta</span> <span class="o">=</span> <span class="n">angle</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>	<span class="k">if</span> <span class="p">(</span><span class="n">angle</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>		<span class="c1"># calculate rotation axis</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>		<span class="n">rotation_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">molecule_axis</span><span class="p">,</span> <span class="p">[</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>		<span class="n">rotation_axis</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rotation_axis</span><span class="p">)</span> <span class="o">*</span> <span class="n">rotation_axis</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>		<span class="n">u</span> <span class="o">=</span> <span class="n">rotation_axis</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>		<span class="c1"># print(&quot;rotation axis &quot; + str(rotation_axis))</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>		<span class="c1"># calculate rotation_matrix</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>		<span class="n">rotation_matrix</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>			<span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)),</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>			 <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>			<span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)),</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>			 <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>			<span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>			 <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))]]</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>			<span class="n">vector_to_rotate</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">),</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>								<span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)]</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>			<span class="n">rotated_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">vector_to_rotate</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>			<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">rotated_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>			<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">rotated_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>			<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">rotated_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>		<span class="k">return</span> <span class="n">coord</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>		<span class="k">return</span> <span class="n">coord</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a><span class="k">def</span> <span class="nf">x2t</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">):</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a><span class="sd">	Transforms coord_xyz from xyz format to turbomole</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">	Args:</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">		coord_xyz: coord array in xyz</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">	Returns:</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">	coord in turbomole format</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">coord_xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)):</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>		<span class="n">x</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>		<span class="n">y</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>		<span class="n">z</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>		<span class="n">element</span> <span class="o">=</span> <span class="n">coord_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">__ang2bohr__</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">__ang2bohr__</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">__ang2bohr__</span><span class="p">,</span> <span class="n">element</span><span class="p">])</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>	<span class="k">return</span> <span class="n">coord</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="k">def</span> <span class="nf">fix_atoms</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">indices</span><span class="p">):</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">	fixes atoms in indices in turbomole coord file coord</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">	Args:</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="sd">		coord: coord file read with top.read_coord_file</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">		indices: array-like of indices in coord file which should be fixed. &quot;all&quot; is also possible -&gt; every atom is fixed</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a><span class="sd">	Returns:</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">	coord with fixed atoms</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">indices</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>			<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">):</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>				<span class="n">new</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>				<span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>				<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>			<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">):</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>				<span class="n">new</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>				<span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>				<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>	<span class="k">return</span> <span class="n">coord</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="k">def</span> <span class="nf">atom_type_to_number</span><span class="p">(</span><span class="n">atom_type</span><span class="p">):</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">	returns ordinal number of atom</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">	Args:</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">		param1 (String): atom type		</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">	Returns:</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">		ordinal number (int)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;h&quot;</span><span class="p">):</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>		<span class="k">return</span> <span class="mi">1</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>		<span class="k">return</span> <span class="mi">6</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">):</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>		<span class="k">return</span> <span class="mi">7</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;o&quot;</span><span class="p">):</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>		<span class="k">return</span> <span class="mi">8</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;f&quot;</span><span class="p">):</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>		<span class="k">return</span> <span class="mi">9</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cl&quot;</span><span class="p">):</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>		<span class="k">return</span> <span class="mi">17</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span><span class="p">):</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>		<span class="k">return</span> <span class="mi">35</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;i&quot;</span><span class="p">):</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>		<span class="k">return</span> <span class="mi">53</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;au&quot;</span><span class="p">):</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>		<span class="k">return</span> <span class="mi">79</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">):</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>		<span class="k">return</span> <span class="mi">16</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;si&quot;</span><span class="p">):</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>		<span class="k">return</span> <span class="mi">14</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry I do not know this atom yet&quot;</span><span class="p">)</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="k">def</span> <span class="nf">determine_n_orbitals</span><span class="p">(</span><span class="n">coord_path</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;dev-SV(P)&quot;</span><span class="p">):</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">	Determines number of orbitals for calculation using coord file (turbomole format, xyz support is planned) and basis set.</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">	Args:</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">		coord_path (String): path to coord file (turbomole coord file)</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">		basis_set (String): basis set</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">	Returns:</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">		n_orbitals (int): Number of orbitals</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">basis_set</span><span class="o">!=</span><span class="s2">&quot;dev-SV(P)&quot;</span><span class="p">):</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only support for dev-SV(P) Basis set right now.&quot;</span><span class="p">)</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">read_coord_file</span><span class="p">(</span><span class="n">coord_path</span><span class="p">)</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>	<span class="n">atom_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>	<span class="n">ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>			<span class="n">atom_dict</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>			<span class="n">atom_dict</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>		<span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">find_c_range_atom</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">atom_dict</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">coord_path</span><span class="p">)</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>		<span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>	<span class="n">n_orbitals</span> <span class="o">=</span> <span class="n">ranges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>	<span class="k">return</span> <span class="n">n_orbitals</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="k">def</span> <span class="nf">remove_fixed_atoms</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">	Removes fixed atoms from turbomole coord file. </span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">	Args:</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">		coord: coord file data loaded with read_coord_file</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">	Returns:</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">		coord: filtered coord file data</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>	<span class="n">coord_filtered</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">):</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>			<span class="n">coord_filtered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_filtered</span><span class="p">)</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="k">def</span> <span class="nf">create_sysinfo</span><span class="p">(</span><span class="n">coord_path</span><span class="p">,</span> <span class="n">basis_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">):</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">	Create sysinfo according to given template. Sysinfo is used for transport calculations used by Theo 1 Group of</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">	University of Augsburg. It contains information about the orbitals, the charge, number of ecps and the coordinates of the positions</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">	{number atom} {orbital_index_start} {orbital_index_end} {charge} {number ecps} {x in Bohr} {y in Bohr} {z in Bohr}</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">	Args:</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a><span class="sd">		coord_path (String): Path to turbomole coord file</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">		basis_path (String): Path to turbomole basis file</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a><span class="sd">		output_path (String): Path where sysinfo is written</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="sd">	Returns:</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">read_coord_file</span><span class="p">(</span><span class="s1">&#39;coord&#39;</span><span class="p">)</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>	<span class="c1"># number of atoms:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>	<span class="n">natoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>	<span class="c1"># split cd into position array and element vector</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>	<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>	<span class="n">el</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>		<span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>		<span class="n">el</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>	<span class="c1"># make list from dictionary from list el</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>	<span class="c1"># --&gt; get rid of the douplicates</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>	<span class="c1"># eldif is a list of all different elements in coord</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>	<span class="n">eldif</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">el</span><span class="p">))</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>	<span class="c1"># dictionary for Number of orbitals:</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>	<span class="n">Norb_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">eldif</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>	<span class="c1"># dictionary for Number of ECP-electrons:</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>	<span class="n">Necp_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">eldif</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>	<span class="k">for</span> <span class="n">elkind</span> <span class="ow">in</span> <span class="n">eldif</span><span class="p">:</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>		<span class="n">nf</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>		<span class="c1"># the space in searchstr is to avoid additional findings (e.g. for s)</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>		<span class="n">searchstr</span> <span class="o">=</span> <span class="n">elkind</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>		<span class="c1"># search for element in file &#39;basis&#39;</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;basis&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>			<span class="n">lines</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>			<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>				<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">searchstr</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>					<span class="n">nf</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>					<span class="k">if</span> <span class="p">(</span><span class="n">nf</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>						<span class="c1"># first occurence: name of basis set</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>						<span class="k">continue</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>					<span class="k">if</span> <span class="p">(</span><span class="n">nf</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>						<span class="c1"># second occurence electron configuration per atom</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>						<span class="c1"># this might look weird but leads to the part</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>						<span class="c1"># inside the []-brackets</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>						<span class="n">config</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>						<span class="n">Norb_dict</span><span class="p">[</span><span class="n">elkind</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_norb_from_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>					<span class="k">if</span> <span class="p">(</span><span class="n">nf</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>						<span class="c1"># third occurence: information on core-potential</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>						<span class="c1"># number of core electrons is 2 lines after that</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>						<span class="n">nl_ecp</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>						<span class="c1"># get number of core electrons</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>						<span class="n">N_ecp</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">nl_ecp</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>						<span class="c1"># save this number in corresponding dictionary</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>						<span class="n">Necp_dict</span><span class="p">[</span><span class="n">elkind</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_ecp</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>	<span class="n">iorb</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">natoms</span><span class="si">:</span><span class="s2">&gt;22</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>		<span class="k">for</span> <span class="n">iat</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>			<span class="n">atomic_number</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">ATOM_DICT_SYM</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>			<span class="n">charge</span> <span class="o">=</span> <span class="n">atomic_number</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">Necp_dict</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]])</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">iat</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">iorb</span> <span class="o">+</span> <span class="mi">1</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">iorb</span> <span class="o">+</span> <span class="n">Norb_dict</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]]</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">charge</span><span class="si">:</span><span class="s2">&gt;24.12f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">Necp_dict</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]]</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pos</span><span class="p">[</span><span class="n">iat</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;24</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pos</span><span class="p">[</span><span class="n">iat</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;24</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pos</span><span class="p">[</span><span class="n">iat</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;24</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>			<span class="n">iorb</span> <span class="o">=</span> <span class="n">iorb</span> <span class="o">+</span> <span class="n">Norb_dict</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]]</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="k">def</span> <span class="nf">get_norb_from_config</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">	Get number of orbitals from turbomole config string (for example [6s3p2d])</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">	Args:</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">		config (String): configuration string</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">	Returns:</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="sd">		Norb (int): Number of orbitals</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>	<span class="n">orbital_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>	<span class="n">orbital_degeneracy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>	<span class="n">number_of_orbital_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_types</span><span class="p">))</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_types</span><span class="p">)):</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>		<span class="n">ns</span><span class="p">,</span> <span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">orbital_types</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>		<span class="n">ns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>		<span class="n">number_of_orbital_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ns</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>		<span class="k">if</span> <span class="n">config</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>			<span class="k">break</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>	<span class="k">if</span> <span class="p">(</span><span class="n">config</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is something wrong with this configuration&quot;</span><span class="p">)</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>	<span class="n">Norb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">number_of_orbital_types</span><span class="o">*</span><span class="n">orbital_degeneracy</span><span class="p">)</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>	<span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">Norb</span><span class="p">)</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="k">def</span> <span class="nf">shift_xyz_coord</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">,</span> <span class="n">x_shift</span><span class="p">,</span> <span class="n">y_shift</span><span class="p">,</span> <span class="n">z_shift</span><span class="p">):</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">	Shifts coordinates in coord file loaded with load_xyz_file.</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">	Args:</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">		coord_xyz: Coord file loaded with load_xyz_file</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">		x_shift: x shift in Angstrom</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">		y_shift: y shift in Angstrom</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">		z_shift: z shift in Angstrom</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">	Returns:</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">		coord_xyz: Shifted xyz coord file</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>	<span class="k">try</span><span class="p">:</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;coord file is empty&quot;</span><span class="p">)</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>	<span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is it a xyz file? </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>	<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is it a xyz file? </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])):</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>		<span class="n">coord_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="n">x_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>		<span class="n">coord_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="n">y_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>		<span class="n">coord_xyz</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="n">z_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>	<span class="k">return</span> <span class="n">coord_xyz</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="k">def</span> <span class="nf">shift_coord_file</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">x_shift</span><span class="p">,</span> <span class="n">y_shift</span><span class="p">,</span> <span class="n">z_shift</span><span class="p">):</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a><span class="sd">	Shifts coordinates in coord file loaded with read_coord_file.</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">	Args:</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="sd">		coord_xyz: Coord file loaded with read_coord_file</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="sd">		x_shift: x shift in Bohr</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">		y_shift: y shift in Bohr</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">		z_shift: z shift in Bohr</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="sd">	Returns:</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a><span class="sd">		coord: Shifted coord file</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;coord file is empty&quot;</span><span class="p">)</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">x_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">y_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">z_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>	<span class="k">return</span> <span class="n">coord</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="k">def</span> <span class="nf">sort_xyz_coord</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">	Sort coord_xyz according to axis (x=0, y=1, z=2)</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">	Args:</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="sd">		coord_xyz: Coord file loaded with load_xyz_file</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">		axis: Axis (x=0, y=1, z=2)</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">	Returns:</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="sd">		coord_xyz: Sorted coord_xyz</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>	<span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">):</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Axis </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2"> not valid.&quot;</span><span class="p">)</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>	<span class="n">coord_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>	<span class="n">coord_xyz</span> <span class="o">=</span> <span class="n">coord_xyz</span><span class="p">[</span><span class="n">coord_xyz</span><span class="p">[:,</span> <span class="n">axis</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>	<span class="n">coord_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>	<span class="k">return</span> <span class="n">coord_xyz</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="k">def</span> <span class="nf">sort_coord</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">	Sort coord_xyz according to axis (x=0, y=1, z=2)</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">	Args:</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">		coord_xyz: Coord file loaded with load_xyz_file</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">		axis: Axis (x=0, y=1, z=2)</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">	Returns:</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a><span class="sd">		coord_xyz: Sorted coord_xyz</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>	<span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">):</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Axis </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2"> not valid.&quot;</span><span class="p">)</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>	<span class="k">return</span> <span class="n">coord</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>	
</span></pre></div>


            </section>
                <section id="read_packed_matrix">
                            <input id="read_packed_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_packed_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span></span>)</span>

                <label class="view-source-button" for="read_packed_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_packed_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_packed_matrix-21"><a href="#read_packed_matrix-21"><span class="linenos">21</span></a><span class="k">def</span> <span class="nf">read_packed_matrix</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="read_packed_matrix-22"><a href="#read_packed_matrix-22"><span class="linenos">22</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_packed_matrix-23"><a href="#read_packed_matrix-23"><span class="linenos">23</span></a><span class="sd">	read packed symmetric matrix from file and creates matrix</span>
</span><span id="read_packed_matrix-24"><a href="#read_packed_matrix-24"><span class="linenos">24</span></a><span class="sd">	returns matrix in scipy.sparse.csc_matrix</span>
</span><span id="read_packed_matrix-25"><a href="#read_packed_matrix-25"><span class="linenos">25</span></a><span class="sd">	Args:</span>
</span><span id="read_packed_matrix-26"><a href="#read_packed_matrix-26"><span class="linenos">26</span></a><span class="sd">		param1 (string): filename</span>
</span><span id="read_packed_matrix-27"><a href="#read_packed_matrix-27"><span class="linenos">27</span></a>
</span><span id="read_packed_matrix-28"><a href="#read_packed_matrix-28"><span class="linenos">28</span></a>
</span><span id="read_packed_matrix-29"><a href="#read_packed_matrix-29"><span class="linenos">29</span></a><span class="sd">	Example:</span>
</span><span id="read_packed_matrix-30"><a href="#read_packed_matrix-30"><span class="linenos">30</span></a><span class="sd">		761995      nmat</span>
</span><span id="read_packed_matrix-31"><a href="#read_packed_matrix-31"><span class="linenos">31</span></a><span class="sd">		   1                 1.000000000000000000000000       </span>
</span><span id="read_packed_matrix-32"><a href="#read_packed_matrix-32"><span class="linenos">32</span></a><span class="sd">		   2                0.9362738788014223212385900       </span>
</span><span id="read_packed_matrix-33"><a href="#read_packed_matrix-33"><span class="linenos">33</span></a><span class="sd">		   3                 1.000000000000000222044605       </span>
</span><span id="read_packed_matrix-34"><a href="#read_packed_matrix-34"><span class="linenos">34</span></a><span class="sd">		   4                0.4813841609941338917089126       </span>
</span><span id="read_packed_matrix-35"><a href="#read_packed_matrix-35"><span class="linenos">35</span></a><span class="sd">		   5                0.6696882728399407014308053       </span>
</span><span id="read_packed_matrix-36"><a href="#read_packed_matrix-36"><span class="linenos">36</span></a><span class="sd">		   6                 1.000000000000000000000000  </span>
</span><span id="read_packed_matrix-37"><a href="#read_packed_matrix-37"><span class="linenos">37</span></a><span class="sd">		   .</span>
</span><span id="read_packed_matrix-38"><a href="#read_packed_matrix-38"><span class="linenos">38</span></a><span class="sd">		   .</span>
</span><span id="read_packed_matrix-39"><a href="#read_packed_matrix-39"><span class="linenos">39</span></a><span class="sd">		   .</span>
</span><span id="read_packed_matrix-40"><a href="#read_packed_matrix-40"><span class="linenos">40</span></a>
</span><span id="read_packed_matrix-41"><a href="#read_packed_matrix-41"><span class="linenos">41</span></a><span class="sd">	Returns:</span>
</span><span id="read_packed_matrix-42"><a href="#read_packed_matrix-42"><span class="linenos">42</span></a><span class="sd">		scipy.sparse.csc_matrix</span>
</span><span id="read_packed_matrix-43"><a href="#read_packed_matrix-43"><span class="linenos">43</span></a>
</span><span id="read_packed_matrix-44"><a href="#read_packed_matrix-44"><span class="linenos">44</span></a><span class="sd">	&quot;&quot;&quot;</span>	
</span><span id="read_packed_matrix-45"><a href="#read_packed_matrix-45"><span class="linenos">45</span></a>	<span class="c1">#matrix data</span>
</span><span id="read_packed_matrix-46"><a href="#read_packed_matrix-46"><span class="linenos">46</span></a>	<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="read_packed_matrix-47"><a href="#read_packed_matrix-47"><span class="linenos">47</span></a>	<span class="c1">#matrix rows, cols</span>
</span><span id="read_packed_matrix-48"><a href="#read_packed_matrix-48"><span class="linenos">48</span></a>	<span class="n">i</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="read_packed_matrix-49"><a href="#read_packed_matrix-49"><span class="linenos">49</span></a>	<span class="n">j</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="read_packed_matrix-50"><a href="#read_packed_matrix-50"><span class="linenos">50</span></a>
</span><span id="read_packed_matrix-51"><a href="#read_packed_matrix-51"><span class="linenos">51</span></a>	<span class="n">counter</span> <span class="o">=-</span><span class="mi">1</span>
</span><span id="read_packed_matrix-52"><a href="#read_packed_matrix-52"><span class="linenos">52</span></a>	<span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_packed_matrix-53"><a href="#read_packed_matrix-53"><span class="linenos">53</span></a>	<span class="n">col_old</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_packed_matrix-54"><a href="#read_packed_matrix-54"><span class="linenos">54</span></a>	<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="read_packed_matrix-55"><a href="#read_packed_matrix-55"><span class="linenos">55</span></a>	<span class="c1">#open smat_ao.dat and create sparse matrix</span>
</span><span id="read_packed_matrix-56"><a href="#read_packed_matrix-56"><span class="linenos">56</span></a>	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="read_packed_matrix-57"><a href="#read_packed_matrix-57"><span class="linenos">57</span></a>		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span><span id="read_packed_matrix-58"><a href="#read_packed_matrix-58"><span class="linenos">58</span></a>			<span class="c1">#skip first line</span>
</span><span id="read_packed_matrix-59"><a href="#read_packed_matrix-59"><span class="linenos">59</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span><span id="read_packed_matrix-60"><a href="#read_packed_matrix-60"><span class="linenos">60</span></a>				<span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="read_packed_matrix-61"><a href="#read_packed_matrix-61"><span class="linenos">61</span></a>				<span class="k">continue</span>
</span><span id="read_packed_matrix-62"><a href="#read_packed_matrix-62"><span class="linenos">62</span></a>			<span class="n">line_split</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span><span id="read_packed_matrix-63"><a href="#read_packed_matrix-63"><span class="linenos">63</span></a>			<span class="n">matrix_entry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">(</span><span class="n">line_split</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>		
</span><span id="read_packed_matrix-64"><a href="#read_packed_matrix-64"><span class="linenos">64</span></a>
</span><span id="read_packed_matrix-65"><a href="#read_packed_matrix-65"><span class="linenos">65</span></a>			<span class="c1">#calculate row and col			</span>
</span><span id="read_packed_matrix-66"><a href="#read_packed_matrix-66"><span class="linenos">66</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">col</span> <span class="o">==</span> <span class="n">col_old</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span><span id="read_packed_matrix-67"><a href="#read_packed_matrix-67"><span class="linenos">67</span></a>				<span class="n">col_old</span> <span class="o">=</span> <span class="n">col</span>
</span><span id="read_packed_matrix-68"><a href="#read_packed_matrix-68"><span class="linenos">68</span></a>				<span class="n">col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="read_packed_matrix-69"><a href="#read_packed_matrix-69"><span class="linenos">69</span></a>				<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="read_packed_matrix-70"><a href="#read_packed_matrix-70"><span class="linenos">70</span></a>
</span><span id="read_packed_matrix-71"><a href="#read_packed_matrix-71"><span class="linenos">71</span></a>			<span class="c1">#skip zero elemts</span>
</span><span id="read_packed_matrix-72"><a href="#read_packed_matrix-72"><span class="linenos">72</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">matrix_entry</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">):</span>
</span><span id="read_packed_matrix-73"><a href="#read_packed_matrix-73"><span class="linenos">73</span></a>				<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matrix_entry</span><span class="p">)</span>
</span><span id="read_packed_matrix-74"><a href="#read_packed_matrix-74"><span class="linenos">74</span></a>				<span class="n">i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="read_packed_matrix-75"><a href="#read_packed_matrix-75"><span class="linenos">75</span></a>				<span class="n">j</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="read_packed_matrix-76"><a href="#read_packed_matrix-76"><span class="linenos">76</span></a>				<span class="c1">#symmetrize matrix</span>
</span><span id="read_packed_matrix-77"><a href="#read_packed_matrix-77"><span class="linenos">77</span></a>				<span class="k">if</span><span class="p">(</span><span class="n">col</span> <span class="o">!=</span> <span class="n">row</span><span class="p">):</span>
</span><span id="read_packed_matrix-78"><a href="#read_packed_matrix-78"><span class="linenos">78</span></a>					<span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matrix_entry</span><span class="p">)</span>
</span><span id="read_packed_matrix-79"><a href="#read_packed_matrix-79"><span class="linenos">79</span></a>					<span class="n">i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="read_packed_matrix-80"><a href="#read_packed_matrix-80"><span class="linenos">80</span></a>					<span class="n">j</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="read_packed_matrix-81"><a href="#read_packed_matrix-81"><span class="linenos">81</span></a>			<span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>				
</span><span id="read_packed_matrix-82"><a href="#read_packed_matrix-82"><span class="linenos">82</span></a>			<span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="read_packed_matrix-83"><a href="#read_packed_matrix-83"><span class="linenos">83</span></a>
</span><span id="read_packed_matrix-84"><a href="#read_packed_matrix-84"><span class="linenos">84</span></a>	
</span><span id="read_packed_matrix-85"><a href="#read_packed_matrix-85"><span class="linenos">85</span></a>	<span class="n">coo</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">row</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span><span id="read_packed_matrix-86"><a href="#read_packed_matrix-86"><span class="linenos">86</span></a>	<span class="n">csc</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">sparse</span><span class="o">.</span><span class="n">csc_matrix</span><span class="p">(</span><span class="n">coo</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span>	
</span><span id="read_packed_matrix-87"><a href="#read_packed_matrix-87"><span class="linenos">87</span></a>	
</span><span id="read_packed_matrix-88"><a href="#read_packed_matrix-88"><span class="linenos">88</span></a>	<span class="k">return</span><span class="p">(</span><span class="n">csc</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>read packed symmetric matrix from file and creates matrix
returns matrix in scipy.sparse.csc_matrix</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (string):</strong>  filename</li>
</ul>

<h6 id="example">Example</h6>

<blockquote>
  <p>761995      nmat
     1                 1.000000000000000000000000 <br />
     2                0.9362738788014223212385900 <br />
     3                 1.000000000000000222044605 <br />
     4                0.4813841609941338917089126 <br />
     5                0.6696882728399407014308053 <br />
     6                 1.000000000000000000000000 <br />
     .
     .
     .</p>
</blockquote>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>scipy.sparse.csc_matrix</p>
</blockquote>
</div>


                </section>
                <section id="write_matrix_packed">
                            <input id="write_matrix_packed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_matrix_packed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">matrix</span>, </span><span class="param"><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;test&#39;</span></span>)</span>

                <label class="view-source-button" for="write_matrix_packed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_matrix_packed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_matrix_packed-95"><a href="#write_matrix_packed-95"><span class="linenos"> 95</span></a><span class="k">def</span> <span class="nf">write_matrix_packed</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">):</span>
</span><span id="write_matrix_packed-96"><a href="#write_matrix_packed-96"><span class="linenos"> 96</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="write_matrix_packed-97"><a href="#write_matrix_packed-97"><span class="linenos"> 97</span></a><span class="sd">	write symmetric scipy.sparse.csc_matrix in  in packed storage form</span>
</span><span id="write_matrix_packed-98"><a href="#write_matrix_packed-98"><span class="linenos"> 98</span></a>
</span><span id="write_matrix_packed-99"><a href="#write_matrix_packed-99"><span class="linenos"> 99</span></a><span class="sd">	Args:</span>
</span><span id="write_matrix_packed-100"><a href="#write_matrix_packed-100"><span class="linenos">100</span></a><span class="sd">		param1 (scipi.sparse.csc_matrix): input matrix</span>
</span><span id="write_matrix_packed-101"><a href="#write_matrix_packed-101"><span class="linenos">101</span></a><span class="sd">		param2 (string): filename</span>
</span><span id="write_matrix_packed-102"><a href="#write_matrix_packed-102"><span class="linenos">102</span></a>
</span><span id="write_matrix_packed-103"><a href="#write_matrix_packed-103"><span class="linenos">103</span></a><span class="sd">	Returns:</span>
</span><span id="write_matrix_packed-104"><a href="#write_matrix_packed-104"><span class="linenos">104</span></a>
</span><span id="write_matrix_packed-105"><a href="#write_matrix_packed-105"><span class="linenos">105</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="write_matrix_packed-106"><a href="#write_matrix_packed-106"><span class="linenos">106</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;writing packed matrix&quot;</span><span class="p">)</span>
</span><span id="write_matrix_packed-107"><a href="#write_matrix_packed-107"><span class="linenos">107</span></a>	<span class="n">num_rows</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="write_matrix_packed-108"><a href="#write_matrix_packed-108"><span class="linenos">108</span></a>	<span class="n">num_elements_to_write</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_rows</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">num_rows</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>	
</span><span id="write_matrix_packed-109"><a href="#write_matrix_packed-109"><span class="linenos">109</span></a>
</span><span id="write_matrix_packed-110"><a href="#write_matrix_packed-110"><span class="linenos">110</span></a>
</span><span id="write_matrix_packed-111"><a href="#write_matrix_packed-111"><span class="linenos">111</span></a>	<span class="n">element_counter</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="write_matrix_packed-112"><a href="#write_matrix_packed-112"><span class="linenos">112</span></a>	<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="write_matrix_packed-113"><a href="#write_matrix_packed-113"><span class="linenos">113</span></a>
</span><span id="write_matrix_packed-114"><a href="#write_matrix_packed-114"><span class="linenos">114</span></a>	<span class="n">line_beginning_spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">12</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num_elements_to_write</span><span class="p">)))</span>
</span><span id="write_matrix_packed-115"><a href="#write_matrix_packed-115"><span class="linenos">115</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_beginning_spaces</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_elements_to_write</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;      nmat</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_matrix_packed-116"><a href="#write_matrix_packed-116"><span class="linenos">116</span></a>
</span><span id="write_matrix_packed-117"><a href="#write_matrix_packed-117"><span class="linenos">117</span></a>	<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">num_rows</span><span class="p">):</span>
</span><span id="write_matrix_packed-118"><a href="#write_matrix_packed-118"><span class="linenos">118</span></a>		<span class="c1">#print(&quot;writing row &quot; +str(r))</span>
</span><span id="write_matrix_packed-119"><a href="#write_matrix_packed-119"><span class="linenos">119</span></a>		<span class="n">num_cols</span> <span class="o">=</span> <span class="n">r</span><span class="o">+</span><span class="mi">1</span>		
</span><span id="write_matrix_packed-120"><a href="#write_matrix_packed-120"><span class="linenos">120</span></a>		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">):</span>
</span><span id="write_matrix_packed-121"><a href="#write_matrix_packed-121"><span class="linenos">121</span></a>			<span class="n">matrix_element</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">]</span>
</span><span id="write_matrix_packed-122"><a href="#write_matrix_packed-122"><span class="linenos">122</span></a>			<span class="n">line_beginning_spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">20</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element_counter</span><span class="p">))))</span>
</span><span id="write_matrix_packed-123"><a href="#write_matrix_packed-123"><span class="linenos">123</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">matrix_element</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="write_matrix_packed-124"><a href="#write_matrix_packed-124"><span class="linenos">124</span></a>				<span class="n">line_middle_spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">16</span>
</span><span id="write_matrix_packed-125"><a href="#write_matrix_packed-125"><span class="linenos">125</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="write_matrix_packed-126"><a href="#write_matrix_packed-126"><span class="linenos">126</span></a>				<span class="n">line_middle_spaces</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">15</span>
</span><span id="write_matrix_packed-127"><a href="#write_matrix_packed-127"><span class="linenos">127</span></a>			
</span><span id="write_matrix_packed-128"><a href="#write_matrix_packed-128"><span class="linenos">128</span></a>			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_beginning_spaces</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element_counter</span><span class="p">))</span> <span class="o">+</span> <span class="n">line_middle_spaces</span> <span class="o">+</span> <span class="n">eformat</span><span class="p">(</span><span class="n">matrix_element</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>			
</span><span id="write_matrix_packed-129"><a href="#write_matrix_packed-129"><span class="linenos">129</span></a>			<span class="n">element_counter</span> <span class="o">+=</span><span class="mi">1</span>
</span><span id="write_matrix_packed-130"><a href="#write_matrix_packed-130"><span class="linenos">130</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="write_matrix_packed-131"><a href="#write_matrix_packed-131"><span class="linenos">131</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;writing done&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>write symmetric scipy.sparse.csc_matrix in  in packed storage form</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (scipi.sparse.csc_matrix):</strong>  input matrix</li>
<li><strong>param2 (string):</strong>  filename</li>
</ul>

<p>Returns:</p>
</div>


                </section>
                <section id="read_qpenergies">
                            <input id="read_qpenergies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_qpenergies</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">col</span><span class="o">=</span><span class="mi">1</span>, </span><span class="param"><span class="n">skip_lines</span><span class="o">=</span><span class="mi">1</span></span>)</span>

                <label class="view-source-button" for="read_qpenergies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_qpenergies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_qpenergies-134"><a href="#read_qpenergies-134"><span class="linenos">134</span></a><span class="k">def</span> <span class="nf">read_qpenergies</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">skip_lines</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="read_qpenergies-135"><a href="#read_qpenergies-135"><span class="linenos">135</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_qpenergies-136"><a href="#read_qpenergies-136"><span class="linenos">136</span></a><span class="sd">	read qpenergies.dat and returns data of given col as list, skip_lines in beginning of file, convert to eV</span>
</span><span id="read_qpenergies-137"><a href="#read_qpenergies-137"><span class="linenos">137</span></a><span class="sd">	col = 0 qpenergies, col = 1 Kohn-Sham, 2 = GW</span>
</span><span id="read_qpenergies-138"><a href="#read_qpenergies-138"><span class="linenos">138</span></a>
</span><span id="read_qpenergies-139"><a href="#read_qpenergies-139"><span class="linenos">139</span></a><span class="sd">	Args:</span>
</span><span id="read_qpenergies-140"><a href="#read_qpenergies-140"><span class="linenos">140</span></a><span class="sd">		param1 (string): filename</span>
</span><span id="read_qpenergies-141"><a href="#read_qpenergies-141"><span class="linenos">141</span></a><span class="sd">		param2 (int): col=2 (column to read)</span>
</span><span id="read_qpenergies-142"><a href="#read_qpenergies-142"><span class="linenos">142</span></a><span class="sd">		param3 (int): skip_lines=1 (lines without data at beginning of qpenergiesfile)</span>
</span><span id="read_qpenergies-143"><a href="#read_qpenergies-143"><span class="linenos">143</span></a>
</span><span id="read_qpenergies-144"><a href="#read_qpenergies-144"><span class="linenos">144</span></a><span class="sd">	Returns:</span>
</span><span id="read_qpenergies-145"><a href="#read_qpenergies-145"><span class="linenos">145</span></a><span class="sd">		list</span>
</span><span id="read_qpenergies-146"><a href="#read_qpenergies-146"><span class="linenos">146</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="read_qpenergies-147"><a href="#read_qpenergies-147"><span class="linenos">147</span></a>
</span><span id="read_qpenergies-148"><a href="#read_qpenergies-148"><span class="linenos">148</span></a>	<span class="n">har_to_ev</span> <span class="o">=</span> <span class="mf">27.21138602</span>
</span><span id="read_qpenergies-149"><a href="#read_qpenergies-149"><span class="linenos">149</span></a>	<span class="n">qpenergies</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>	
</span><span id="read_qpenergies-150"><a href="#read_qpenergies-150"><span class="linenos">150</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[(</span><span class="n">skip_lines</span><span class="o">-</span><span class="mi">1</span><span class="p">):]]</span>
</span><span id="read_qpenergies-151"><a href="#read_qpenergies-151"><span class="linenos">151</span></a>	<span class="c1">#print(datContent)</span>
</span><span id="read_qpenergies-152"><a href="#read_qpenergies-152"><span class="linenos">152</span></a>	<span class="c1">#datContent = np.transpose(datContent)</span>
</span><span id="read_qpenergies-153"><a href="#read_qpenergies-153"><span class="linenos">153</span></a>	<span class="c1">#print(datContent)	</span>
</span><span id="read_qpenergies-154"><a href="#read_qpenergies-154"><span class="linenos">154</span></a>
</span><span id="read_qpenergies-155"><a href="#read_qpenergies-155"><span class="linenos">155</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">skip_lines</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)):</span>
</span><span id="read_qpenergies-156"><a href="#read_qpenergies-156"><span class="linenos">156</span></a>		<span class="n">energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">])</span><span class="o">/</span><span class="n">har_to_ev</span>
</span><span id="read_qpenergies-157"><a href="#read_qpenergies-157"><span class="linenos">157</span></a>		<span class="c1">#print(&quot;qpenergy &quot; + str(energy))</span>
</span><span id="read_qpenergies-158"><a href="#read_qpenergies-158"><span class="linenos">158</span></a>		<span class="n">qpenergies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">energy</span><span class="p">)</span>
</span><span id="read_qpenergies-159"><a href="#read_qpenergies-159"><span class="linenos">159</span></a>	<span class="k">return</span> <span class="n">qpenergies</span>
</span></pre></div>


            <div class="docstring"><p>read qpenergies.dat and returns data of given col as list, skip_lines in beginning of file, convert to eV
col = 0 qpenergies, col = 1 Kohn-Sham, 2 = GW</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (string):</strong>  filename</li>
<li><strong>param2 (int):</strong>  col=2 (column to read)</li>
<li><strong>param3 (int):</strong>  skip_lines=1 (lines without data at beginning of qpenergiesfile)</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>list</p>
</blockquote>
</div>


                </section>
                <section id="write_mos_file">
                            <input id="write_mos_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_mos_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">eigenvalues</span>, </span><span class="param"><span class="n">eigenvectors</span>, </span><span class="param"><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;mos_new.dat&#39;</span></span>)</span>

                <label class="view-source-button" for="write_mos_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_mos_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_mos_file-166"><a href="#write_mos_file-166"><span class="linenos">166</span></a><span class="k">def</span> <span class="nf">write_mos_file</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;mos_new.dat&quot;</span><span class="p">):</span>
</span><span id="write_mos_file-167"><a href="#write_mos_file-167"><span class="linenos">167</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="write_mos_file-168"><a href="#write_mos_file-168"><span class="linenos">168</span></a><span class="sd">	write mos file, requires python3</span>
</span><span id="write_mos_file-169"><a href="#write_mos_file-169"><span class="linenos">169</span></a>
</span><span id="write_mos_file-170"><a href="#write_mos_file-170"><span class="linenos">170</span></a><span class="sd">	Args:</span>
</span><span id="write_mos_file-171"><a href="#write_mos_file-171"><span class="linenos">171</span></a><span class="sd">		param1 (np.array): eigenvalues</span>
</span><span id="write_mos_file-172"><a href="#write_mos_file-172"><span class="linenos">172</span></a><span class="sd">		param2 (np.ndarray): eigenvectors</span>
</span><span id="write_mos_file-173"><a href="#write_mos_file-173"><span class="linenos">173</span></a><span class="sd">		param3 (string): filename=&quot;mos_new.dat&quot;</span>
</span><span id="write_mos_file-174"><a href="#write_mos_file-174"><span class="linenos">174</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="write_mos_file-175"><a href="#write_mos_file-175"><span class="linenos">175</span></a>	<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="write_mos_file-176"><a href="#write_mos_file-176"><span class="linenos">176</span></a>	<span class="c1">#header</span>
</span><span id="write_mos_file-177"><a href="#write_mos_file-177"><span class="linenos">177</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$scfmo    scfconv=7   format(4d20.14)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_mos_file-178"><a href="#write_mos_file-178"><span class="linenos">178</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;# SCF total energy is    -6459.0496515472 a.u.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> 
</span><span id="write_mos_file-179"><a href="#write_mos_file-179"><span class="linenos">179</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;#</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>   
</span><span id="write_mos_file-180"><a href="#write_mos_file-180"><span class="linenos">180</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)):</span>
</span><span id="write_mos_file-181"><a href="#write_mos_file-181"><span class="linenos">181</span></a>		<span class="c1">#print(&quot;eigenvalue &quot; + str(eigenvalues[i]) + &quot;\n&quot;)</span>
</span><span id="write_mos_file-182"><a href="#write_mos_file-182"><span class="linenos">182</span></a>		<span class="n">first_string</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">6</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;  a      eigenvalue=&quot;</span> <span class="o">+</span> <span class="n">eformat</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;   nsaos=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">))</span>
</span><span id="write_mos_file-183"><a href="#write_mos_file-183"><span class="linenos">183</span></a>		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">first_string</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_mos_file-184"><a href="#write_mos_file-184"><span class="linenos">184</span></a>		<span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="write_mos_file-185"><a href="#write_mos_file-185"><span class="linenos">185</span></a>		<span class="k">while</span> <span class="n">j</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">):</span>
</span><span id="write_mos_file-186"><a href="#write_mos_file-186"><span class="linenos">186</span></a>			<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
</span><span id="write_mos_file-187"><a href="#write_mos_file-187"><span class="linenos">187</span></a>				<span class="n">num</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
</span><span id="write_mos_file-188"><a href="#write_mos_file-188"><span class="linenos">188</span></a>				<span class="n">string_to_write</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">num</span><span class="si">:</span><span class="s2">+20.13E</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">)</span>
</span><span id="write_mos_file-189"><a href="#write_mos_file-189"><span class="linenos">189</span></a>				<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string_to_write</span><span class="p">)</span>
</span><span id="write_mos_file-190"><a href="#write_mos_file-190"><span class="linenos">190</span></a>				<span class="c1">#f.write(eformat(eigenvectors[m+j,i], 14,2).replace(&quot;E&quot;, &quot;D&quot;))</span>
</span><span id="write_mos_file-191"><a href="#write_mos_file-191"><span class="linenos">191</span></a>			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_mos_file-192"><a href="#write_mos_file-192"><span class="linenos">192</span></a>			<span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span><span class="mi">4</span>
</span><span id="write_mos_file-193"><a href="#write_mos_file-193"><span class="linenos">193</span></a>			<span class="c1">#print(&quot;j &quot; + str(j))</span>
</span><span id="write_mos_file-194"><a href="#write_mos_file-194"><span class="linenos">194</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$end&quot;</span><span class="p">)</span>
</span><span id="write_mos_file-195"><a href="#write_mos_file-195"><span class="linenos">195</span></a>	<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>write mos file, requires python3</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (np.array):</strong>  eigenvalues</li>
<li><strong>param2 (np.ndarray):</strong>  eigenvectors</li>
<li><strong>param3 (string):</strong>  filename="mos_new.dat"</li>
</ul>
</div>


                </section>
                <section id="read_mos_file">
                            <input id="read_mos_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_mos_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">skip_lines</span><span class="o">=</span><span class="mi">1</span></span>)</span>

                <label class="view-source-button" for="read_mos_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_mos_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_mos_file-197"><a href="#read_mos_file-197"><span class="linenos">197</span></a><span class="k">def</span> <span class="nf">read_mos_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">skip_lines</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="read_mos_file-198"><a href="#read_mos_file-198"><span class="linenos">198</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_mos_file-199"><a href="#read_mos_file-199"><span class="linenos">199</span></a><span class="sd">	read mos file </span>
</span><span id="read_mos_file-200"><a href="#read_mos_file-200"><span class="linenos">200</span></a>
</span><span id="read_mos_file-201"><a href="#read_mos_file-201"><span class="linenos">201</span></a><span class="sd">	Args:</span>
</span><span id="read_mos_file-202"><a href="#read_mos_file-202"><span class="linenos">202</span></a><span class="sd">		param1 (string): filename</span>
</span><span id="read_mos_file-203"><a href="#read_mos_file-203"><span class="linenos">203</span></a><span class="sd">		param2 (int): skip_lines=1 (lines to skip )</span>
</span><span id="read_mos_file-204"><a href="#read_mos_file-204"><span class="linenos">204</span></a>
</span><span id="read_mos_file-205"><a href="#read_mos_file-205"><span class="linenos">205</span></a><span class="sd">	Returns:</span>
</span><span id="read_mos_file-206"><a href="#read_mos_file-206"><span class="linenos">206</span></a><span class="sd">		eigenvalue_list (list),eigenvector_list (np.ndarray)</span>
</span><span id="read_mos_file-207"><a href="#read_mos_file-207"><span class="linenos">207</span></a>
</span><span id="read_mos_file-208"><a href="#read_mos_file-208"><span class="linenos">208</span></a>
</span><span id="read_mos_file-209"><a href="#read_mos_file-209"><span class="linenos">209</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="read_mos_file-210"><a href="#read_mos_file-210"><span class="linenos">210</span></a>	<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="read_mos_file-211"><a href="#read_mos_file-211"><span class="linenos">211</span></a>	<span class="n">level</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_mos_file-212"><a href="#read_mos_file-212"><span class="linenos">212</span></a>	<span class="n">C_vec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>	
</span><span id="read_mos_file-213"><a href="#read_mos_file-213"><span class="linenos">213</span></a>	<span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_mos_file-214"><a href="#read_mos_file-214"><span class="linenos">214</span></a>	<span class="n">eigenvalue_old</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="read_mos_file-215"><a href="#read_mos_file-215"><span class="linenos">215</span></a>	<span class="n">eigenvalue</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_mos_file-216"><a href="#read_mos_file-216"><span class="linenos">216</span></a>	<span class="n">beginning</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="read_mos_file-217"><a href="#read_mos_file-217"><span class="linenos">217</span></a>	<span class="n">eigenvalue_list</span><span class="o">=</span> <span class="nb">list</span><span class="p">()</span>	
</span><span id="read_mos_file-218"><a href="#read_mos_file-218"><span class="linenos">218</span></a>	<span class="n">eigenvector_list</span><span class="o">=</span> <span class="o">-</span><span class="mi">1</span>	
</span><span id="read_mos_file-219"><a href="#read_mos_file-219"><span class="linenos">219</span></a>
</span><span id="read_mos_file-220"><a href="#read_mos_file-220"><span class="linenos">220</span></a>
</span><span id="read_mos_file-221"><a href="#read_mos_file-221"><span class="linenos">221</span></a>	<span class="c1">#open mos file and read linewise</span>
</span><span id="read_mos_file-222"><a href="#read_mos_file-222"><span class="linenos">222</span></a>	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="read_mos_file-223"><a href="#read_mos_file-223"><span class="linenos">223</span></a>		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
</span><span id="read_mos_file-224"><a href="#read_mos_file-224"><span class="linenos">224</span></a>			<span class="c1">#skip prefix lines</span>
</span><span id="read_mos_file-225"><a href="#read_mos_file-225"><span class="linenos">225</span></a>			<span class="c1">#find level and calculate A(i)</span>
</span><span id="read_mos_file-226"><a href="#read_mos_file-226"><span class="linenos">226</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">counter</span><span class="o">&gt;</span><span class="n">skip_lines</span><span class="p">):</span>
</span><span id="read_mos_file-227"><a href="#read_mos_file-227"><span class="linenos">227</span></a>				<span class="n">index1</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;eigenvalue=&quot;</span><span class="p">))</span>
</span><span id="read_mos_file-228"><a href="#read_mos_file-228"><span class="linenos">228</span></a>				<span class="n">index2</span> <span class="o">=</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;nsaos=&quot;</span><span class="p">))</span>
</span><span id="read_mos_file-229"><a href="#read_mos_file-229"><span class="linenos">229</span></a>				<span class="c1">#eigenvalue and nsaos found -&gt; new orbital</span>
</span><span id="read_mos_file-230"><a href="#read_mos_file-230"><span class="linenos">230</span></a>				<span class="k">if</span><span class="p">(</span><span class="n">index1</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">index2</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span><span id="read_mos_file-231"><a href="#read_mos_file-231"><span class="linenos">231</span></a>					<span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span> 
</span><span id="read_mos_file-232"><a href="#read_mos_file-232"><span class="linenos">232</span></a>					<span class="c1">#find nsaos of new orbital</span>
</span><span id="read_mos_file-233"><a href="#read_mos_file-233"><span class="linenos">233</span></a>					<span class="n">nsaos</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[(</span><span class="n">index2</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;nsaos=&quot;</span><span class="p">)):</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)]))</span>	
</span><span id="read_mos_file-234"><a href="#read_mos_file-234"><span class="linenos">234</span></a>
</span><span id="read_mos_file-235"><a href="#read_mos_file-235"><span class="linenos">235</span></a>					<span class="c1">#find eigenvalue of new orbital and store eigenvalue of current orbital in eigenvalue_old</span>
</span><span id="read_mos_file-236"><a href="#read_mos_file-236"><span class="linenos">236</span></a>					<span class="k">if</span><span class="p">(</span><span class="n">beginning</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="read_mos_file-237"><a href="#read_mos_file-237"><span class="linenos">237</span></a>						<span class="n">eigenvalue_old</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[(</span><span class="n">index1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;eigenvalue=&quot;</span><span class="p">)):</span><span class="n">index2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">))</span>
</span><span id="read_mos_file-238"><a href="#read_mos_file-238"><span class="linenos">238</span></a>						<span class="n">eigenvalue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[(</span><span class="n">index1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;eigenvalue=&quot;</span><span class="p">)):</span><span class="n">index2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">))</span>
</span><span id="read_mos_file-239"><a href="#read_mos_file-239"><span class="linenos">239</span></a>						<span class="n">eigenvector_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nsaos</span><span class="p">,</span><span class="n">nsaos</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>						
</span><span id="read_mos_file-240"><a href="#read_mos_file-240"><span class="linenos">240</span></a>						<span class="n">beginning</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="read_mos_file-241"><a href="#read_mos_file-241"><span class="linenos">241</span></a>					<span class="k">else</span><span class="p">:</span>
</span><span id="read_mos_file-242"><a href="#read_mos_file-242"><span class="linenos">242</span></a>						<span class="n">eigenvalue_old</span> <span class="o">=</span> <span class="n">eigenvalue</span>	
</span><span id="read_mos_file-243"><a href="#read_mos_file-243"><span class="linenos">243</span></a>						
</span><span id="read_mos_file-244"><a href="#read_mos_file-244"><span class="linenos">244</span></a>						<span class="n">eigenvalue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[(</span><span class="n">index1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;eigenvalue=&quot;</span><span class="p">)):</span><span class="n">index2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">))</span>
</span><span id="read_mos_file-245"><a href="#read_mos_file-245"><span class="linenos">245</span></a>												 
</span><span id="read_mos_file-246"><a href="#read_mos_file-246"><span class="linenos">246</span></a>													
</span><span id="read_mos_file-247"><a href="#read_mos_file-247"><span class="linenos">247</span></a>						
</span><span id="read_mos_file-248"><a href="#read_mos_file-248"><span class="linenos">248</span></a>
</span><span id="read_mos_file-249"><a href="#read_mos_file-249"><span class="linenos">249</span></a>					<span class="c1">#calculate A matrix by adding A_i -&gt; processing of previous orbital		</span>
</span><span id="read_mos_file-250"><a href="#read_mos_file-250"><span class="linenos">250</span></a>					<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">C_vec</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>							
</span><span id="read_mos_file-251"><a href="#read_mos_file-251"><span class="linenos">251</span></a>						<span class="n">eigenvalue_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eigenvalue_old</span><span class="p">)</span>	
</span><span id="read_mos_file-252"><a href="#read_mos_file-252"><span class="linenos">252</span></a>						<span class="c1">#print(&quot;level &quot; + str(level))</span>
</span><span id="read_mos_file-253"><a href="#read_mos_file-253"><span class="linenos">253</span></a>						<span class="n">eigenvector_list</span><span class="p">[:,(</span><span class="n">level</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">C_vec</span>					
</span><span id="read_mos_file-254"><a href="#read_mos_file-254"><span class="linenos">254</span></a>						<span class="n">C_vec</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>					
</span><span id="read_mos_file-255"><a href="#read_mos_file-255"><span class="linenos">255</span></a>					<span class="c1">#everything finished (beginning of new orbital)</span>
</span><span id="read_mos_file-256"><a href="#read_mos_file-256"><span class="linenos">256</span></a>					<span class="k">continue</span>
</span><span id="read_mos_file-257"><a href="#read_mos_file-257"><span class="linenos">257</span></a>				
</span><span id="read_mos_file-258"><a href="#read_mos_file-258"><span class="linenos">258</span></a>				
</span><span id="read_mos_file-259"><a href="#read_mos_file-259"><span class="linenos">259</span></a>				<span class="n">line_split</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">),</span> <span class="n">n</span><span class="p">)]</span>
</span><span id="read_mos_file-260"><a href="#read_mos_file-260"><span class="linenos">260</span></a>				<span class="k">try</span><span class="p">:</span>							
</span><span id="read_mos_file-261"><a href="#read_mos_file-261"><span class="linenos">261</span></a>					<span class="n">C_vec</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line_split</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">))</span>  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">line_split</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)][</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
</span><span id="read_mos_file-262"><a href="#read_mos_file-262"><span class="linenos">262</span></a>				<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="read_mos_file-263"><a href="#read_mos_file-263"><span class="linenos">263</span></a>					<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sorry faulty mos file &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="read_mos_file-264"><a href="#read_mos_file-264"><span class="linenos">264</span></a>					<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sorry. faulty mos file&#39;</span><span class="p">)</span>
</span><span id="read_mos_file-265"><a href="#read_mos_file-265"><span class="linenos">265</span></a>				<span class="c1">#print(len(C_vec))</span>
</span><span id="read_mos_file-266"><a href="#read_mos_file-266"><span class="linenos">266</span></a>				
</span><span id="read_mos_file-267"><a href="#read_mos_file-267"><span class="linenos">267</span></a>			<span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="read_mos_file-268"><a href="#read_mos_file-268"><span class="linenos">268</span></a>			
</span><span id="read_mos_file-269"><a href="#read_mos_file-269"><span class="linenos">269</span></a>	<span class="c1">#handle last mos</span>
</span><span id="read_mos_file-270"><a href="#read_mos_file-270"><span class="linenos">270</span></a>	<span class="n">eigenvalue_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eigenvalue_old</span><span class="p">)</span>	
</span><span id="read_mos_file-271"><a href="#read_mos_file-271"><span class="linenos">271</span></a>	<span class="n">eigenvector_list</span><span class="p">[:,(</span><span class="n">nsaos</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">C_vec</span>
</span><span id="read_mos_file-272"><a href="#read_mos_file-272"><span class="linenos">272</span></a>	
</span><span id="read_mos_file-273"><a href="#read_mos_file-273"><span class="linenos">273</span></a>	<span class="k">return</span> <span class="n">eigenvalue_list</span><span class="p">,</span><span class="n">eigenvector_list</span>
</span></pre></div>


            <div class="docstring"><p>read mos file </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (string):</strong>  filename</li>
<li><strong>param2 (int):</strong>  skip_lines=1 (lines to skip )</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>eigenvalue_list (list),eigenvector_list (np.ndarray)</p>
</blockquote>
</div>


                </section>
                <section id="diag_F">
                            <input id="diag_F-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">diag_F</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">f_mat_path</span>, </span><span class="param"><span class="n">s_mat_path</span>, </span><span class="param"><span class="n">eigenvalue_list</span><span class="o">=</span><span class="p">[]</span></span>)</span>

                <label class="view-source-button" for="diag_F-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#diag_F"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="diag_F-276"><a href="#diag_F-276"><span class="linenos">276</span></a><span class="k">def</span> <span class="nf">diag_F</span><span class="p">(</span><span class="n">f_mat_path</span><span class="p">,</span> <span class="n">s_mat_path</span><span class="p">,</span> <span class="n">eigenvalue_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()):</span>
</span><span id="diag_F-277"><a href="#diag_F-277"><span class="linenos">277</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="diag_F-278"><a href="#diag_F-278"><span class="linenos">278</span></a><span class="sd">	diagonalizes f mat (generalized), other eigenvalues can be used (eigenvalue_list). Solves Fx=l*S*x</span>
</span><span id="diag_F-279"><a href="#diag_F-279"><span class="linenos">279</span></a><span class="sd">	Args:</span>
</span><span id="diag_F-280"><a href="#diag_F-280"><span class="linenos">280</span></a><span class="sd">		param1 (string): filename of fmat</span>
</span><span id="diag_F-281"><a href="#diag_F-281"><span class="linenos">281</span></a><span class="sd">		param2 (string): filename of smat</span>
</span><span id="diag_F-282"><a href="#diag_F-282"><span class="linenos">282</span></a><span class="sd">		param3 (list()): eigenvalue_list (if specified eigenvalues are taken from eigenvalue_list)</span>
</span><span id="diag_F-283"><a href="#diag_F-283"><span class="linenos">283</span></a>
</span><span id="diag_F-284"><a href="#diag_F-284"><span class="linenos">284</span></a><span class="sd">	Returns:</span>
</span><span id="diag_F-285"><a href="#diag_F-285"><span class="linenos">285</span></a><span class="sd">		fmat (np.ndarray), eigenvalues (np.array), eigenvectors (matrix)</span>
</span><span id="diag_F-286"><a href="#diag_F-286"><span class="linenos">286</span></a>
</span><span id="diag_F-287"><a href="#diag_F-287"><span class="linenos">287</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="diag_F-288"><a href="#diag_F-288"><span class="linenos">288</span></a>
</span><span id="diag_F-289"><a href="#diag_F-289"><span class="linenos">289</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;read f&quot;</span><span class="p">)</span>
</span><span id="diag_F-290"><a href="#diag_F-290"><span class="linenos">290</span></a>	<span class="n">F_mat_file</span> <span class="o">=</span> <span class="n">read_packed_matrix</span><span class="p">(</span><span class="n">f_mat_path</span><span class="p">)</span>
</span><span id="diag_F-291"><a href="#diag_F-291"><span class="linenos">291</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;read s&quot;</span><span class="p">)</span>
</span><span id="diag_F-292"><a href="#diag_F-292"><span class="linenos">292</span></a>	<span class="n">s_mat</span> <span class="o">=</span> <span class="n">read_packed_matrix</span><span class="p">(</span><span class="n">s_mat_path</span><span class="p">)</span>
</span><span id="diag_F-293"><a href="#diag_F-293"><span class="linenos">293</span></a>	<span class="n">s_mat_save</span> <span class="o">=</span> <span class="n">s_mat</span>	
</span><span id="diag_F-294"><a href="#diag_F-294"><span class="linenos">294</span></a>
</span><span id="diag_F-295"><a href="#diag_F-295"><span class="linenos">295</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diag F&quot;</span><span class="p">)</span>	
</span><span id="diag_F-296"><a href="#diag_F-296"><span class="linenos">296</span></a>	
</span><span id="diag_F-297"><a href="#diag_F-297"><span class="linenos">297</span></a>
</span><span id="diag_F-298"><a href="#diag_F-298"><span class="linenos">298</span></a>	
</span><span id="diag_F-299"><a href="#diag_F-299"><span class="linenos">299</span></a>	<span class="c1">#Konfiguration 1 : Übereinstimmung</span>
</span><span id="diag_F-300"><a href="#diag_F-300"><span class="linenos">300</span></a>	<span class="c1">#eigenvalues, eigenvectors = np.linalg.eigh(F_mat_file.todense())</span>
</span><span id="diag_F-301"><a href="#diag_F-301"><span class="linenos">301</span></a>
</span><span id="diag_F-302"><a href="#diag_F-302"><span class="linenos">302</span></a>	<span class="c1">#Konfiguration 2 : keine Übereinstimmung (sollte eigentlich das gleiche machen wie np.linalg.eigh)</span>
</span><span id="diag_F-303"><a href="#diag_F-303"><span class="linenos">303</span></a>	<span class="c1">#eigenvalues, eigenvectors = scipy.linalg.eigh(F_mat_file.todense())</span>
</span><span id="diag_F-304"><a href="#diag_F-304"><span class="linenos">304</span></a>
</span><span id="diag_F-305"><a href="#diag_F-305"><span class="linenos">305</span></a>	<span class="c1">#Konfiguration 3: keine Übereinstimmung (generalierstes EW Problem)</span>
</span><span id="diag_F-306"><a href="#diag_F-306"><span class="linenos">306</span></a>	<span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">F_mat_file</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">s_mat</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
</span><span id="diag_F-307"><a href="#diag_F-307"><span class="linenos">307</span></a>
</span><span id="diag_F-308"><a href="#diag_F-308"><span class="linenos">308</span></a>	<span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">eigenvectors</span><span class="p">))</span>
</span><span id="diag_F-309"><a href="#diag_F-309"><span class="linenos">309</span></a>	<span class="c1">#eigenvectors = np.transpose(eigenvectors)</span>
</span><span id="diag_F-310"><a href="#diag_F-310"><span class="linenos">310</span></a>	<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
</span><span id="diag_F-311"><a href="#diag_F-311"><span class="linenos">311</span></a>	<span class="n">eigenvalue_output_list</span> <span class="o">=</span> <span class="n">eigenvalues</span>
</span><span id="diag_F-312"><a href="#diag_F-312"><span class="linenos">312</span></a>	<span class="c1">#print(eigenvalues)</span>
</span><span id="diag_F-313"><a href="#diag_F-313"><span class="linenos">313</span></a>	<span class="c1">#print(&quot;type random&quot;)</span>
</span><span id="diag_F-314"><a href="#diag_F-314"><span class="linenos">314</span></a>	<span class="c1">#print(type(eigenvalues).__name__)</span>
</span><span id="diag_F-315"><a href="#diag_F-315"><span class="linenos">315</span></a>	<span class="c1">#print(type(eigenvectors).__name__)</span>
</span><span id="diag_F-316"><a href="#diag_F-316"><span class="linenos">316</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diag F done&quot;</span><span class="p">)</span>
</span><span id="diag_F-317"><a href="#diag_F-317"><span class="linenos">317</span></a>
</span><span id="diag_F-318"><a href="#diag_F-318"><span class="linenos">318</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calc fmat &quot;</span><span class="p">)</span>
</span><span id="diag_F-319"><a href="#diag_F-319"><span class="linenos">319</span></a>	<span class="c1">#take eigenvalues from diagonalization or external eigenvalues (e.g from qpenergies)</span>
</span><span id="diag_F-320"><a href="#diag_F-320"><span class="linenos">320</span></a>	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">eigenvalue_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="diag_F-321"><a href="#diag_F-321"><span class="linenos">321</span></a>		<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
</span><span id="diag_F-322"><a href="#diag_F-322"><span class="linenos">322</span></a>	<span class="k">else</span><span class="p">:</span>		
</span><span id="diag_F-323"><a href="#diag_F-323"><span class="linenos">323</span></a>		<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">eigenvalue_list</span><span class="p">)</span>
</span><span id="diag_F-324"><a href="#diag_F-324"><span class="linenos">324</span></a>		<span class="n">eigenvalue_output_list</span> <span class="o">=</span> <span class="n">eigenvalue_list</span>
</span><span id="diag_F-325"><a href="#diag_F-325"><span class="linenos">325</span></a>
</span><span id="diag_F-326"><a href="#diag_F-326"><span class="linenos">326</span></a>	<span class="n">sc</span> <span class="o">=</span> <span class="n">s_mat</span> <span class="o">*</span> <span class="n">eigenvectors</span>
</span><span id="diag_F-327"><a href="#diag_F-327"><span class="linenos">327</span></a>	<span class="n">f_mat</span> <span class="o">=</span> <span class="n">eigenvalues</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
</span><span id="diag_F-328"><a href="#diag_F-328"><span class="linenos">328</span></a>	<span class="n">f_mat</span> <span class="o">=</span> <span class="n">sc</span> <span class="o">*</span> <span class="n">f_mat</span>
</span><span id="diag_F-329"><a href="#diag_F-329"><span class="linenos">329</span></a>	<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calc fmat done&quot;</span><span class="p">)</span>
</span><span id="diag_F-330"><a href="#diag_F-330"><span class="linenos">330</span></a>	
</span><span id="diag_F-331"><a href="#diag_F-331"><span class="linenos">331</span></a>
</span><span id="diag_F-332"><a href="#diag_F-332"><span class="linenos">332</span></a>
</span><span id="diag_F-333"><a href="#diag_F-333"><span class="linenos">333</span></a>	<span class="k">return</span> <span class="n">f_mat</span><span class="p">,</span><span class="n">eigenvalue_output_list</span><span class="p">,</span> <span class="n">eigenvectors</span>
</span></pre></div>


            <div class="docstring"><p>diagonalizes f mat (generalized), other eigenvalues can be used (eigenvalue_list). Solves Fx=l<em>S</em>x</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (string):</strong>  filename of fmat</li>
<li><strong>param2 (string):</strong>  filename of smat</li>
<li><strong>param3 (list()):</strong>  eigenvalue_list (if specified eigenvalues are taken from eigenvalue_list)</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>fmat (np.ndarray), eigenvalues (np.array), eigenvectors (matrix)</p>
</blockquote>
</div>


                </section>
                <section id="write_plot_data">
                            <input id="write_plot_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_plot_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">data</span>, </span><span class="param"><span class="n">header</span><span class="o">=</span><span class="s1">&#39;&#39;</span></span>)</span>

                <label class="view-source-button" for="write_plot_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_plot_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_plot_data-336"><a href="#write_plot_data-336"><span class="linenos">336</span></a><span class="k">def</span> <span class="nf">write_plot_data</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="write_plot_data-337"><a href="#write_plot_data-337"><span class="linenos">337</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="write_plot_data-338"><a href="#write_plot_data-338"><span class="linenos">338</span></a><span class="sd">	Writes data in file (eg plot data) </span>
</span><span id="write_plot_data-339"><a href="#write_plot_data-339"><span class="linenos">339</span></a>
</span><span id="write_plot_data-340"><a href="#write_plot_data-340"><span class="linenos">340</span></a><span class="sd">	Args:</span>
</span><span id="write_plot_data-341"><a href="#write_plot_data-341"><span class="linenos">341</span></a><span class="sd">		param1 (String): Filename</span>
</span><span id="write_plot_data-342"><a href="#write_plot_data-342"><span class="linenos">342</span></a><span class="sd">		param2 (tuple): tuple of lists (each entry is one column in data)</span>
</span><span id="write_plot_data-343"><a href="#write_plot_data-343"><span class="linenos">343</span></a><span class="sd">		param3 (String): Fileheader</span>
</span><span id="write_plot_data-344"><a href="#write_plot_data-344"><span class="linenos">344</span></a><span class="sd">		</span>
</span><span id="write_plot_data-345"><a href="#write_plot_data-345"><span class="linenos">345</span></a>
</span><span id="write_plot_data-346"><a href="#write_plot_data-346"><span class="linenos">346</span></a><span class="sd">	Returns:</span>
</span><span id="write_plot_data-347"><a href="#write_plot_data-347"><span class="linenos">347</span></a><span class="sd">		</span>
</span><span id="write_plot_data-348"><a href="#write_plot_data-348"><span class="linenos">348</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="write_plot_data-349"><a href="#write_plot_data-349"><span class="linenos">349</span></a>	<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="write_plot_data-350"><a href="#write_plot_data-350"><span class="linenos">350</span></a>	<span class="c1">#file = open(new_file-path,&quot;w&quot;)</span>
</span><span id="write_plot_data-351"><a href="#write_plot_data-351"><span class="linenos">351</span></a>	<span class="c1">#print(data[0])</span>
</span><span id="write_plot_data-352"><a href="#write_plot_data-352"><span class="linenos">352</span></a>	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="write_plot_data-353"><a href="#write_plot_data-353"><span class="linenos">353</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
</span><span id="write_plot_data-354"><a href="#write_plot_data-354"><span class="linenos">354</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_plot_data-355"><a href="#write_plot_data-355"><span class="linenos">355</span></a>
</span><span id="write_plot_data-356"><a href="#write_plot_data-356"><span class="linenos">356</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
</span><span id="write_plot_data-357"><a href="#write_plot_data-357"><span class="linenos">357</span></a>
</span><span id="write_plot_data-358"><a href="#write_plot_data-358"><span class="linenos">358</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>			
</span><span id="write_plot_data-359"><a href="#write_plot_data-359"><span class="linenos">359</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
</span><span id="write_plot_data-360"><a href="#write_plot_data-360"><span class="linenos">360</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;	&quot;</span><span class="p">)</span>
</span><span id="write_plot_data-361"><a href="#write_plot_data-361"><span class="linenos">361</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_plot_data-362"><a href="#write_plot_data-362"><span class="linenos">362</span></a>	<span class="c1">#file.write(data)</span>
</span><span id="write_plot_data-363"><a href="#write_plot_data-363"><span class="linenos">363</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Writes data in file (eg plot data) </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  Filename</li>
<li><strong>param2 (tuple):</strong>  tuple of lists (each entry is one column in data)</li>
<li><strong>param3 (String):</strong>  Fileheader</li>
</ul>

<p>Returns:</p>
</div>


                </section>
                <section id="read_plot_data">
                            <input id="read_plot_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_plot_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span></span>)</span>

                <label class="view-source-button" for="read_plot_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_plot_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_plot_data-365"><a href="#read_plot_data-365"><span class="linenos">365</span></a><span class="k">def</span> <span class="nf">read_plot_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="read_plot_data-366"><a href="#read_plot_data-366"><span class="linenos">366</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_plot_data-367"><a href="#read_plot_data-367"><span class="linenos">367</span></a><span class="sd">	Reads data in file (eg plot data)</span>
</span><span id="read_plot_data-368"><a href="#read_plot_data-368"><span class="linenos">368</span></a>
</span><span id="read_plot_data-369"><a href="#read_plot_data-369"><span class="linenos">369</span></a><span class="sd">	Args:</span>
</span><span id="read_plot_data-370"><a href="#read_plot_data-370"><span class="linenos">370</span></a><span class="sd">		param1 (String): Filename</span>
</span><span id="read_plot_data-371"><a href="#read_plot_data-371"><span class="linenos">371</span></a><span class="sd">		</span>
</span><span id="read_plot_data-372"><a href="#read_plot_data-372"><span class="linenos">372</span></a><span class="sd">		</span>
</span><span id="read_plot_data-373"><a href="#read_plot_data-373"><span class="linenos">373</span></a>
</span><span id="read_plot_data-374"><a href="#read_plot_data-374"><span class="linenos">374</span></a><span class="sd">	Returns:</span>
</span><span id="read_plot_data-375"><a href="#read_plot_data-375"><span class="linenos">375</span></a><span class="sd">		datContent, head (Array of lists and header of file)</span>
</span><span id="read_plot_data-376"><a href="#read_plot_data-376"><span class="linenos">376</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="read_plot_data-377"><a href="#read_plot_data-377"><span class="linenos">377</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="read_plot_data-378"><a href="#read_plot_data-378"><span class="linenos">378</span></a>	<span class="k">try</span><span class="p">:</span>
</span><span id="read_plot_data-379"><a href="#read_plot_data-379"><span class="linenos">379</span></a>		<span class="nb">float</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="read_plot_data-380"><a href="#read_plot_data-380"><span class="linenos">380</span></a>	<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="read_plot_data-381"><a href="#read_plot_data-381"><span class="linenos">381</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)])</span>
</span><span id="read_plot_data-382"><a href="#read_plot_data-382"><span class="linenos">382</span></a>		<span class="c1">#for 1D-01 to 1E-01 conversion</span>
</span><span id="read_plot_data-383"><a href="#read_plot_data-383"><span class="linenos">383</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">defchararray</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">datContent</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</span><span id="read_plot_data-384"><a href="#read_plot_data-384"><span class="linenos">384</span></a>		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datContent</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="read_plot_data-385"><a href="#read_plot_data-385"><span class="linenos">385</span></a>	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span><span class="s2">&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Reads data in file (eg plot data)</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  Filename</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>datContent, head (Array of lists and header of file)</p>
</blockquote>
</div>


                </section>
                <section id="read_coord_file">
                            <input id="read_coord_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_coord_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span></span>)</span>

                <label class="view-source-button" for="read_coord_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_coord_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_coord_file-388"><a href="#read_coord_file-388"><span class="linenos">388</span></a><span class="k">def</span> <span class="nf">read_coord_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="read_coord_file-389"><a href="#read_coord_file-389"><span class="linenos">389</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_coord_file-390"><a href="#read_coord_file-390"><span class="linenos">390</span></a><span class="sd">	Reads data in file (eg plot data). Coordinates are converted to float. Method is implemented in this way to allow</span>
</span><span id="read_coord_file-391"><a href="#read_coord_file-391"><span class="linenos">391</span></a><span class="sd">	fixed and unfixed atoms and their detection by the length of the lists.</span>
</span><span id="read_coord_file-392"><a href="#read_coord_file-392"><span class="linenos">392</span></a><span class="sd">	</span>
</span><span id="read_coord_file-393"><a href="#read_coord_file-393"><span class="linenos">393</span></a><span class="sd">	Args:</span>
</span><span id="read_coord_file-394"><a href="#read_coord_file-394"><span class="linenos">394</span></a><span class="sd">		param1 (String): Filename</span>
</span><span id="read_coord_file-395"><a href="#read_coord_file-395"><span class="linenos">395</span></a><span class="sd">		</span>
</span><span id="read_coord_file-396"><a href="#read_coord_file-396"><span class="linenos">396</span></a><span class="sd">		</span>
</span><span id="read_coord_file-397"><a href="#read_coord_file-397"><span class="linenos">397</span></a>
</span><span id="read_coord_file-398"><a href="#read_coord_file-398"><span class="linenos">398</span></a><span class="sd">	Returns:</span>
</span><span id="read_coord_file-399"><a href="#read_coord_file-399"><span class="linenos">399</span></a><span class="sd">		array of lists [line in coordfile][0=x, 1=y, 2=z, 3=atomtype, optional: 4=fixed]</span>
</span><span id="read_coord_file-400"><a href="#read_coord_file-400"><span class="linenos">400</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="read_coord_file-401"><a href="#read_coord_file-401"><span class="linenos">401</span></a>
</span><span id="read_coord_file-402"><a href="#read_coord_file-402"><span class="linenos">402</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="read_coord_file-403"><a href="#read_coord_file-403"><span class="linenos">403</span></a>	<span class="c1">#filter everything but $coord information</span>
</span><span id="read_coord_file-404"><a href="#read_coord_file-404"><span class="linenos">404</span></a>	<span class="n">cut</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_coord_file-405"><a href="#read_coord_file-405"><span class="linenos">405</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)):</span>
</span><span id="read_coord_file-406"><a href="#read_coord_file-406"><span class="linenos">406</span></a>		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">):</span>
</span><span id="read_coord_file-407"><a href="#read_coord_file-407"><span class="linenos">407</span></a>			<span class="n">cut</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="read_coord_file-408"><a href="#read_coord_file-408"><span class="linenos">408</span></a>			<span class="n">datContent</span><span class="o">=</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cut</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="read_coord_file-409"><a href="#read_coord_file-409"><span class="linenos">409</span></a>			<span class="k">break</span>
</span><span id="read_coord_file-410"><a href="#read_coord_file-410"><span class="linenos">410</span></a>
</span><span id="read_coord_file-411"><a href="#read_coord_file-411"><span class="linenos">411</span></a>	<span class="n">datContent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datContent</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="read_coord_file-412"><a href="#read_coord_file-412"><span class="linenos">412</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="read_coord_file-413"><a href="#read_coord_file-413"><span class="linenos">413</span></a>	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datContent</span><span class="p">):</span>
</span><span id="read_coord_file-414"><a href="#read_coord_file-414"><span class="linenos">414</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="read_coord_file-415"><a href="#read_coord_file-415"><span class="linenos">415</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="read_coord_file-416"><a href="#read_coord_file-416"><span class="linenos">416</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="read_coord_file-417"><a href="#read_coord_file-417"><span class="linenos">417</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span>
</span><span id="read_coord_file-418"><a href="#read_coord_file-418"><span class="linenos">418</span></a>	<span class="k">return</span> <span class="n">datContent</span>
</span></pre></div>


            <div class="docstring"><p>Reads data in file (eg plot data). Coordinates are converted to float. Method is implemented in this way to allow
fixed and unfixed atoms and their detection by the length of the lists.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  Filename</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>array of lists [line in coordfile][0=x, 1=y, 2=z, 3=atomtype, optional: 4=fixed]</p>
</blockquote>
</div>


                </section>
                <section id="read_xyz_file">
                            <input id="read_xyz_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_xyz_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span></span>)</span>

                <label class="view-source-button" for="read_xyz_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_xyz_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_xyz_file-420"><a href="#read_xyz_file-420"><span class="linenos">420</span></a><span class="k">def</span> <span class="nf">read_xyz_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="read_xyz_file-421"><a href="#read_xyz_file-421"><span class="linenos">421</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_xyz_file-422"><a href="#read_xyz_file-422"><span class="linenos">422</span></a><span class="sd">	Reads data in file (eg plot data) </span>
</span><span id="read_xyz_file-423"><a href="#read_xyz_file-423"><span class="linenos">423</span></a><span class="sd">	</span>
</span><span id="read_xyz_file-424"><a href="#read_xyz_file-424"><span class="linenos">424</span></a><span class="sd">	Args:</span>
</span><span id="read_xyz_file-425"><a href="#read_xyz_file-425"><span class="linenos">425</span></a><span class="sd">		param1 (String): Filename</span>
</span><span id="read_xyz_file-426"><a href="#read_xyz_file-426"><span class="linenos">426</span></a><span class="sd">		</span>
</span><span id="read_xyz_file-427"><a href="#read_xyz_file-427"><span class="linenos">427</span></a><span class="sd">		</span>
</span><span id="read_xyz_file-428"><a href="#read_xyz_file-428"><span class="linenos">428</span></a>
</span><span id="read_xyz_file-429"><a href="#read_xyz_file-429"><span class="linenos">429</span></a><span class="sd">	Returns:</span>
</span><span id="read_xyz_file-430"><a href="#read_xyz_file-430"><span class="linenos">430</span></a><span class="sd">		array of lists [line in coordfile][0=x, 1=y, 2=z, 3=atomtype, optional: 4=fixed]</span>
</span><span id="read_xyz_file-431"><a href="#read_xyz_file-431"><span class="linenos">431</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="read_xyz_file-432"><a href="#read_xyz_file-432"><span class="linenos">432</span></a>
</span><span id="read_xyz_file-433"><a href="#read_xyz_file-433"><span class="linenos">433</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="read_xyz_file-434"><a href="#read_xyz_file-434"><span class="linenos">434</span></a>	<span class="c1">#filter everything but $coord information</span>
</span><span id="read_xyz_file-435"><a href="#read_xyz_file-435"><span class="linenos">435</span></a>	<span class="n">cut</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_xyz_file-436"><a href="#read_xyz_file-436"><span class="linenos">436</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)):</span>
</span><span id="read_xyz_file-437"><a href="#read_xyz_file-437"><span class="linenos">437</span></a>		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">):</span>
</span><span id="read_xyz_file-438"><a href="#read_xyz_file-438"><span class="linenos">438</span></a>			<span class="n">cut</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="read_xyz_file-439"><a href="#read_xyz_file-439"><span class="linenos">439</span></a>			<span class="n">datContent</span><span class="o">=</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">cut</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</span><span id="read_xyz_file-440"><a href="#read_xyz_file-440"><span class="linenos">440</span></a>			<span class="k">break</span>
</span><span id="read_xyz_file-441"><a href="#read_xyz_file-441"><span class="linenos">441</span></a>
</span><span id="read_xyz_file-442"><a href="#read_xyz_file-442"><span class="linenos">442</span></a>	<span class="n">datContent</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datContent</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="read_xyz_file-443"><a href="#read_xyz_file-443"><span class="linenos">443</span></a>	<span class="n">datContent</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)])</span>
</span><span id="read_xyz_file-444"><a href="#read_xyz_file-444"><span class="linenos">444</span></a>	<span class="k">return</span> <span class="n">datContent</span>
</span></pre></div>


            <div class="docstring"><p>Reads data in file (eg plot data) </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  Filename</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>array of lists [line in coordfile][0=x, 1=y, 2=z, 3=atomtype, optional: 4=fixed]</p>
</blockquote>
</div>


                </section>
                <section id="write_coord_file">
                            <input id="write_coord_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_coord_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">coord</span></span>)</span>

                <label class="view-source-button" for="write_coord_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_coord_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_coord_file-446"><a href="#write_coord_file-446"><span class="linenos">446</span></a><span class="k">def</span> <span class="nf">write_coord_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">coord</span><span class="p">):</span>
</span><span id="write_coord_file-447"><a href="#write_coord_file-447"><span class="linenos">447</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="write_coord_file-448"><a href="#write_coord_file-448"><span class="linenos">448</span></a><span class="sd">	writes coord file.</span>
</span><span id="write_coord_file-449"><a href="#write_coord_file-449"><span class="linenos">449</span></a>
</span><span id="write_coord_file-450"><a href="#write_coord_file-450"><span class="linenos">450</span></a><span class="sd">	Args:</span>
</span><span id="write_coord_file-451"><a href="#write_coord_file-451"><span class="linenos">451</span></a><span class="sd">		param1 (String): filename</span>
</span><span id="write_coord_file-452"><a href="#write_coord_file-452"><span class="linenos">452</span></a><span class="sd">		param3 (np.ndarray): dat content</span>
</span><span id="write_coord_file-453"><a href="#write_coord_file-453"><span class="linenos">453</span></a>
</span><span id="write_coord_file-454"><a href="#write_coord_file-454"><span class="linenos">454</span></a><span class="sd">	Returns:</span>
</span><span id="write_coord_file-455"><a href="#write_coord_file-455"><span class="linenos">455</span></a><span class="sd">		</span>
</span><span id="write_coord_file-456"><a href="#write_coord_file-456"><span class="linenos">456</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="write_coord_file-457"><a href="#write_coord_file-457"><span class="linenos">457</span></a>	<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="write_coord_file-458"><a href="#write_coord_file-458"><span class="linenos">458</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$coord&quot;</span><span class="p">)</span>
</span><span id="write_coord_file-459"><a href="#write_coord_file-459"><span class="linenos">459</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_coord_file-460"><a href="#write_coord_file-460"><span class="linenos">460</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="write_coord_file-461"><a href="#write_coord_file-461"><span class="linenos">461</span></a>		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">):</span>
</span><span id="write_coord_file-462"><a href="#write_coord_file-462"><span class="linenos">462</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
</span><span id="write_coord_file-463"><a href="#write_coord_file-463"><span class="linenos">463</span></a>		<span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="mi">5</span><span class="p">):</span>
</span><span id="write_coord_file-464"><a href="#write_coord_file-464"><span class="linenos">464</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
</span><span id="write_coord_file-465"><a href="#write_coord_file-465"><span class="linenos">465</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="write_coord_file-466"><a href="#write_coord_file-466"><span class="linenos">466</span></a>			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Coord file seems to be funny&quot;</span><span class="p">)</span>
</span><span id="write_coord_file-467"><a href="#write_coord_file-467"><span class="linenos">467</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$user-defined bonds&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_coord_file-468"><a href="#write_coord_file-468"><span class="linenos">468</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;$end&quot;</span><span class="p">)</span>
</span><span id="write_coord_file-469"><a href="#write_coord_file-469"><span class="linenos">469</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>writes coord file.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  filename</li>
<li><strong>param3 (np.ndarray):</strong>  dat content</li>
</ul>

<p>Returns:</p>
</div>


                </section>
                <section id="find_c_range_atom">
                            <input id="find_c_range_atom-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_c_range_atom</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">atom</span>, </span><span class="param"><span class="n">number</span>, </span><span class="param"><span class="n">coordfile</span>, </span><span class="param"><span class="n">basis_set</span><span class="o">=</span><span class="s1">&#39;dev-SV(P)&#39;</span></span>)</span>

                <label class="view-source-button" for="find_c_range_atom-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#find_c_range_atom"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="find_c_range_atom-471"><a href="#find_c_range_atom-471"><span class="linenos">471</span></a><span class="k">def</span> <span class="nf">find_c_range_atom</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">coordfile</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;dev-SV(P)&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-472"><a href="#find_c_range_atom-472"><span class="linenos">472</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="find_c_range_atom-473"><a href="#find_c_range_atom-473"><span class="linenos">473</span></a><span class="sd">	finds atoms range of expansion coef in mos file. number gives wich atoms should be found e.g. two sulfur : first number =1; second = 2</span>
</span><span id="find_c_range_atom-474"><a href="#find_c_range_atom-474"><span class="linenos">474</span></a>
</span><span id="find_c_range_atom-475"><a href="#find_c_range_atom-475"><span class="linenos">475</span></a><span class="sd">	Args:</span>
</span><span id="find_c_range_atom-476"><a href="#find_c_range_atom-476"><span class="linenos">476</span></a><span class="sd">		param1 (String): atom type</span>
</span><span id="find_c_range_atom-477"><a href="#find_c_range_atom-477"><span class="linenos">477</span></a><span class="sd">		param2 (int): number of atom type atom</span>
</span><span id="find_c_range_atom-478"><a href="#find_c_range_atom-478"><span class="linenos">478</span></a><span class="sd">		param3 (String): filename for coord file</span>
</span><span id="find_c_range_atom-479"><a href="#find_c_range_atom-479"><span class="linenos">479</span></a><span class="sd">		param4 (String): basis_set=&quot;dev-SV(P)&quot;</span>
</span><span id="find_c_range_atom-480"><a href="#find_c_range_atom-480"><span class="linenos">480</span></a><span class="sd">		</span>
</span><span id="find_c_range_atom-481"><a href="#find_c_range_atom-481"><span class="linenos">481</span></a>
</span><span id="find_c_range_atom-482"><a href="#find_c_range_atom-482"><span class="linenos">482</span></a><span class="sd">	Returns:</span>
</span><span id="find_c_range_atom-483"><a href="#find_c_range_atom-483"><span class="linenos">483</span></a><span class="sd">		tuple (index_start, index_end)</span>
</span><span id="find_c_range_atom-484"><a href="#find_c_range_atom-484"><span class="linenos">484</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="find_c_range_atom-485"><a href="#find_c_range_atom-485"><span class="linenos">485</span></a>	<span class="k">def</span> <span class="nf">atom_type_to_number_coeff</span><span class="p">(</span><span class="n">atom</span><span class="p">):</span>
</span><span id="find_c_range_atom-486"><a href="#find_c_range_atom-486"><span class="linenos">486</span></a>		<span class="sd">&quot;&quot;&quot;</span>
</span><span id="find_c_range_atom-487"><a href="#find_c_range_atom-487"><span class="linenos">487</span></a><span class="sd">		returns ordinal number of atom</span>
</span><span id="find_c_range_atom-488"><a href="#find_c_range_atom-488"><span class="linenos">488</span></a>
</span><span id="find_c_range_atom-489"><a href="#find_c_range_atom-489"><span class="linenos">489</span></a><span class="sd">		Args:</span>
</span><span id="find_c_range_atom-490"><a href="#find_c_range_atom-490"><span class="linenos">490</span></a><span class="sd">			param1 (String): atom type		</span>
</span><span id="find_c_range_atom-491"><a href="#find_c_range_atom-491"><span class="linenos">491</span></a>
</span><span id="find_c_range_atom-492"><a href="#find_c_range_atom-492"><span class="linenos">492</span></a><span class="sd">		Returns:</span>
</span><span id="find_c_range_atom-493"><a href="#find_c_range_atom-493"><span class="linenos">493</span></a><span class="sd">			ordinal number (int)</span>
</span><span id="find_c_range_atom-494"><a href="#find_c_range_atom-494"><span class="linenos">494</span></a><span class="sd">			&quot;&quot;&quot;</span>
</span><span id="find_c_range_atom-495"><a href="#find_c_range_atom-495"><span class="linenos">495</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-496"><a href="#find_c_range_atom-496"><span class="linenos">496</span></a>			<span class="k">return</span> <span class="mi">14</span>
</span><span id="find_c_range_atom-497"><a href="#find_c_range_atom-497"><span class="linenos">497</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;h&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-498"><a href="#find_c_range_atom-498"><span class="linenos">498</span></a>			<span class="k">return</span> <span class="mi">2</span>
</span><span id="find_c_range_atom-499"><a href="#find_c_range_atom-499"><span class="linenos">499</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;au&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-500"><a href="#find_c_range_atom-500"><span class="linenos">500</span></a>			<span class="k">return</span> <span class="mi">25</span>
</span><span id="find_c_range_atom-501"><a href="#find_c_range_atom-501"><span class="linenos">501</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-502"><a href="#find_c_range_atom-502"><span class="linenos">502</span></a>			<span class="k">return</span> <span class="mi">18</span>
</span><span id="find_c_range_atom-503"><a href="#find_c_range_atom-503"><span class="linenos">503</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;zn&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-504"><a href="#find_c_range_atom-504"><span class="linenos">504</span></a>			<span class="k">return</span> <span class="mi">24</span>
</span><span id="find_c_range_atom-505"><a href="#find_c_range_atom-505"><span class="linenos">505</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;o&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-506"><a href="#find_c_range_atom-506"><span class="linenos">506</span></a>			<span class="k">return</span> <span class="mi">14</span>
</span><span id="find_c_range_atom-507"><a href="#find_c_range_atom-507"><span class="linenos">507</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;fe&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-508"><a href="#find_c_range_atom-508"><span class="linenos">508</span></a>			<span class="k">return</span> <span class="mi">24</span>
</span><span id="find_c_range_atom-509"><a href="#find_c_range_atom-509"><span class="linenos">509</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;f&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-510"><a href="#find_c_range_atom-510"><span class="linenos">510</span></a>			<span class="k">return</span> <span class="mi">14</span>
</span><span id="find_c_range_atom-511"><a href="#find_c_range_atom-511"><span class="linenos">511</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;cl&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-512"><a href="#find_c_range_atom-512"><span class="linenos">512</span></a>			<span class="k">return</span> <span class="mi">18</span>
</span><span id="find_c_range_atom-513"><a href="#find_c_range_atom-513"><span class="linenos">513</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-514"><a href="#find_c_range_atom-514"><span class="linenos">514</span></a>			<span class="k">return</span> <span class="mi">32</span>
</span><span id="find_c_range_atom-515"><a href="#find_c_range_atom-515"><span class="linenos">515</span></a>		<span class="k">elif</span><span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;i&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-516"><a href="#find_c_range_atom-516"><span class="linenos">516</span></a>			<span class="k">return</span> <span class="mi">13</span>
</span><span id="find_c_range_atom-517"><a href="#find_c_range_atom-517"><span class="linenos">517</span></a>
</span><span id="find_c_range_atom-518"><a href="#find_c_range_atom-518"><span class="linenos">518</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="find_c_range_atom-519"><a href="#find_c_range_atom-519"><span class="linenos">519</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sorry. This feature is not implemented for following atom: &#39;</span> <span class="o">+</span> <span class="n">atom</span><span class="p">)</span>
</span><span id="find_c_range_atom-520"><a href="#find_c_range_atom-520"><span class="linenos">520</span></a>
</span><span id="find_c_range_atom-521"><a href="#find_c_range_atom-521"><span class="linenos">521</span></a>	<span class="n">coord_content</span> <span class="o">=</span> <span class="n">read_coord_file</span><span class="p">(</span><span class="n">coordfile</span><span class="p">)</span>
</span><span id="find_c_range_atom-522"><a href="#find_c_range_atom-522"><span class="linenos">522</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">basis_set</span><span class="o">==</span><span class="s2">&quot;dev-SV(P)&quot;</span><span class="p">):</span>
</span><span id="find_c_range_atom-523"><a href="#find_c_range_atom-523"><span class="linenos">523</span></a>		<span class="n">number_found_atoms_of_type</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="find_c_range_atom-524"><a href="#find_c_range_atom-524"><span class="linenos">524</span></a>		<span class="n">number_expansion_coeff</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="find_c_range_atom-525"><a href="#find_c_range_atom-525"><span class="linenos">525</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_content</span><span class="p">)):</span>
</span><span id="find_c_range_atom-526"><a href="#find_c_range_atom-526"><span class="linenos">526</span></a>			<span class="n">current_atom</span> <span class="o">=</span> <span class="n">coord_content</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
</span><span id="find_c_range_atom-527"><a href="#find_c_range_atom-527"><span class="linenos">527</span></a>
</span><span id="find_c_range_atom-528"><a href="#find_c_range_atom-528"><span class="linenos">528</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">current_atom</span> <span class="o">==</span> <span class="n">atom</span><span class="p">):</span>				
</span><span id="find_c_range_atom-529"><a href="#find_c_range_atom-529"><span class="linenos">529</span></a>				<span class="n">number_found_atoms_of_type</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="find_c_range_atom-530"><a href="#find_c_range_atom-530"><span class="linenos">530</span></a>				<span class="k">if</span><span class="p">(</span><span class="n">number_found_atoms_of_type</span> <span class="o">==</span> <span class="n">number</span><span class="p">):</span>				
</span><span id="find_c_range_atom-531"><a href="#find_c_range_atom-531"><span class="linenos">531</span></a>					<span class="k">return</span> <span class="p">(</span><span class="n">number_expansion_coeff</span><span class="p">,</span> <span class="n">number_expansion_coeff</span><span class="o">+</span><span class="n">atom_type_to_number_coeff</span><span class="p">(</span><span class="n">current_atom</span><span class="p">))</span>	
</span><span id="find_c_range_atom-532"><a href="#find_c_range_atom-532"><span class="linenos">532</span></a>				<span class="n">number_expansion_coeff</span> <span class="o">+=</span> <span class="n">atom_type_to_number_coeff</span><span class="p">(</span><span class="n">current_atom</span><span class="p">)</span>				
</span><span id="find_c_range_atom-533"><a href="#find_c_range_atom-533"><span class="linenos">533</span></a>			<span class="k">else</span><span class="p">:</span>
</span><span id="find_c_range_atom-534"><a href="#find_c_range_atom-534"><span class="linenos">534</span></a>				<span class="n">number_expansion_coeff</span> <span class="o">+=</span> <span class="n">atom_type_to_number_coeff</span><span class="p">(</span><span class="n">current_atom</span><span class="p">)</span>
</span><span id="find_c_range_atom-535"><a href="#find_c_range_atom-535"><span class="linenos">535</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sorry. Could not find the atom&#39;</span><span class="p">)</span>			
</span><span id="find_c_range_atom-536"><a href="#find_c_range_atom-536"><span class="linenos">536</span></a>			
</span><span id="find_c_range_atom-537"><a href="#find_c_range_atom-537"><span class="linenos">537</span></a>
</span><span id="find_c_range_atom-538"><a href="#find_c_range_atom-538"><span class="linenos">538</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="find_c_range_atom-539"><a href="#find_c_range_atom-539"><span class="linenos">539</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sorry. This feature is not implemented for following basis_set: &#39;</span> <span class="o">+</span> <span class="n">basis_set</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>finds atoms range of expansion coef in mos file. number gives wich atoms should be found e.g. two sulfur : first number =1; second = 2</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  atom type</li>
<li><strong>param2 (int):</strong>  number of atom type atom</li>
<li><strong>param3 (String):</strong>  filename for coord file</li>
<li><strong>param4 (String):</strong>  basis_set="dev-SV(P)"</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>tuple (index_start, index_end)</p>
</blockquote>
</div>


                </section>
                <section id="load_xyz_file">
                            <input id="load_xyz_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_xyz_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span></span>)</span>

                <label class="view-source-button" for="load_xyz_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_xyz_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="load_xyz_file-542"><a href="#load_xyz_file-542"><span class="linenos">542</span></a><span class="k">def</span> <span class="nf">load_xyz_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="load_xyz_file-543"><a href="#load_xyz_file-543"><span class="linenos">543</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="load_xyz_file-544"><a href="#load_xyz_file-544"><span class="linenos">544</span></a><span class="sd">	load xyz file and returns data. Returns comment line and coord data. Dat content cols: atoms=0 (Str), x=1 (float), y=2 (float), z=3 (float).</span>
</span><span id="load_xyz_file-545"><a href="#load_xyz_file-545"><span class="linenos">545</span></a><span class="sd">	coord[:,i] ... Entries for atom i</span>
</span><span id="load_xyz_file-546"><a href="#load_xyz_file-546"><span class="linenos">546</span></a><span class="sd">	coord[i,:] ... Atoms types (str) [i=0], x (float) [i=1], y (float) [i=2], x (float) [z=3] for all atoms</span>
</span><span id="load_xyz_file-547"><a href="#load_xyz_file-547"><span class="linenos">547</span></a>
</span><span id="load_xyz_file-548"><a href="#load_xyz_file-548"><span class="linenos">548</span></a><span class="sd">	Args:</span>
</span><span id="load_xyz_file-549"><a href="#load_xyz_file-549"><span class="linenos">549</span></a><span class="sd">		param1 (String): filename</span>
</span><span id="load_xyz_file-550"><a href="#load_xyz_file-550"><span class="linenos">550</span></a>
</span><span id="load_xyz_file-551"><a href="#load_xyz_file-551"><span class="linenos">551</span></a>
</span><span id="load_xyz_file-552"><a href="#load_xyz_file-552"><span class="linenos">552</span></a><span class="sd">	Returns:</span>
</span><span id="load_xyz_file-553"><a href="#load_xyz_file-553"><span class="linenos">553</span></a><span class="sd">		(comment_line (String), coord (np.ndarray))</span>
</span><span id="load_xyz_file-554"><a href="#load_xyz_file-554"><span class="linenos">554</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="load_xyz_file-555"><a href="#load_xyz_file-555"><span class="linenos">555</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</span><span id="load_xyz_file-556"><a href="#load_xyz_file-556"><span class="linenos">556</span></a>	<span class="n">comment_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="load_xyz_file-557"><a href="#load_xyz_file-557"><span class="linenos">557</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="load_xyz_file-558"><a href="#load_xyz_file-558"><span class="linenos">558</span></a>	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datContent</span><span class="p">):</span>
</span><span id="load_xyz_file-559"><a href="#load_xyz_file-559"><span class="linenos">559</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="load_xyz_file-560"><a href="#load_xyz_file-560"><span class="linenos">560</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="load_xyz_file-561"><a href="#load_xyz_file-561"><span class="linenos">561</span></a>		<span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</span><span id="load_xyz_file-562"><a href="#load_xyz_file-562"><span class="linenos">562</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span>
</span><span id="load_xyz_file-563"><a href="#load_xyz_file-563"><span class="linenos">563</span></a>	<span class="k">return</span> <span class="p">(</span><span class="n">comment_line</span><span class="p">,</span> <span class="n">coord</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>load xyz file and returns data. Returns comment line and coord data. Dat content cols: atoms=0 (Str), x=1 (float), y=2 (float), z=3 (float).
coord[:,i] ... Entries for atom i
coord[i,:] ... Atoms types (str) [i=0], x (float) [i=1], y (float) [i=2], x (float) [z=3] for all atoms</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  filename</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>(comment_line (String), coord (np.ndarray))</p>
</blockquote>
</div>


                </section>
                <section id="write_xyz_file">
                            <input id="write_xyz_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_xyz_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">comment_line</span>, </span><span class="param"><span class="n">coord_xyz</span></span>)</span>

                <label class="view-source-button" for="write_xyz_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#write_xyz_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="write_xyz_file-565"><a href="#write_xyz_file-565"><span class="linenos">565</span></a><span class="k">def</span> <span class="nf">write_xyz_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">comment_line</span><span class="p">,</span> <span class="n">coord_xyz</span><span class="p">):</span>
</span><span id="write_xyz_file-566"><a href="#write_xyz_file-566"><span class="linenos">566</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="write_xyz_file-567"><a href="#write_xyz_file-567"><span class="linenos">567</span></a><span class="sd">	writes xyz file.</span>
</span><span id="write_xyz_file-568"><a href="#write_xyz_file-568"><span class="linenos">568</span></a>
</span><span id="write_xyz_file-569"><a href="#write_xyz_file-569"><span class="linenos">569</span></a><span class="sd">	Args:</span>
</span><span id="write_xyz_file-570"><a href="#write_xyz_file-570"><span class="linenos">570</span></a><span class="sd">		param1 (String): filename</span>
</span><span id="write_xyz_file-571"><a href="#write_xyz_file-571"><span class="linenos">571</span></a><span class="sd">		param2 (String): commment_line</span>
</span><span id="write_xyz_file-572"><a href="#write_xyz_file-572"><span class="linenos">572</span></a><span class="sd">		param3 (np.ndarray): dat content</span>
</span><span id="write_xyz_file-573"><a href="#write_xyz_file-573"><span class="linenos">573</span></a>
</span><span id="write_xyz_file-574"><a href="#write_xyz_file-574"><span class="linenos">574</span></a><span class="sd">	Returns:</span>
</span><span id="write_xyz_file-575"><a href="#write_xyz_file-575"><span class="linenos">575</span></a><span class="sd">		</span>
</span><span id="write_xyz_file-576"><a href="#write_xyz_file-576"><span class="linenos">576</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="write_xyz_file-577"><a href="#write_xyz_file-577"><span class="linenos">577</span></a>	<span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
</span><span id="write_xyz_file-578"><a href="#write_xyz_file-578"><span class="linenos">578</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)))</span>
</span><span id="write_xyz_file-579"><a href="#write_xyz_file-579"><span class="linenos">579</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_xyz_file-580"><a href="#write_xyz_file-580"><span class="linenos">580</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">comment_line</span><span class="p">)</span>
</span><span id="write_xyz_file-581"><a href="#write_xyz_file-581"><span class="linenos">581</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_xyz_file-582"><a href="#write_xyz_file-582"><span class="linenos">582</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)):</span>
</span><span id="write_xyz_file-583"><a href="#write_xyz_file-583"><span class="linenos">583</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;	&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;	&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span> <span class="s2">&quot;	&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="write_xyz_file-584"><a href="#write_xyz_file-584"><span class="linenos">584</span></a>	<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>writes xyz file.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  filename</li>
<li><strong>param2 (String):</strong>  commment_line</li>
<li><strong>param3 (np.ndarray):</strong>  dat content</li>
</ul>

<p>Returns:</p>
</div>


                </section>
                <section id="read_hessian">
                            <input id="read_hessian-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">read_hessian</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span>, </span><span class="param"><span class="n">n_atoms</span>, </span><span class="param"><span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span></span>)</span>

                <label class="view-source-button" for="read_hessian-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#read_hessian"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="read_hessian-586"><a href="#read_hessian-586"><span class="linenos">586</span></a><span class="k">def</span> <span class="nf">read_hessian</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="read_hessian-587"><a href="#read_hessian-587"><span class="linenos">587</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="read_hessian-588"><a href="#read_hessian-588"><span class="linenos">588</span></a><span class="sd">	Reads hessian from turbomole format and converts it to matrix of float</span>
</span><span id="read_hessian-589"><a href="#read_hessian-589"><span class="linenos">589</span></a><span class="sd">	Args:</span>
</span><span id="read_hessian-590"><a href="#read_hessian-590"><span class="linenos">590</span></a><span class="sd">		param1 (String) : Filename</span>
</span><span id="read_hessian-591"><a href="#read_hessian-591"><span class="linenos">591</span></a><span class="sd">		param2 (int) : Number of atoms</span>
</span><span id="read_hessian-592"><a href="#read_hessian-592"><span class="linenos">592</span></a>
</span><span id="read_hessian-593"><a href="#read_hessian-593"><span class="linenos">593</span></a><span class="sd">	Returns:</span>
</span><span id="read_hessian-594"><a href="#read_hessian-594"><span class="linenos">594</span></a><span class="sd">		np.ndarray </span>
</span><span id="read_hessian-595"><a href="#read_hessian-595"><span class="linenos">595</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="read_hessian-596"><a href="#read_hessian-596"><span class="linenos">596</span></a>	<span class="n">skip_lines</span><span class="o">=</span><span class="mi">1</span>
</span><span id="read_hessian-597"><a href="#read_hessian-597"><span class="linenos">597</span></a>	<span class="n">datContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[(</span><span class="n">skip_lines</span><span class="p">):]]</span>
</span><span id="read_hessian-598"><a href="#read_hessian-598"><span class="linenos">598</span></a>	
</span><span id="read_hessian-599"><a href="#read_hessian-599"><span class="linenos">599</span></a>	<span class="c1">#for three dimensions 3N dimensions</span>
</span><span id="read_hessian-600"><a href="#read_hessian-600"><span class="linenos">600</span></a>	<span class="n">n_atoms</span> <span class="o">=</span> <span class="n">n_atoms</span><span class="o">*</span><span class="n">dimensions</span>
</span><span id="read_hessian-601"><a href="#read_hessian-601"><span class="linenos">601</span></a>	<span class="n">hessian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_atoms</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">))</span>
</span><span id="read_hessian-602"><a href="#read_hessian-602"><span class="linenos">602</span></a>	<span class="n">counter</span><span class="o">=</span><span class="mi">0</span>
</span><span id="read_hessian-603"><a href="#read_hessian-603"><span class="linenos">603</span></a>	<span class="c1">#output from aoforce calculation</span>
</span><span id="read_hessian-604"><a href="#read_hessian-604"><span class="linenos">604</span></a>	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">7</span><span class="p">):</span>
</span><span id="read_hessian-605"><a href="#read_hessian-605"><span class="linenos">605</span></a>		<span class="n">lower</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="read_hessian-606"><a href="#read_hessian-606"><span class="linenos">606</span></a>		<span class="n">aoforce_format</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="read_hessian-607"><a href="#read_hessian-607"><span class="linenos">607</span></a>		<span class="c1"># because of $end statement</span>
</span><span id="read_hessian-608"><a href="#read_hessian-608"><span class="linenos">608</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">datContent</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="read_hessian-609"><a href="#read_hessian-609"><span class="linenos">609</span></a>	<span class="k">elif</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">5</span><span class="p">):</span>
</span><span id="read_hessian-610"><a href="#read_hessian-610"><span class="linenos">610</span></a>		<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_hessian-611"><a href="#read_hessian-611"><span class="linenos">611</span></a>		<span class="n">aoforce_format</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="read_hessian-612"><a href="#read_hessian-612"><span class="linenos">612</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="read_hessian-613"><a href="#read_hessian-613"><span class="linenos">613</span></a>		<span class="n">aoforce_format</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="read_hessian-614"><a href="#read_hessian-614"><span class="linenos">614</span></a>		<span class="n">lower</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="read_hessian-615"><a href="#read_hessian-615"><span class="linenos">615</span></a>
</span><span id="read_hessian-616"><a href="#read_hessian-616"><span class="linenos">616</span></a>	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">)):</span>
</span><span id="read_hessian-617"><a href="#read_hessian-617"><span class="linenos">617</span></a>		<span class="c1">#handle aoforce calculation and mismatch of first lines 1 1, .., 1|10  (-&gt; read wrong)</span>
</span><span id="read_hessian-618"><a href="#read_hessian-618"><span class="linenos">618</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">aoforce_format</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>			
</span><span id="read_hessian-619"><a href="#read_hessian-619"><span class="linenos">619</span></a>			<span class="k">try</span><span class="p">:</span>
</span><span id="read_hessian-620"><a href="#read_hessian-620"><span class="linenos">620</span></a>				<span class="nb">int</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</span><span id="read_hessian-621"><a href="#read_hessian-621"><span class="linenos">621</span></a>			<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="read_hessian-622"><a href="#read_hessian-622"><span class="linenos">622</span></a>				<span class="n">lower</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="read_hessian-623"><a href="#read_hessian-623"><span class="linenos">623</span></a>		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">j</span><span class="p">])):</span>
</span><span id="read_hessian-624"><a href="#read_hessian-624"><span class="linenos">624</span></a>			<span class="n">counter</span> <span class="o">+=</span><span class="mi">1</span>
</span><span id="read_hessian-625"><a href="#read_hessian-625"><span class="linenos">625</span></a>			<span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">counter</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">))</span>
</span><span id="read_hessian-626"><a href="#read_hessian-626"><span class="linenos">626</span></a>			<span class="n">col</span> <span class="o">=</span> <span class="p">(</span><span class="n">counter</span><span class="o">-</span><span class="n">row</span><span class="o">*</span><span class="n">n_atoms</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
</span><span id="read_hessian-627"><a href="#read_hessian-627"><span class="linenos">627</span></a>			<span class="n">hessian</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</span><span id="read_hessian-628"><a href="#read_hessian-628"><span class="linenos">628</span></a>
</span><span id="read_hessian-629"><a href="#read_hessian-629"><span class="linenos">629</span></a>		<span class="c1">#reset lower for next lines</span>
</span><span id="read_hessian-630"><a href="#read_hessian-630"><span class="linenos">630</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">aoforce_format</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="read_hessian-631"><a href="#read_hessian-631"><span class="linenos">631</span></a>			<span class="n">lower</span> <span class="o">=</span> <span class="mi">2</span>	
</span><span id="read_hessian-632"><a href="#read_hessian-632"><span class="linenos">632</span></a>			
</span><span id="read_hessian-633"><a href="#read_hessian-633"><span class="linenos">633</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">counter</span> <span class="o">!=</span> <span class="n">n_atoms</span><span class="o">**</span><span class="mi">2</span><span class="p">):</span>
</span><span id="read_hessian-634"><a href="#read_hessian-634"><span class="linenos">634</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;n_atoms wrong. Check dimensions&#39;</span><span class="p">)</span>		
</span><span id="read_hessian-635"><a href="#read_hessian-635"><span class="linenos">635</span></a>	<span class="k">return</span> <span class="n">hessian</span>
</span></pre></div>


            <div class="docstring"><p>Reads hessian from turbomole format and converts it to matrix of float</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String) :</strong>  Filename</li>
<li><strong>param2 (int) :</strong>  Number of atoms</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>np.ndarray</p>
</blockquote>
</div>


                </section>
                <section id="create_dynamical_matrix">
                            <input id="create_dynamical_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_dynamical_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename_hessian</span>, </span><span class="param"><span class="n">filename_coord</span>, </span><span class="param"><span class="n">t2SI</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span></span>)</span>

                <label class="view-source-button" for="create_dynamical_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_dynamical_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_dynamical_matrix-637"><a href="#create_dynamical_matrix-637"><span class="linenos">637</span></a><span class="k">def</span> <span class="nf">create_dynamical_matrix</span><span class="p">(</span><span class="n">filename_hessian</span><span class="p">,</span> <span class="n">filename_coord</span><span class="p">,</span> <span class="n">t2SI</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
</span><span id="create_dynamical_matrix-638"><a href="#create_dynamical_matrix-638"><span class="linenos">638</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_dynamical_matrix-639"><a href="#create_dynamical_matrix-639"><span class="linenos">639</span></a><span class="sd">	Creates dynamical matrix by mass weighting hessian. Default output in turbomole format (hartree/bohr**2)</span>
</span><span id="create_dynamical_matrix-640"><a href="#create_dynamical_matrix-640"><span class="linenos">640</span></a><span class="sd">	Args:</span>
</span><span id="create_dynamical_matrix-641"><a href="#create_dynamical_matrix-641"><span class="linenos">641</span></a><span class="sd">		param1 (String) : Filename to hessian</span>
</span><span id="create_dynamical_matrix-642"><a href="#create_dynamical_matrix-642"><span class="linenos">642</span></a><span class="sd">		param2 (String) : Filename to coord file (xyz or turbomole format)</span>
</span><span id="create_dynamical_matrix-643"><a href="#create_dynamical_matrix-643"><span class="linenos">643</span></a><span class="sd">		param3 (boolean) : convert ouptput from turbomole (hartree/bohr**2) in SI units</span>
</span><span id="create_dynamical_matrix-644"><a href="#create_dynamical_matrix-644"><span class="linenos">644</span></a><span class="sd">		param3 (int) : number of dimensions</span>
</span><span id="create_dynamical_matrix-645"><a href="#create_dynamical_matrix-645"><span class="linenos">645</span></a>
</span><span id="create_dynamical_matrix-646"><a href="#create_dynamical_matrix-646"><span class="linenos">646</span></a><span class="sd">	Returns:</span>
</span><span id="create_dynamical_matrix-647"><a href="#create_dynamical_matrix-647"><span class="linenos">647</span></a><span class="sd">		np.ndarray </span>
</span><span id="create_dynamical_matrix-648"><a href="#create_dynamical_matrix-648"><span class="linenos">648</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="create_dynamical_matrix-649"><a href="#create_dynamical_matrix-649"><span class="linenos">649</span></a>	<span class="c1">#read atoms from file</span>
</span><span id="create_dynamical_matrix-650"><a href="#create_dynamical_matrix-650"><span class="linenos">650</span></a>	<span class="n">atoms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="create_dynamical_matrix-651"><a href="#create_dynamical_matrix-651"><span class="linenos">651</span></a>	<span class="c1">#check if xyz or turbomoleformat is parsed</span>
</span><span id="create_dynamical_matrix-652"><a href="#create_dynamical_matrix-652"><span class="linenos">652</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">fnmatch</span><span class="o">.</span><span class="n">fnmatch</span><span class="p">(</span><span class="n">filename_coord</span><span class="p">,</span> <span class="s1">&#39;*.xyz&#39;</span><span class="p">)):</span>
</span><span id="create_dynamical_matrix-653"><a href="#create_dynamical_matrix-653"><span class="linenos">653</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">load_xyz_file</span><span class="p">(</span><span class="n">filename_coord</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="create_dynamical_matrix-654"><a href="#create_dynamical_matrix-654"><span class="linenos">654</span></a>		<span class="n">atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">datContent</span><span class="p">)</span>
</span><span id="create_dynamical_matrix-655"><a href="#create_dynamical_matrix-655"><span class="linenos">655</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="create_dynamical_matrix-656"><a href="#create_dynamical_matrix-656"><span class="linenos">656</span></a>		<span class="n">datContent</span> <span class="o">=</span> <span class="n">read_coord_file</span><span class="p">(</span><span class="n">filename_coord</span><span class="p">)</span>
</span><span id="create_dynamical_matrix-657"><a href="#create_dynamical_matrix-657"><span class="linenos">657</span></a>		<span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">datContent</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">datContent</span><span class="p">))]</span>
</span><span id="create_dynamical_matrix-658"><a href="#create_dynamical_matrix-658"><span class="linenos">658</span></a>	<span class="c1">#determine atom masses</span>
</span><span id="create_dynamical_matrix-659"><a href="#create_dynamical_matrix-659"><span class="linenos">659</span></a>	<span class="n">masses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="create_dynamical_matrix-660"><a href="#create_dynamical_matrix-660"><span class="linenos">660</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="create_dynamical_matrix-661"><a href="#create_dynamical_matrix-661"><span class="linenos">661</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">t2SI</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
</span><span id="create_dynamical_matrix-662"><a href="#create_dynamical_matrix-662"><span class="linenos">662</span></a>			<span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_weight</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">u2kg</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="create_dynamical_matrix-663"><a href="#create_dynamical_matrix-663"><span class="linenos">663</span></a>		<span class="k">else</span><span class="p">:</span>
</span><span id="create_dynamical_matrix-664"><a href="#create_dynamical_matrix-664"><span class="linenos">664</span></a>			<span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_weight</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="create_dynamical_matrix-665"><a href="#create_dynamical_matrix-665"><span class="linenos">665</span></a>
</span><span id="create_dynamical_matrix-666"><a href="#create_dynamical_matrix-666"><span class="linenos">666</span></a>	<span class="c1">#create dynamical matrix by mass weighting hessian</span>
</span><span id="create_dynamical_matrix-667"><a href="#create_dynamical_matrix-667"><span class="linenos">667</span></a>	<span class="n">hessian</span> <span class="o">=</span> <span class="n">read_hessian</span><span class="p">(</span><span class="n">filename_hessian</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="n">dimensions</span><span class="p">)</span>
</span><span id="create_dynamical_matrix-668"><a href="#create_dynamical_matrix-668"><span class="linenos">668</span></a>
</span><span id="create_dynamical_matrix-669"><a href="#create_dynamical_matrix-669"><span class="linenos">669</span></a>	<span class="n">dynamical_matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span><span class="o">*</span><span class="n">dimensions</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span><span class="o">*</span><span class="n">dimensions</span><span class="p">))</span>
</span><span id="create_dynamical_matrix-670"><a href="#create_dynamical_matrix-670"><span class="linenos">670</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span><span class="o">*</span><span class="n">dimensions</span><span class="p">):</span>
</span><span id="create_dynamical_matrix-671"><a href="#create_dynamical_matrix-671"><span class="linenos">671</span></a>		<span class="k">if</span><span class="p">(</span><span class="n">t2SI</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
</span><span id="create_dynamical_matrix-672"><a href="#create_dynamical_matrix-672"><span class="linenos">672</span></a>			<span class="c1">#har/bohr**2 -&gt; J/m**2</span>
</span><span id="create_dynamical_matrix-673"><a href="#create_dynamical_matrix-673"><span class="linenos">673</span></a>			<span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(((</span><span class="mf">1.89</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.294</span><span class="p">))</span><span class="o">*</span><span class="mi">1000</span>
</span><span id="create_dynamical_matrix-674"><a href="#create_dynamical_matrix-674"><span class="linenos">674</span></a>		<span class="n">dynamical_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">masses</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">dimensions</span><span class="p">)]</span><span class="o">*</span><span class="n">masses</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">dimensions</span><span class="p">)]))</span><span class="o">*</span><span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
</span><span id="create_dynamical_matrix-675"><a href="#create_dynamical_matrix-675"><span class="linenos">675</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
</span><span id="create_dynamical_matrix-676"><a href="#create_dynamical_matrix-676"><span class="linenos">676</span></a>			<span class="c1">#har/bohr**2 -&gt; J/m**2</span>
</span><span id="create_dynamical_matrix-677"><a href="#create_dynamical_matrix-677"><span class="linenos">677</span></a>			<span class="k">if</span><span class="p">(</span><span class="n">t2SI</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
</span><span id="create_dynamical_matrix-678"><a href="#create_dynamical_matrix-678"><span class="linenos">678</span></a>				<span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(((</span><span class="mf">1.89</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.294</span><span class="p">))</span><span class="o">*</span><span class="mi">1000</span>
</span><span id="create_dynamical_matrix-679"><a href="#create_dynamical_matrix-679"><span class="linenos">679</span></a>			<span class="n">dynamical_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">masses</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">dimensions</span><span class="p">)]</span><span class="o">*</span><span class="n">masses</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="o">/</span><span class="n">dimensions</span><span class="p">)]))</span><span class="o">*</span><span class="n">hessian</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
</span><span id="create_dynamical_matrix-680"><a href="#create_dynamical_matrix-680"><span class="linenos">680</span></a>			<span class="n">dynamical_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">dynamical_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
</span><span id="create_dynamical_matrix-681"><a href="#create_dynamical_matrix-681"><span class="linenos">681</span></a>	<span class="k">return</span> <span class="n">dynamical_matrix</span>
</span></pre></div>


            <div class="docstring"><p>Creates dynamical matrix by mass weighting hessian. Default output in turbomole format (hartree/bohr**2)</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String) :</strong>  Filename to hessian</li>
<li><strong>param2 (String) :</strong>  Filename to coord file (xyz or turbomole format)</li>
<li><strong>param3 (boolean) :</strong>  convert ouptput from turbomole (hartree/bohr**2) in SI units</li>
<li><strong>param3 (int) :</strong>  number of dimensions</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>np.ndarray</p>
</blockquote>
</div>


                </section>
                <section id="atom_weight">
                            <input id="atom_weight-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">atom_weight</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">atom</span>, </span><span class="param"><span class="n">u2kg</span><span class="o">=</span><span class="kc">False</span></span>)</span>

                <label class="view-source-button" for="atom_weight-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#atom_weight"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="atom_weight-684"><a href="#atom_weight-684"><span class="linenos">684</span></a><span class="k">def</span> <span class="nf">atom_weight</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">u2kg</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="atom_weight-685"><a href="#atom_weight-685"><span class="linenos">685</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="atom_weight-686"><a href="#atom_weight-686"><span class="linenos">686</span></a><span class="sd">    Return mass of atom in kg or au (au is default)</span>
</span><span id="atom_weight-687"><a href="#atom_weight-687"><span class="linenos">687</span></a><span class="sd">    Args:</span>
</span><span id="atom_weight-688"><a href="#atom_weight-688"><span class="linenos">688</span></a><span class="sd">        param1 (String) : Atom type</span>
</span><span id="atom_weight-689"><a href="#atom_weight-689"><span class="linenos">689</span></a><span class="sd">        param2 (boolean) : convert to kg</span>
</span><span id="atom_weight-690"><a href="#atom_weight-690"><span class="linenos">690</span></a>
</span><span id="atom_weight-691"><a href="#atom_weight-691"><span class="linenos">691</span></a><span class="sd">    Returns:</span>
</span><span id="atom_weight-692"><a href="#atom_weight-692"><span class="linenos">692</span></a><span class="sd">        float</span>
</span><span id="atom_weight-693"><a href="#atom_weight-693"><span class="linenos">693</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="atom_weight-694"><a href="#atom_weight-694"><span class="linenos">694</span></a>	<span class="n">atom</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="atom_weight-695"><a href="#atom_weight-695"><span class="linenos">695</span></a>
</span><span id="atom_weight-696"><a href="#atom_weight-696"><span class="linenos">696</span></a>	<span class="n">u</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">U2KG</span>
</span><span id="atom_weight-697"><a href="#atom_weight-697"><span class="linenos">697</span></a>	<span class="k">if</span> <span class="p">(</span><span class="n">u2kg</span> <span class="o">==</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="atom_weight-698"><a href="#atom_weight-698"><span class="linenos">698</span></a>		<span class="n">u</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="atom_weight-699"><a href="#atom_weight-699"><span class="linenos">699</span></a>	<span class="k">if</span> <span class="p">(</span><span class="n">atom</span> <span class="o">==</span> <span class="s2">&quot;test&quot;</span><span class="p">):</span>
</span><span id="atom_weight-700"><a href="#atom_weight-700"><span class="linenos">700</span></a>		<span class="k">return</span> <span class="mf">1.0</span>
</span><span id="atom_weight-701"><a href="#atom_weight-701"><span class="linenos">701</span></a>	<span class="k">try</span><span class="p">:</span>
</span><span id="atom_weight-702"><a href="#atom_weight-702"><span class="linenos">702</span></a>		<span class="n">dict_entry</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">ATOM_DICT_SYM</span><span class="p">[</span><span class="n">atom</span><span class="p">]</span>
</span><span id="atom_weight-703"><a href="#atom_weight-703"><span class="linenos">703</span></a>		<span class="n">atom_weight</span> <span class="o">=</span> <span class="n">dict_entry</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="atom_weight-704"><a href="#atom_weight-704"><span class="linenos">704</span></a>	<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="atom_weight-705"><a href="#atom_weight-705"><span class="linenos">705</span></a>		<span class="n">error_text</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Element </span><span class="si">{</span><span class="n">atom</span><span class="si">}</span><span class="s2"> cannot be found. Raising exception </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="atom_weight-706"><a href="#atom_weight-706"><span class="linenos">706</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_text</span><span class="p">)</span>
</span><span id="atom_weight-707"><a href="#atom_weight-707"><span class="linenos">707</span></a>
</span><span id="atom_weight-708"><a href="#atom_weight-708"><span class="linenos">708</span></a>	<span class="k">return</span> <span class="n">atom_weight</span> <span class="o">*</span> <span class="n">u</span>
</span></pre></div>


            <div class="docstring"><p>Return mass of atom in kg or au (au is default)</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String) :</strong>  Atom type</li>
<li><strong>param2 (boolean) :</strong>  convert to kg</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>float</p>
</blockquote>
</div>


                </section>
                <section id="align_molecule">
                            <input id="align_molecule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">align_molecule</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord</span>, </span><span class="param"><span class="n">axis</span>, </span><span class="param"><span class="n">molecule_axis</span></span>)</span>

                <label class="view-source-button" for="align_molecule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#align_molecule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="align_molecule-711"><a href="#align_molecule-711"><span class="linenos">711</span></a><span class="k">def</span> <span class="nf">align_molecule</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">molecule_axis</span><span class="p">):</span>
</span><span id="align_molecule-712"><a href="#align_molecule-712"><span class="linenos">712</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="align_molecule-713"><a href="#align_molecule-713"><span class="linenos">713</span></a><span class="sd">	Aligns molecule stored in coord along axis. Molecule_axis[0/1] give the indices of molecules which define the molecule</span>
</span><span id="align_molecule-714"><a href="#align_molecule-714"><span class="linenos">714</span></a><span class="sd">	axis. Please note: coord = top.load_xyz_file(filename)</span>
</span><span id="align_molecule-715"><a href="#align_molecule-715"><span class="linenos">715</span></a><span class="sd">	Args:</span>
</span><span id="align_molecule-716"><a href="#align_molecule-716"><span class="linenos">716</span></a><span class="sd">		coord: coord file read with top from xyz file (coord = op.load_xyz_file(filename)))</span>
</span><span id="align_molecule-717"><a href="#align_molecule-717"><span class="linenos">717</span></a><span class="sd">		axis: axis is aligned along axis -&gt; axis[x,y,z]</span>
</span><span id="align_molecule-718"><a href="#align_molecule-718"><span class="linenos">718</span></a><span class="sd">		molecule_axis: indices of atoms in coord which define the molecule axis (index1, index2)</span>
</span><span id="align_molecule-719"><a href="#align_molecule-719"><span class="linenos">719</span></a>
</span><span id="align_molecule-720"><a href="#align_molecule-720"><span class="linenos">720</span></a>
</span><span id="align_molecule-721"><a href="#align_molecule-721"><span class="linenos">721</span></a><span class="sd">	Returns:</span>
</span><span id="align_molecule-722"><a href="#align_molecule-722"><span class="linenos">722</span></a><span class="sd">	Rotated coord file</span>
</span><span id="align_molecule-723"><a href="#align_molecule-723"><span class="linenos">723</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="align_molecule-724"><a href="#align_molecule-724"><span class="linenos">724</span></a>
</span><span id="align_molecule-725"><a href="#align_molecule-725"><span class="linenos">725</span></a>
</span><span id="align_molecule-726"><a href="#align_molecule-726"><span class="linenos">726</span></a>	<span class="c1"># calculate vec(molecule_axis[0]-&gt;molecule_axis[1])</span>
</span><span id="align_molecule-727"><a href="#align_molecule-727"><span class="linenos">727</span></a>	<span class="n">x_left</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-728"><a href="#align_molecule-728"><span class="linenos">728</span></a>	<span class="n">y_left</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-729"><a href="#align_molecule-729"><span class="linenos">729</span></a>	<span class="n">z_left</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-730"><a href="#align_molecule-730"><span class="linenos">730</span></a>
</span><span id="align_molecule-731"><a href="#align_molecule-731"><span class="linenos">731</span></a>	<span class="c1"># shift to orgin</span>
</span><span id="align_molecule-732"><a href="#align_molecule-732"><span class="linenos">732</span></a>	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="align_molecule-733"><a href="#align_molecule-733"><span class="linenos">733</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_left</span>
</span><span id="align_molecule-734"><a href="#align_molecule-734"><span class="linenos">734</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_left</span>
</span><span id="align_molecule-735"><a href="#align_molecule-735"><span class="linenos">735</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">z_left</span>
</span><span id="align_molecule-736"><a href="#align_molecule-736"><span class="linenos">736</span></a>
</span><span id="align_molecule-737"><a href="#align_molecule-737"><span class="linenos">737</span></a>	<span class="n">x_left</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="align_molecule-738"><a href="#align_molecule-738"><span class="linenos">738</span></a>	<span class="n">y_left</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="align_molecule-739"><a href="#align_molecule-739"><span class="linenos">739</span></a>	<span class="n">z_left</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="align_molecule-740"><a href="#align_molecule-740"><span class="linenos">740</span></a>
</span><span id="align_molecule-741"><a href="#align_molecule-741"><span class="linenos">741</span></a>	<span class="n">x_right</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-742"><a href="#align_molecule-742"><span class="linenos">742</span></a>	<span class="n">y_right</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-743"><a href="#align_molecule-743"><span class="linenos">743</span></a>	<span class="n">z_right</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-744"><a href="#align_molecule-744"><span class="linenos">744</span></a>
</span><span id="align_molecule-745"><a href="#align_molecule-745"><span class="linenos">745</span></a>	<span class="n">molecule_axis</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_right</span> <span class="o">-</span> <span class="n">x_left</span><span class="p">,</span> <span class="n">y_right</span> <span class="o">-</span> <span class="n">y_left</span><span class="p">,</span> <span class="n">z_right</span> <span class="o">-</span> <span class="n">z_left</span><span class="p">]</span>
</span><span id="align_molecule-746"><a href="#align_molecule-746"><span class="linenos">746</span></a>
</span><span id="align_molecule-747"><a href="#align_molecule-747"><span class="linenos">747</span></a>	<span class="c1"># calculate rotation angel</span>
</span><span id="align_molecule-748"><a href="#align_molecule-748"><span class="linenos">748</span></a>
</span><span id="align_molecule-749"><a href="#align_molecule-749"><span class="linenos">749</span></a>	<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">molecule_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">molecule_axis</span><span class="p">))</span>
</span><span id="align_molecule-750"><a href="#align_molecule-750"><span class="linenos">750</span></a>	<span class="n">theta</span> <span class="o">=</span> <span class="n">angle</span>
</span><span id="align_molecule-751"><a href="#align_molecule-751"><span class="linenos">751</span></a>
</span><span id="align_molecule-752"><a href="#align_molecule-752"><span class="linenos">752</span></a>	<span class="k">if</span> <span class="p">(</span><span class="n">angle</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="align_molecule-753"><a href="#align_molecule-753"><span class="linenos">753</span></a>		<span class="c1"># calculate rotation axis</span>
</span><span id="align_molecule-754"><a href="#align_molecule-754"><span class="linenos">754</span></a>
</span><span id="align_molecule-755"><a href="#align_molecule-755"><span class="linenos">755</span></a>		<span class="n">rotation_axis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">molecule_axis</span><span class="p">,</span> <span class="p">[</span><span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
</span><span id="align_molecule-756"><a href="#align_molecule-756"><span class="linenos">756</span></a>		<span class="n">rotation_axis</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">rotation_axis</span><span class="p">)</span> <span class="o">*</span> <span class="n">rotation_axis</span>
</span><span id="align_molecule-757"><a href="#align_molecule-757"><span class="linenos">757</span></a>		<span class="n">u</span> <span class="o">=</span> <span class="n">rotation_axis</span>
</span><span id="align_molecule-758"><a href="#align_molecule-758"><span class="linenos">758</span></a>		<span class="c1"># print(&quot;rotation axis &quot; + str(rotation_axis))</span>
</span><span id="align_molecule-759"><a href="#align_molecule-759"><span class="linenos">759</span></a>
</span><span id="align_molecule-760"><a href="#align_molecule-760"><span class="linenos">760</span></a>		<span class="c1"># calculate rotation_matrix</span>
</span><span id="align_molecule-761"><a href="#align_molecule-761"><span class="linenos">761</span></a>		<span class="n">rotation_matrix</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="align_molecule-762"><a href="#align_molecule-762"><span class="linenos">762</span></a>			<span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)),</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
</span><span id="align_molecule-763"><a href="#align_molecule-763"><span class="linenos">763</span></a>			 <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],</span>
</span><span id="align_molecule-764"><a href="#align_molecule-764"><span class="linenos">764</span></a>			<span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)),</span>
</span><span id="align_molecule-765"><a href="#align_molecule-765"><span class="linenos">765</span></a>			 <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],</span>
</span><span id="align_molecule-766"><a href="#align_molecule-766"><span class="linenos">766</span></a>			<span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
</span><span id="align_molecule-767"><a href="#align_molecule-767"><span class="linenos">767</span></a>			 <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))]]</span>
</span><span id="align_molecule-768"><a href="#align_molecule-768"><span class="linenos">768</span></a>
</span><span id="align_molecule-769"><a href="#align_molecule-769"><span class="linenos">769</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="align_molecule-770"><a href="#align_molecule-770"><span class="linenos">770</span></a>			<span class="n">vector_to_rotate</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">),</span>
</span><span id="align_molecule-771"><a href="#align_molecule-771"><span class="linenos">771</span></a>								<span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)]</span>
</span><span id="align_molecule-772"><a href="#align_molecule-772"><span class="linenos">772</span></a>			<span class="n">rotated_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">vector_to_rotate</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="align_molecule-773"><a href="#align_molecule-773"><span class="linenos">773</span></a>
</span><span id="align_molecule-774"><a href="#align_molecule-774"><span class="linenos">774</span></a>			<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">rotated_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-775"><a href="#align_molecule-775"><span class="linenos">775</span></a>			<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">rotated_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-776"><a href="#align_molecule-776"><span class="linenos">776</span></a>			<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">rotated_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="align_molecule-777"><a href="#align_molecule-777"><span class="linenos">777</span></a>		<span class="k">return</span> <span class="n">coord</span>
</span><span id="align_molecule-778"><a href="#align_molecule-778"><span class="linenos">778</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="align_molecule-779"><a href="#align_molecule-779"><span class="linenos">779</span></a>		<span class="k">return</span> <span class="n">coord</span>
</span></pre></div>


            <div class="docstring"><p>Aligns molecule stored in coord along axis. Molecule_axis[0/1] give the indices of molecules which define the molecule
axis. Please note: coord = top.load_xyz_file(filename)</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord:</strong>  coord file read with top from xyz file (coord = op.load_xyz_file(filename)))</li>
<li><strong>axis:</strong>  axis is aligned along axis -> axis[x,y,z]</li>
<li><strong>molecule_axis:</strong>  indices of atoms in coord which define the molecule axis (index1, index2)</li>
</ul>

<p>Returns:
Rotated coord file</p>
</div>


                </section>
                <section id="x2t">
                            <input id="x2t-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">x2t</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_xyz</span></span>)</span>

                <label class="view-source-button" for="x2t-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#x2t"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="x2t-781"><a href="#x2t-781"><span class="linenos">781</span></a><span class="k">def</span> <span class="nf">x2t</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">):</span>
</span><span id="x2t-782"><a href="#x2t-782"><span class="linenos">782</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="x2t-783"><a href="#x2t-783"><span class="linenos">783</span></a><span class="sd">	Transforms coord_xyz from xyz format to turbomole</span>
</span><span id="x2t-784"><a href="#x2t-784"><span class="linenos">784</span></a><span class="sd">	Args:</span>
</span><span id="x2t-785"><a href="#x2t-785"><span class="linenos">785</span></a><span class="sd">		coord_xyz: coord array in xyz</span>
</span><span id="x2t-786"><a href="#x2t-786"><span class="linenos">786</span></a>
</span><span id="x2t-787"><a href="#x2t-787"><span class="linenos">787</span></a><span class="sd">	Returns:</span>
</span><span id="x2t-788"><a href="#x2t-788"><span class="linenos">788</span></a><span class="sd">	coord in turbomole format</span>
</span><span id="x2t-789"><a href="#x2t-789"><span class="linenos">789</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="x2t-790"><a href="#x2t-790"><span class="linenos">790</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">coord_xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="x2t-791"><a href="#x2t-791"><span class="linenos">791</span></a>	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)):</span>
</span><span id="x2t-792"><a href="#x2t-792"><span class="linenos">792</span></a>		<span class="n">x</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="x2t-793"><a href="#x2t-793"><span class="linenos">793</span></a>		<span class="n">y</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="x2t-794"><a href="#x2t-794"><span class="linenos">794</span></a>		<span class="n">z</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="x2t-795"><a href="#x2t-795"><span class="linenos">795</span></a>		<span class="n">element</span> <span class="o">=</span> <span class="n">coord_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="x2t-796"><a href="#x2t-796"><span class="linenos">796</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">__ang2bohr__</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">__ang2bohr__</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="n">__ang2bohr__</span><span class="p">,</span> <span class="n">element</span><span class="p">])</span>
</span><span id="x2t-797"><a href="#x2t-797"><span class="linenos">797</span></a>
</span><span id="x2t-798"><a href="#x2t-798"><span class="linenos">798</span></a>	<span class="k">return</span> <span class="n">coord</span>
</span></pre></div>


            <div class="docstring"><p>Transforms coord_xyz from xyz format to turbomole</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord_xyz:</strong>  coord array in xyz</li>
</ul>

<p>Returns:
coord in turbomole format</p>
</div>


                </section>
                <section id="fix_atoms">
                            <input id="fix_atoms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fix_atoms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord</span>, </span><span class="param"><span class="n">indices</span></span>)</span>

                <label class="view-source-button" for="fix_atoms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#fix_atoms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="fix_atoms-800"><a href="#fix_atoms-800"><span class="linenos">800</span></a><span class="k">def</span> <span class="nf">fix_atoms</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">indices</span><span class="p">):</span>
</span><span id="fix_atoms-801"><a href="#fix_atoms-801"><span class="linenos">801</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="fix_atoms-802"><a href="#fix_atoms-802"><span class="linenos">802</span></a><span class="sd">	fixes atoms in indices in turbomole coord file coord</span>
</span><span id="fix_atoms-803"><a href="#fix_atoms-803"><span class="linenos">803</span></a><span class="sd">	Args:</span>
</span><span id="fix_atoms-804"><a href="#fix_atoms-804"><span class="linenos">804</span></a><span class="sd">		coord: coord file read with top.read_coord_file</span>
</span><span id="fix_atoms-805"><a href="#fix_atoms-805"><span class="linenos">805</span></a><span class="sd">		indices: array-like of indices in coord file which should be fixed. &quot;all&quot; is also possible -&gt; every atom is fixed</span>
</span><span id="fix_atoms-806"><a href="#fix_atoms-806"><span class="linenos">806</span></a>
</span><span id="fix_atoms-807"><a href="#fix_atoms-807"><span class="linenos">807</span></a><span class="sd">	Returns:</span>
</span><span id="fix_atoms-808"><a href="#fix_atoms-808"><span class="linenos">808</span></a><span class="sd">	coord with fixed atoms</span>
</span><span id="fix_atoms-809"><a href="#fix_atoms-809"><span class="linenos">809</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="fix_atoms-810"><a href="#fix_atoms-810"><span class="linenos">810</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">indices</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>
</span><span id="fix_atoms-811"><a href="#fix_atoms-811"><span class="linenos">811</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="fix_atoms-812"><a href="#fix_atoms-812"><span class="linenos">812</span></a>			<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">):</span>
</span><span id="fix_atoms-813"><a href="#fix_atoms-813"><span class="linenos">813</span></a>				<span class="n">new</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span><span id="fix_atoms-814"><a href="#fix_atoms-814"><span class="linenos">814</span></a>				<span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
</span><span id="fix_atoms-815"><a href="#fix_atoms-815"><span class="linenos">815</span></a>				<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span>
</span><span id="fix_atoms-816"><a href="#fix_atoms-816"><span class="linenos">816</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="fix_atoms-817"><a href="#fix_atoms-817"><span class="linenos">817</span></a>		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
</span><span id="fix_atoms-818"><a href="#fix_atoms-818"><span class="linenos">818</span></a>			<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">):</span>
</span><span id="fix_atoms-819"><a href="#fix_atoms-819"><span class="linenos">819</span></a>				<span class="n">new</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</span><span id="fix_atoms-820"><a href="#fix_atoms-820"><span class="linenos">820</span></a>				<span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)</span>
</span><span id="fix_atoms-821"><a href="#fix_atoms-821"><span class="linenos">821</span></a>				<span class="n">coord</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span>
</span><span id="fix_atoms-822"><a href="#fix_atoms-822"><span class="linenos">822</span></a>
</span><span id="fix_atoms-823"><a href="#fix_atoms-823"><span class="linenos">823</span></a>	<span class="k">return</span> <span class="n">coord</span>
</span></pre></div>


            <div class="docstring"><p>fixes atoms in indices in turbomole coord file coord</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord:</strong>  coord file read with top.read_coord_file</li>
<li><strong>indices:</strong>  array-like of indices in coord file which should be fixed. "all" is also possible -> every atom is fixed</li>
</ul>

<p>Returns:
coord with fixed atoms</p>
</div>


                </section>
                <section id="atom_type_to_number">
                            <input id="atom_type_to_number-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">atom_type_to_number</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">atom_type</span></span>)</span>

                <label class="view-source-button" for="atom_type_to_number-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#atom_type_to_number"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="atom_type_to_number-825"><a href="#atom_type_to_number-825"><span class="linenos">825</span></a><span class="k">def</span> <span class="nf">atom_type_to_number</span><span class="p">(</span><span class="n">atom_type</span><span class="p">):</span>
</span><span id="atom_type_to_number-826"><a href="#atom_type_to_number-826"><span class="linenos">826</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="atom_type_to_number-827"><a href="#atom_type_to_number-827"><span class="linenos">827</span></a><span class="sd">	returns ordinal number of atom</span>
</span><span id="atom_type_to_number-828"><a href="#atom_type_to_number-828"><span class="linenos">828</span></a>
</span><span id="atom_type_to_number-829"><a href="#atom_type_to_number-829"><span class="linenos">829</span></a><span class="sd">	Args:</span>
</span><span id="atom_type_to_number-830"><a href="#atom_type_to_number-830"><span class="linenos">830</span></a><span class="sd">		param1 (String): atom type		</span>
</span><span id="atom_type_to_number-831"><a href="#atom_type_to_number-831"><span class="linenos">831</span></a>
</span><span id="atom_type_to_number-832"><a href="#atom_type_to_number-832"><span class="linenos">832</span></a><span class="sd">	Returns:</span>
</span><span id="atom_type_to_number-833"><a href="#atom_type_to_number-833"><span class="linenos">833</span></a><span class="sd">		ordinal number (int)</span>
</span><span id="atom_type_to_number-834"><a href="#atom_type_to_number-834"><span class="linenos">834</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="atom_type_to_number-835"><a href="#atom_type_to_number-835"><span class="linenos">835</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;h&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-836"><a href="#atom_type_to_number-836"><span class="linenos">836</span></a>		<span class="k">return</span> <span class="mi">1</span>
</span><span id="atom_type_to_number-837"><a href="#atom_type_to_number-837"><span class="linenos">837</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;c&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-838"><a href="#atom_type_to_number-838"><span class="linenos">838</span></a>		<span class="k">return</span> <span class="mi">6</span>
</span><span id="atom_type_to_number-839"><a href="#atom_type_to_number-839"><span class="linenos">839</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;n&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-840"><a href="#atom_type_to_number-840"><span class="linenos">840</span></a>		<span class="k">return</span> <span class="mi">7</span>
</span><span id="atom_type_to_number-841"><a href="#atom_type_to_number-841"><span class="linenos">841</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;o&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-842"><a href="#atom_type_to_number-842"><span class="linenos">842</span></a>		<span class="k">return</span> <span class="mi">8</span>
</span><span id="atom_type_to_number-843"><a href="#atom_type_to_number-843"><span class="linenos">843</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;f&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-844"><a href="#atom_type_to_number-844"><span class="linenos">844</span></a>		<span class="k">return</span> <span class="mi">9</span>
</span><span id="atom_type_to_number-845"><a href="#atom_type_to_number-845"><span class="linenos">845</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;cl&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-846"><a href="#atom_type_to_number-846"><span class="linenos">846</span></a>		<span class="k">return</span> <span class="mi">17</span>
</span><span id="atom_type_to_number-847"><a href="#atom_type_to_number-847"><span class="linenos">847</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-848"><a href="#atom_type_to_number-848"><span class="linenos">848</span></a>		<span class="k">return</span> <span class="mi">35</span>
</span><span id="atom_type_to_number-849"><a href="#atom_type_to_number-849"><span class="linenos">849</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;i&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-850"><a href="#atom_type_to_number-850"><span class="linenos">850</span></a>		<span class="k">return</span> <span class="mi">53</span>
</span><span id="atom_type_to_number-851"><a href="#atom_type_to_number-851"><span class="linenos">851</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;au&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-852"><a href="#atom_type_to_number-852"><span class="linenos">852</span></a>		<span class="k">return</span> <span class="mi">79</span>
</span><span id="atom_type_to_number-853"><a href="#atom_type_to_number-853"><span class="linenos">853</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-854"><a href="#atom_type_to_number-854"><span class="linenos">854</span></a>		<span class="k">return</span> <span class="mi">16</span>
</span><span id="atom_type_to_number-855"><a href="#atom_type_to_number-855"><span class="linenos">855</span></a>	<span class="k">elif</span><span class="p">(</span><span class="n">atom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;si&quot;</span><span class="p">):</span>
</span><span id="atom_type_to_number-856"><a href="#atom_type_to_number-856"><span class="linenos">856</span></a>		<span class="k">return</span> <span class="mi">14</span>
</span><span id="atom_type_to_number-857"><a href="#atom_type_to_number-857"><span class="linenos">857</span></a>	<span class="k">else</span><span class="p">:</span>
</span><span id="atom_type_to_number-858"><a href="#atom_type_to_number-858"><span class="linenos">858</span></a>		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sorry I do not know this atom yet&quot;</span><span class="p">)</span>
</span><span id="atom_type_to_number-859"><a href="#atom_type_to_number-859"><span class="linenos">859</span></a>		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span></pre></div>


            <div class="docstring"><p>returns ordinal number of atom</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>param1 (String):</strong>  atom type              </li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>ordinal number (int)</p>
</blockquote>
</div>


                </section>
                <section id="determine_n_orbitals">
                            <input id="determine_n_orbitals-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">determine_n_orbitals</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_path</span>, </span><span class="param"><span class="n">basis_set</span><span class="o">=</span><span class="s1">&#39;dev-SV(P)&#39;</span></span>)</span>

                <label class="view-source-button" for="determine_n_orbitals-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#determine_n_orbitals"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="determine_n_orbitals-861"><a href="#determine_n_orbitals-861"><span class="linenos">861</span></a><span class="k">def</span> <span class="nf">determine_n_orbitals</span><span class="p">(</span><span class="n">coord_path</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="s2">&quot;dev-SV(P)&quot;</span><span class="p">):</span>
</span><span id="determine_n_orbitals-862"><a href="#determine_n_orbitals-862"><span class="linenos">862</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="determine_n_orbitals-863"><a href="#determine_n_orbitals-863"><span class="linenos">863</span></a><span class="sd">	Determines number of orbitals for calculation using coord file (turbomole format, xyz support is planned) and basis set.</span>
</span><span id="determine_n_orbitals-864"><a href="#determine_n_orbitals-864"><span class="linenos">864</span></a><span class="sd">	Args:</span>
</span><span id="determine_n_orbitals-865"><a href="#determine_n_orbitals-865"><span class="linenos">865</span></a><span class="sd">		coord_path (String): path to coord file (turbomole coord file)</span>
</span><span id="determine_n_orbitals-866"><a href="#determine_n_orbitals-866"><span class="linenos">866</span></a><span class="sd">		basis_set (String): basis set</span>
</span><span id="determine_n_orbitals-867"><a href="#determine_n_orbitals-867"><span class="linenos">867</span></a>
</span><span id="determine_n_orbitals-868"><a href="#determine_n_orbitals-868"><span class="linenos">868</span></a><span class="sd">	Returns:</span>
</span><span id="determine_n_orbitals-869"><a href="#determine_n_orbitals-869"><span class="linenos">869</span></a><span class="sd">		n_orbitals (int): Number of orbitals</span>
</span><span id="determine_n_orbitals-870"><a href="#determine_n_orbitals-870"><span class="linenos">870</span></a>
</span><span id="determine_n_orbitals-871"><a href="#determine_n_orbitals-871"><span class="linenos">871</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="determine_n_orbitals-872"><a href="#determine_n_orbitals-872"><span class="linenos">872</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">basis_set</span><span class="o">!=</span><span class="s2">&quot;dev-SV(P)&quot;</span><span class="p">):</span>
</span><span id="determine_n_orbitals-873"><a href="#determine_n_orbitals-873"><span class="linenos">873</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only support for dev-SV(P) Basis set right now.&quot;</span><span class="p">)</span>
</span><span id="determine_n_orbitals-874"><a href="#determine_n_orbitals-874"><span class="linenos">874</span></a>
</span><span id="determine_n_orbitals-875"><a href="#determine_n_orbitals-875"><span class="linenos">875</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">read_coord_file</span><span class="p">(</span><span class="n">coord_path</span><span class="p">)</span>
</span><span id="determine_n_orbitals-876"><a href="#determine_n_orbitals-876"><span class="linenos">876</span></a>	<span class="n">atom_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="determine_n_orbitals-877"><a href="#determine_n_orbitals-877"><span class="linenos">877</span></a>	<span class="n">ranges</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="determine_n_orbitals-878"><a href="#determine_n_orbitals-878"><span class="linenos">878</span></a>	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
</span><span id="determine_n_orbitals-879"><a href="#determine_n_orbitals-879"><span class="linenos">879</span></a>		<span class="k">try</span><span class="p">:</span>
</span><span id="determine_n_orbitals-880"><a href="#determine_n_orbitals-880"><span class="linenos">880</span></a>			<span class="n">atom_dict</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="determine_n_orbitals-881"><a href="#determine_n_orbitals-881"><span class="linenos">881</span></a>		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="determine_n_orbitals-882"><a href="#determine_n_orbitals-882"><span class="linenos">882</span></a>			<span class="n">atom_dict</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="determine_n_orbitals-883"><a href="#determine_n_orbitals-883"><span class="linenos">883</span></a>
</span><span id="determine_n_orbitals-884"><a href="#determine_n_orbitals-884"><span class="linenos">884</span></a>		<span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">find_c_range_atom</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">atom_dict</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">coord_path</span><span class="p">)</span>
</span><span id="determine_n_orbitals-885"><a href="#determine_n_orbitals-885"><span class="linenos">885</span></a>		<span class="n">ranges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</span><span id="determine_n_orbitals-886"><a href="#determine_n_orbitals-886"><span class="linenos">886</span></a>	<span class="n">n_orbitals</span> <span class="o">=</span> <span class="n">ranges</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span><span id="determine_n_orbitals-887"><a href="#determine_n_orbitals-887"><span class="linenos">887</span></a>
</span><span id="determine_n_orbitals-888"><a href="#determine_n_orbitals-888"><span class="linenos">888</span></a>	<span class="k">return</span> <span class="n">n_orbitals</span>
</span></pre></div>


            <div class="docstring"><p>Determines number of orbitals for calculation using coord file (turbomole format, xyz support is planned) and basis set.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord_path (String):</strong>  path to coord file (turbomole coord file)</li>
<li><strong>basis_set (String):</strong>  basis set</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>n_orbitals (int): Number of orbitals</p>
</blockquote>
</div>


                </section>
                <section id="remove_fixed_atoms">
                            <input id="remove_fixed_atoms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_fixed_atoms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord</span></span>)</span>

                <label class="view-source-button" for="remove_fixed_atoms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#remove_fixed_atoms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="remove_fixed_atoms-890"><a href="#remove_fixed_atoms-890"><span class="linenos">890</span></a><span class="k">def</span> <span class="nf">remove_fixed_atoms</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
</span><span id="remove_fixed_atoms-891"><a href="#remove_fixed_atoms-891"><span class="linenos">891</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="remove_fixed_atoms-892"><a href="#remove_fixed_atoms-892"><span class="linenos">892</span></a><span class="sd">	Removes fixed atoms from turbomole coord file. </span>
</span><span id="remove_fixed_atoms-893"><a href="#remove_fixed_atoms-893"><span class="linenos">893</span></a><span class="sd">	Args:</span>
</span><span id="remove_fixed_atoms-894"><a href="#remove_fixed_atoms-894"><span class="linenos">894</span></a><span class="sd">		coord: coord file data loaded with read_coord_file</span>
</span><span id="remove_fixed_atoms-895"><a href="#remove_fixed_atoms-895"><span class="linenos">895</span></a>
</span><span id="remove_fixed_atoms-896"><a href="#remove_fixed_atoms-896"><span class="linenos">896</span></a><span class="sd">	Returns:</span>
</span><span id="remove_fixed_atoms-897"><a href="#remove_fixed_atoms-897"><span class="linenos">897</span></a><span class="sd">		coord: filtered coord file data</span>
</span><span id="remove_fixed_atoms-898"><a href="#remove_fixed_atoms-898"><span class="linenos">898</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="remove_fixed_atoms-899"><a href="#remove_fixed_atoms-899"><span class="linenos">899</span></a>	<span class="n">coord_filtered</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="remove_fixed_atoms-900"><a href="#remove_fixed_atoms-900"><span class="linenos">900</span></a>	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
</span><span id="remove_fixed_atoms-901"><a href="#remove_fixed_atoms-901"><span class="linenos">901</span></a>		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">):</span>
</span><span id="remove_fixed_atoms-902"><a href="#remove_fixed_atoms-902"><span class="linenos">902</span></a>			<span class="n">coord_filtered</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="remove_fixed_atoms-903"><a href="#remove_fixed_atoms-903"><span class="linenos">903</span></a>	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_filtered</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Removes fixed atoms from turbomole coord file. </p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord:</strong>  coord file data loaded with read_coord_file</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>coord: filtered coord file data</p>
</blockquote>
</div>


                </section>
                <section id="create_sysinfo">
                            <input id="create_sysinfo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_sysinfo</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_path</span>, </span><span class="param"><span class="n">basis_path</span>, </span><span class="param"><span class="n">output_path</span></span>)</span>

                <label class="view-source-button" for="create_sysinfo-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#create_sysinfo"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="create_sysinfo-905"><a href="#create_sysinfo-905"><span class="linenos">905</span></a><span class="k">def</span> <span class="nf">create_sysinfo</span><span class="p">(</span><span class="n">coord_path</span><span class="p">,</span> <span class="n">basis_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">):</span>
</span><span id="create_sysinfo-906"><a href="#create_sysinfo-906"><span class="linenos">906</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="create_sysinfo-907"><a href="#create_sysinfo-907"><span class="linenos">907</span></a><span class="sd">	Create sysinfo according to given template. Sysinfo is used for transport calculations used by Theo 1 Group of</span>
</span><span id="create_sysinfo-908"><a href="#create_sysinfo-908"><span class="linenos">908</span></a><span class="sd">	University of Augsburg. It contains information about the orbitals, the charge, number of ecps and the coordinates of the positions</span>
</span><span id="create_sysinfo-909"><a href="#create_sysinfo-909"><span class="linenos">909</span></a><span class="sd">	{number atom} {orbital_index_start} {orbital_index_end} {charge} {number ecps} {x in Bohr} {y in Bohr} {z in Bohr}</span>
</span><span id="create_sysinfo-910"><a href="#create_sysinfo-910"><span class="linenos">910</span></a><span class="sd">	Args:</span>
</span><span id="create_sysinfo-911"><a href="#create_sysinfo-911"><span class="linenos">911</span></a><span class="sd">		coord_path (String): Path to turbomole coord file</span>
</span><span id="create_sysinfo-912"><a href="#create_sysinfo-912"><span class="linenos">912</span></a><span class="sd">		basis_path (String): Path to turbomole basis file</span>
</span><span id="create_sysinfo-913"><a href="#create_sysinfo-913"><span class="linenos">913</span></a><span class="sd">		output_path (String): Path where sysinfo is written</span>
</span><span id="create_sysinfo-914"><a href="#create_sysinfo-914"><span class="linenos">914</span></a>
</span><span id="create_sysinfo-915"><a href="#create_sysinfo-915"><span class="linenos">915</span></a><span class="sd">	Returns:</span>
</span><span id="create_sysinfo-916"><a href="#create_sysinfo-916"><span class="linenos">916</span></a>
</span><span id="create_sysinfo-917"><a href="#create_sysinfo-917"><span class="linenos">917</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="create_sysinfo-918"><a href="#create_sysinfo-918"><span class="linenos">918</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">read_coord_file</span><span class="p">(</span><span class="s1">&#39;coord&#39;</span><span class="p">)</span>
</span><span id="create_sysinfo-919"><a href="#create_sysinfo-919"><span class="linenos">919</span></a>	<span class="c1"># number of atoms:</span>
</span><span id="create_sysinfo-920"><a href="#create_sysinfo-920"><span class="linenos">920</span></a>	<span class="n">natoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="create_sysinfo-921"><a href="#create_sysinfo-921"><span class="linenos">921</span></a>	<span class="c1"># split cd into position array and element vector</span>
</span><span id="create_sysinfo-922"><a href="#create_sysinfo-922"><span class="linenos">922</span></a>	<span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="create_sysinfo-923"><a href="#create_sysinfo-923"><span class="linenos">923</span></a>	<span class="n">el</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="create_sysinfo-924"><a href="#create_sysinfo-924"><span class="linenos">924</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
</span><span id="create_sysinfo-925"><a href="#create_sysinfo-925"><span class="linenos">925</span></a>		<span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span><span id="create_sysinfo-926"><a href="#create_sysinfo-926"><span class="linenos">926</span></a>		<span class="n">el</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
</span><span id="create_sysinfo-927"><a href="#create_sysinfo-927"><span class="linenos">927</span></a>
</span><span id="create_sysinfo-928"><a href="#create_sysinfo-928"><span class="linenos">928</span></a>	<span class="c1"># make list from dictionary from list el</span>
</span><span id="create_sysinfo-929"><a href="#create_sysinfo-929"><span class="linenos">929</span></a>	<span class="c1"># --&gt; get rid of the douplicates</span>
</span><span id="create_sysinfo-930"><a href="#create_sysinfo-930"><span class="linenos">930</span></a>	<span class="c1"># eldif is a list of all different elements in coord</span>
</span><span id="create_sysinfo-931"><a href="#create_sysinfo-931"><span class="linenos">931</span></a>	<span class="n">eldif</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">el</span><span class="p">))</span>
</span><span id="create_sysinfo-932"><a href="#create_sysinfo-932"><span class="linenos">932</span></a>	<span class="c1"># dictionary for Number of orbitals:</span>
</span><span id="create_sysinfo-933"><a href="#create_sysinfo-933"><span class="linenos">933</span></a>	<span class="n">Norb_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">eldif</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="create_sysinfo-934"><a href="#create_sysinfo-934"><span class="linenos">934</span></a>	<span class="c1"># dictionary for Number of ECP-electrons:</span>
</span><span id="create_sysinfo-935"><a href="#create_sysinfo-935"><span class="linenos">935</span></a>	<span class="n">Necp_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">eldif</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="create_sysinfo-936"><a href="#create_sysinfo-936"><span class="linenos">936</span></a>
</span><span id="create_sysinfo-937"><a href="#create_sysinfo-937"><span class="linenos">937</span></a>	<span class="k">for</span> <span class="n">elkind</span> <span class="ow">in</span> <span class="n">eldif</span><span class="p">:</span>
</span><span id="create_sysinfo-938"><a href="#create_sysinfo-938"><span class="linenos">938</span></a>		<span class="n">nf</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="create_sysinfo-939"><a href="#create_sysinfo-939"><span class="linenos">939</span></a>		<span class="c1"># the space in searchstr is to avoid additional findings (e.g. for s)</span>
</span><span id="create_sysinfo-940"><a href="#create_sysinfo-940"><span class="linenos">940</span></a>		<span class="n">searchstr</span> <span class="o">=</span> <span class="n">elkind</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
</span><span id="create_sysinfo-941"><a href="#create_sysinfo-941"><span class="linenos">941</span></a>		<span class="c1"># search for element in file &#39;basis&#39;</span>
</span><span id="create_sysinfo-942"><a href="#create_sysinfo-942"><span class="linenos">942</span></a>		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;basis&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
</span><span id="create_sysinfo-943"><a href="#create_sysinfo-943"><span class="linenos">943</span></a>			<span class="n">lines</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="create_sysinfo-944"><a href="#create_sysinfo-944"><span class="linenos">944</span></a>			<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="create_sysinfo-945"><a href="#create_sysinfo-945"><span class="linenos">945</span></a>				<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">searchstr</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="create_sysinfo-946"><a href="#create_sysinfo-946"><span class="linenos">946</span></a>					<span class="n">nf</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="create_sysinfo-947"><a href="#create_sysinfo-947"><span class="linenos">947</span></a>					<span class="k">if</span> <span class="p">(</span><span class="n">nf</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="create_sysinfo-948"><a href="#create_sysinfo-948"><span class="linenos">948</span></a>						<span class="c1"># first occurence: name of basis set</span>
</span><span id="create_sysinfo-949"><a href="#create_sysinfo-949"><span class="linenos">949</span></a>						<span class="k">continue</span>
</span><span id="create_sysinfo-950"><a href="#create_sysinfo-950"><span class="linenos">950</span></a>					<span class="k">if</span> <span class="p">(</span><span class="n">nf</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="create_sysinfo-951"><a href="#create_sysinfo-951"><span class="linenos">951</span></a>						<span class="c1"># second occurence electron configuration per atom</span>
</span><span id="create_sysinfo-952"><a href="#create_sysinfo-952"><span class="linenos">952</span></a>						<span class="c1"># this might look weird but leads to the part</span>
</span><span id="create_sysinfo-953"><a href="#create_sysinfo-953"><span class="linenos">953</span></a>						<span class="c1"># inside the []-brackets</span>
</span><span id="create_sysinfo-954"><a href="#create_sysinfo-954"><span class="linenos">954</span></a>						<span class="n">config</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="create_sysinfo-955"><a href="#create_sysinfo-955"><span class="linenos">955</span></a>						<span class="n">Norb_dict</span><span class="p">[</span><span class="n">elkind</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_norb_from_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="create_sysinfo-956"><a href="#create_sysinfo-956"><span class="linenos">956</span></a>					<span class="k">if</span> <span class="p">(</span><span class="n">nf</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
</span><span id="create_sysinfo-957"><a href="#create_sysinfo-957"><span class="linenos">957</span></a>						<span class="c1"># third occurence: information on core-potential</span>
</span><span id="create_sysinfo-958"><a href="#create_sysinfo-958"><span class="linenos">958</span></a>						<span class="c1"># number of core electrons is 2 lines after that</span>
</span><span id="create_sysinfo-959"><a href="#create_sysinfo-959"><span class="linenos">959</span></a>						<span class="n">nl_ecp</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span id="create_sysinfo-960"><a href="#create_sysinfo-960"><span class="linenos">960</span></a>						<span class="c1"># get number of core electrons</span>
</span><span id="create_sysinfo-961"><a href="#create_sysinfo-961"><span class="linenos">961</span></a>						<span class="n">N_ecp</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">nl_ecp</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="create_sysinfo-962"><a href="#create_sysinfo-962"><span class="linenos">962</span></a>						<span class="c1"># save this number in corresponding dictionary</span>
</span><span id="create_sysinfo-963"><a href="#create_sysinfo-963"><span class="linenos">963</span></a>						<span class="n">Necp_dict</span><span class="p">[</span><span class="n">elkind</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_ecp</span>
</span><span id="create_sysinfo-964"><a href="#create_sysinfo-964"><span class="linenos">964</span></a>
</span><span id="create_sysinfo-965"><a href="#create_sysinfo-965"><span class="linenos">965</span></a>	<span class="n">iorb</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="create_sysinfo-966"><a href="#create_sysinfo-966"><span class="linenos">966</span></a>	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="create_sysinfo-967"><a href="#create_sysinfo-967"><span class="linenos">967</span></a>		<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">natoms</span><span class="si">:</span><span class="s2">&gt;22</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="create_sysinfo-968"><a href="#create_sysinfo-968"><span class="linenos">968</span></a>		<span class="k">for</span> <span class="n">iat</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
</span><span id="create_sysinfo-969"><a href="#create_sysinfo-969"><span class="linenos">969</span></a>			<span class="n">atomic_number</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">ATOM_DICT_SYM</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="create_sysinfo-970"><a href="#create_sysinfo-970"><span class="linenos">970</span></a>			<span class="n">charge</span> <span class="o">=</span> <span class="n">atomic_number</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">Necp_dict</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]])</span>
</span><span id="create_sysinfo-971"><a href="#create_sysinfo-971"><span class="linenos">971</span></a>			<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">iat</span><span class="o">+</span><span class="mi">1</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">iorb</span> <span class="o">+</span> <span class="mi">1</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">iorb</span> <span class="o">+</span> <span class="n">Norb_dict</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]]</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">charge</span><span class="si">:</span><span class="s2">&gt;24.12f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">Necp_dict</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]]</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pos</span><span class="p">[</span><span class="n">iat</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;24</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pos</span><span class="p">[</span><span class="n">iat</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;24</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">pos</span><span class="p">[</span><span class="n">iat</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;24</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="create_sysinfo-972"><a href="#create_sysinfo-972"><span class="linenos">972</span></a>			<span class="n">iorb</span> <span class="o">=</span> <span class="n">iorb</span> <span class="o">+</span> <span class="n">Norb_dict</span><span class="p">[</span><span class="n">el</span><span class="p">[</span><span class="n">iat</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>Create sysinfo according to given template. Sysinfo is used for transport calculations used by Theo 1 Group of
University of Augsburg. It contains information about the orbitals, the charge, number of ecps and the coordinates of the positions
{number atom} {orbital_index_start} {orbital_index_end} {charge} {number ecps} {x in Bohr} {y in Bohr} {z in Bohr}</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord_path (String):</strong>  Path to turbomole coord file</li>
<li><strong>basis_path (String):</strong>  Path to turbomole basis file</li>
<li><strong>output_path (String):</strong>  Path where sysinfo is written</li>
</ul>

<p>Returns:</p>
</div>


                </section>
                <section id="get_norb_from_config">
                            <input id="get_norb_from_config-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_norb_from_config</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">config</span></span>)</span>

                <label class="view-source-button" for="get_norb_from_config-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_norb_from_config"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_norb_from_config-974"><a href="#get_norb_from_config-974"><span class="linenos">974</span></a><span class="k">def</span> <span class="nf">get_norb_from_config</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
</span><span id="get_norb_from_config-975"><a href="#get_norb_from_config-975"><span class="linenos">975</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_norb_from_config-976"><a href="#get_norb_from_config-976"><span class="linenos">976</span></a><span class="sd">	Get number of orbitals from turbomole config string (for example [6s3p2d])</span>
</span><span id="get_norb_from_config-977"><a href="#get_norb_from_config-977"><span class="linenos">977</span></a><span class="sd">	Args:</span>
</span><span id="get_norb_from_config-978"><a href="#get_norb_from_config-978"><span class="linenos">978</span></a><span class="sd">		config (String): configuration string</span>
</span><span id="get_norb_from_config-979"><a href="#get_norb_from_config-979"><span class="linenos">979</span></a>
</span><span id="get_norb_from_config-980"><a href="#get_norb_from_config-980"><span class="linenos">980</span></a><span class="sd">	Returns:</span>
</span><span id="get_norb_from_config-981"><a href="#get_norb_from_config-981"><span class="linenos">981</span></a><span class="sd">		Norb (int): Number of orbitals</span>
</span><span id="get_norb_from_config-982"><a href="#get_norb_from_config-982"><span class="linenos">982</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="get_norb_from_config-983"><a href="#get_norb_from_config-983"><span class="linenos">983</span></a>	<span class="n">orbital_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span>
</span><span id="get_norb_from_config-984"><a href="#get_norb_from_config-984"><span class="linenos">984</span></a>	<span class="n">orbital_degeneracy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</span><span id="get_norb_from_config-985"><a href="#get_norb_from_config-985"><span class="linenos">985</span></a>	<span class="n">number_of_orbital_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_types</span><span class="p">))</span>
</span><span id="get_norb_from_config-986"><a href="#get_norb_from_config-986"><span class="linenos">986</span></a>
</span><span id="get_norb_from_config-987"><a href="#get_norb_from_config-987"><span class="linenos">987</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">orbital_types</span><span class="p">)):</span>
</span><span id="get_norb_from_config-988"><a href="#get_norb_from_config-988"><span class="linenos">988</span></a>		<span class="n">ns</span><span class="p">,</span> <span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">orbital_types</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="get_norb_from_config-989"><a href="#get_norb_from_config-989"><span class="linenos">989</span></a>		<span class="n">ns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
</span><span id="get_norb_from_config-990"><a href="#get_norb_from_config-990"><span class="linenos">990</span></a>		<span class="n">number_of_orbital_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ns</span>
</span><span id="get_norb_from_config-991"><a href="#get_norb_from_config-991"><span class="linenos">991</span></a>		<span class="k">if</span> <span class="n">config</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span><span id="get_norb_from_config-992"><a href="#get_norb_from_config-992"><span class="linenos">992</span></a>			<span class="k">break</span>
</span><span id="get_norb_from_config-993"><a href="#get_norb_from_config-993"><span class="linenos">993</span></a>	<span class="k">if</span> <span class="p">(</span><span class="n">config</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
</span><span id="get_norb_from_config-994"><a href="#get_norb_from_config-994"><span class="linenos">994</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is something wrong with this configuration&quot;</span><span class="p">)</span>
</span><span id="get_norb_from_config-995"><a href="#get_norb_from_config-995"><span class="linenos">995</span></a>
</span><span id="get_norb_from_config-996"><a href="#get_norb_from_config-996"><span class="linenos">996</span></a>	<span class="n">Norb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">number_of_orbital_types</span><span class="o">*</span><span class="n">orbital_degeneracy</span><span class="p">)</span>
</span><span id="get_norb_from_config-997"><a href="#get_norb_from_config-997"><span class="linenos">997</span></a>	<span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">Norb</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get number of orbitals from turbomole config string (for example [6s3p2d])</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>config (String):</strong>  configuration string</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>Norb (int): Number of orbitals</p>
</blockquote>
</div>


                </section>
                <section id="shift_xyz_coord">
                            <input id="shift_xyz_coord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">shift_xyz_coord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_xyz</span>, </span><span class="param"><span class="n">x_shift</span>, </span><span class="param"><span class="n">y_shift</span>, </span><span class="param"><span class="n">z_shift</span></span>)</span>

                <label class="view-source-button" for="shift_xyz_coord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#shift_xyz_coord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="shift_xyz_coord-999"><a href="#shift_xyz_coord-999"><span class="linenos"> 999</span></a><span class="k">def</span> <span class="nf">shift_xyz_coord</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">,</span> <span class="n">x_shift</span><span class="p">,</span> <span class="n">y_shift</span><span class="p">,</span> <span class="n">z_shift</span><span class="p">):</span>
</span><span id="shift_xyz_coord-1000"><a href="#shift_xyz_coord-1000"><span class="linenos">1000</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="shift_xyz_coord-1001"><a href="#shift_xyz_coord-1001"><span class="linenos">1001</span></a><span class="sd">	Shifts coordinates in coord file loaded with load_xyz_file.</span>
</span><span id="shift_xyz_coord-1002"><a href="#shift_xyz_coord-1002"><span class="linenos">1002</span></a><span class="sd">	Args:</span>
</span><span id="shift_xyz_coord-1003"><a href="#shift_xyz_coord-1003"><span class="linenos">1003</span></a><span class="sd">		coord_xyz: Coord file loaded with load_xyz_file</span>
</span><span id="shift_xyz_coord-1004"><a href="#shift_xyz_coord-1004"><span class="linenos">1004</span></a><span class="sd">		x_shift: x shift in Angstrom</span>
</span><span id="shift_xyz_coord-1005"><a href="#shift_xyz_coord-1005"><span class="linenos">1005</span></a><span class="sd">		y_shift: y shift in Angstrom</span>
</span><span id="shift_xyz_coord-1006"><a href="#shift_xyz_coord-1006"><span class="linenos">1006</span></a><span class="sd">		z_shift: z shift in Angstrom</span>
</span><span id="shift_xyz_coord-1007"><a href="#shift_xyz_coord-1007"><span class="linenos">1007</span></a>
</span><span id="shift_xyz_coord-1008"><a href="#shift_xyz_coord-1008"><span class="linenos">1008</span></a><span class="sd">	Returns:</span>
</span><span id="shift_xyz_coord-1009"><a href="#shift_xyz_coord-1009"><span class="linenos">1009</span></a><span class="sd">		coord_xyz: Shifted xyz coord file</span>
</span><span id="shift_xyz_coord-1010"><a href="#shift_xyz_coord-1010"><span class="linenos">1010</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="shift_xyz_coord-1011"><a href="#shift_xyz_coord-1011"><span class="linenos">1011</span></a>
</span><span id="shift_xyz_coord-1012"><a href="#shift_xyz_coord-1012"><span class="linenos">1012</span></a>	<span class="k">try</span><span class="p">:</span>
</span><span id="shift_xyz_coord-1013"><a href="#shift_xyz_coord-1013"><span class="linenos">1013</span></a>		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="shift_xyz_coord-1014"><a href="#shift_xyz_coord-1014"><span class="linenos">1014</span></a>			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;coord file is empty&quot;</span><span class="p">)</span>
</span><span id="shift_xyz_coord-1015"><a href="#shift_xyz_coord-1015"><span class="linenos">1015</span></a>	<span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="shift_xyz_coord-1016"><a href="#shift_xyz_coord-1016"><span class="linenos">1016</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is it a xyz file? </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="shift_xyz_coord-1017"><a href="#shift_xyz_coord-1017"><span class="linenos">1017</span></a>	<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="shift_xyz_coord-1018"><a href="#shift_xyz_coord-1018"><span class="linenos">1018</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is it a xyz file? </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="shift_xyz_coord-1019"><a href="#shift_xyz_coord-1019"><span class="linenos">1019</span></a>
</span><span id="shift_xyz_coord-1020"><a href="#shift_xyz_coord-1020"><span class="linenos">1020</span></a>
</span><span id="shift_xyz_coord-1021"><a href="#shift_xyz_coord-1021"><span class="linenos">1021</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])):</span>
</span><span id="shift_xyz_coord-1022"><a href="#shift_xyz_coord-1022"><span class="linenos">1022</span></a>		<span class="n">coord_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="n">x_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="shift_xyz_coord-1023"><a href="#shift_xyz_coord-1023"><span class="linenos">1023</span></a>		<span class="n">coord_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="n">y_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="shift_xyz_coord-1024"><a href="#shift_xyz_coord-1024"><span class="linenos">1024</span></a>		<span class="n">coord_xyz</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="n">z_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="shift_xyz_coord-1025"><a href="#shift_xyz_coord-1025"><span class="linenos">1025</span></a>	<span class="k">return</span> <span class="n">coord_xyz</span>
</span></pre></div>


            <div class="docstring"><p>Shifts coordinates in coord file loaded with load_xyz_file.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord_xyz:</strong>  Coord file loaded with load_xyz_file</li>
<li><strong>x_shift:</strong>  x shift in Angstrom</li>
<li><strong>y_shift:</strong>  y shift in Angstrom</li>
<li><strong>z_shift:</strong>  z shift in Angstrom</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>coord_xyz: Shifted xyz coord file</p>
</blockquote>
</div>


                </section>
                <section id="shift_coord_file">
                            <input id="shift_coord_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">shift_coord_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord</span>, </span><span class="param"><span class="n">x_shift</span>, </span><span class="param"><span class="n">y_shift</span>, </span><span class="param"><span class="n">z_shift</span></span>)</span>

                <label class="view-source-button" for="shift_coord_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#shift_coord_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="shift_coord_file-1027"><a href="#shift_coord_file-1027"><span class="linenos">1027</span></a><span class="k">def</span> <span class="nf">shift_coord_file</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">x_shift</span><span class="p">,</span> <span class="n">y_shift</span><span class="p">,</span> <span class="n">z_shift</span><span class="p">):</span>
</span><span id="shift_coord_file-1028"><a href="#shift_coord_file-1028"><span class="linenos">1028</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="shift_coord_file-1029"><a href="#shift_coord_file-1029"><span class="linenos">1029</span></a><span class="sd">	Shifts coordinates in coord file loaded with read_coord_file.</span>
</span><span id="shift_coord_file-1030"><a href="#shift_coord_file-1030"><span class="linenos">1030</span></a><span class="sd">	Args:</span>
</span><span id="shift_coord_file-1031"><a href="#shift_coord_file-1031"><span class="linenos">1031</span></a><span class="sd">		coord_xyz: Coord file loaded with read_coord_file</span>
</span><span id="shift_coord_file-1032"><a href="#shift_coord_file-1032"><span class="linenos">1032</span></a><span class="sd">		x_shift: x shift in Bohr</span>
</span><span id="shift_coord_file-1033"><a href="#shift_coord_file-1033"><span class="linenos">1033</span></a><span class="sd">		y_shift: y shift in Bohr</span>
</span><span id="shift_coord_file-1034"><a href="#shift_coord_file-1034"><span class="linenos">1034</span></a><span class="sd">		z_shift: z shift in Bohr</span>
</span><span id="shift_coord_file-1035"><a href="#shift_coord_file-1035"><span class="linenos">1035</span></a>
</span><span id="shift_coord_file-1036"><a href="#shift_coord_file-1036"><span class="linenos">1036</span></a><span class="sd">	Returns:</span>
</span><span id="shift_coord_file-1037"><a href="#shift_coord_file-1037"><span class="linenos">1037</span></a><span class="sd">		coord: Shifted coord file</span>
</span><span id="shift_coord_file-1038"><a href="#shift_coord_file-1038"><span class="linenos">1038</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="shift_coord_file-1039"><a href="#shift_coord_file-1039"><span class="linenos">1039</span></a>
</span><span id="shift_coord_file-1040"><a href="#shift_coord_file-1040"><span class="linenos">1040</span></a>	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="shift_coord_file-1041"><a href="#shift_coord_file-1041"><span class="linenos">1041</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;coord file is empty&quot;</span><span class="p">)</span>
</span><span id="shift_coord_file-1042"><a href="#shift_coord_file-1042"><span class="linenos">1042</span></a>
</span><span id="shift_coord_file-1043"><a href="#shift_coord_file-1043"><span class="linenos">1043</span></a>	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)):</span>
</span><span id="shift_coord_file-1044"><a href="#shift_coord_file-1044"><span class="linenos">1044</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">x_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="shift_coord_file-1045"><a href="#shift_coord_file-1045"><span class="linenos">1045</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">y_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="shift_coord_file-1046"><a href="#shift_coord_file-1046"><span class="linenos">1046</span></a>		<span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">z_shift</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="shift_coord_file-1047"><a href="#shift_coord_file-1047"><span class="linenos">1047</span></a>	<span class="k">return</span> <span class="n">coord</span>
</span></pre></div>


            <div class="docstring"><p>Shifts coordinates in coord file loaded with read_coord_file.</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord_xyz:</strong>  Coord file loaded with read_coord_file</li>
<li><strong>x_shift:</strong>  x shift in Bohr</li>
<li><strong>y_shift:</strong>  y shift in Bohr</li>
<li><strong>z_shift:</strong>  z shift in Bohr</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>coord: Shifted coord file</p>
</blockquote>
</div>


                </section>
                <section id="sort_xyz_coord">
                            <input id="sort_xyz_coord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sort_xyz_coord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord_xyz</span>, </span><span class="param"><span class="n">axis</span></span>)</span>

                <label class="view-source-button" for="sort_xyz_coord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sort_xyz_coord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sort_xyz_coord-1049"><a href="#sort_xyz_coord-1049"><span class="linenos">1049</span></a><span class="k">def</span> <span class="nf">sort_xyz_coord</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="sort_xyz_coord-1050"><a href="#sort_xyz_coord-1050"><span class="linenos">1050</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="sort_xyz_coord-1051"><a href="#sort_xyz_coord-1051"><span class="linenos">1051</span></a><span class="sd">	Sort coord_xyz according to axis (x=0, y=1, z=2)</span>
</span><span id="sort_xyz_coord-1052"><a href="#sort_xyz_coord-1052"><span class="linenos">1052</span></a><span class="sd">	Args:</span>
</span><span id="sort_xyz_coord-1053"><a href="#sort_xyz_coord-1053"><span class="linenos">1053</span></a><span class="sd">		coord_xyz: Coord file loaded with load_xyz_file</span>
</span><span id="sort_xyz_coord-1054"><a href="#sort_xyz_coord-1054"><span class="linenos">1054</span></a><span class="sd">		axis: Axis (x=0, y=1, z=2)</span>
</span><span id="sort_xyz_coord-1055"><a href="#sort_xyz_coord-1055"><span class="linenos">1055</span></a>
</span><span id="sort_xyz_coord-1056"><a href="#sort_xyz_coord-1056"><span class="linenos">1056</span></a><span class="sd">	Returns:</span>
</span><span id="sort_xyz_coord-1057"><a href="#sort_xyz_coord-1057"><span class="linenos">1057</span></a><span class="sd">		coord_xyz: Sorted coord_xyz</span>
</span><span id="sort_xyz_coord-1058"><a href="#sort_xyz_coord-1058"><span class="linenos">1058</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="sort_xyz_coord-1059"><a href="#sort_xyz_coord-1059"><span class="linenos">1059</span></a>	<span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</span><span id="sort_xyz_coord-1060"><a href="#sort_xyz_coord-1060"><span class="linenos">1060</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">):</span>
</span><span id="sort_xyz_coord-1061"><a href="#sort_xyz_coord-1061"><span class="linenos">1061</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Axis </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2"> not valid.&quot;</span><span class="p">)</span>
</span><span id="sort_xyz_coord-1062"><a href="#sort_xyz_coord-1062"><span class="linenos">1062</span></a>	<span class="n">coord_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)</span>
</span><span id="sort_xyz_coord-1063"><a href="#sort_xyz_coord-1063"><span class="linenos">1063</span></a>	<span class="n">coord_xyz</span> <span class="o">=</span> <span class="n">coord_xyz</span><span class="p">[</span><span class="n">coord_xyz</span><span class="p">[:,</span> <span class="n">axis</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
</span><span id="sort_xyz_coord-1064"><a href="#sort_xyz_coord-1064"><span class="linenos">1064</span></a>	<span class="n">coord_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coord_xyz</span><span class="p">)</span>
</span><span id="sort_xyz_coord-1065"><a href="#sort_xyz_coord-1065"><span class="linenos">1065</span></a>
</span><span id="sort_xyz_coord-1066"><a href="#sort_xyz_coord-1066"><span class="linenos">1066</span></a>	<span class="k">return</span> <span class="n">coord_xyz</span>
</span></pre></div>


            <div class="docstring"><p>Sort coord_xyz according to axis (x=0, y=1, z=2)</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord_xyz:</strong>  Coord file loaded with load_xyz_file</li>
<li><strong>axis:</strong>  Axis (x=0, y=1, z=2)</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>coord_xyz: Sorted coord_xyz</p>
</blockquote>
</div>


                </section>
                <section id="sort_coord">
                            <input id="sort_coord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sort_coord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coord</span>, </span><span class="param"><span class="n">axis</span></span>)</span>

                <label class="view-source-button" for="sort_coord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sort_coord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sort_coord-1068"><a href="#sort_coord-1068"><span class="linenos">1068</span></a><span class="k">def</span> <span class="nf">sort_coord</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
</span><span id="sort_coord-1069"><a href="#sort_coord-1069"><span class="linenos">1069</span></a>	<span class="sd">&quot;&quot;&quot;</span>
</span><span id="sort_coord-1070"><a href="#sort_coord-1070"><span class="linenos">1070</span></a><span class="sd">	Sort coord_xyz according to axis (x=0, y=1, z=2)</span>
</span><span id="sort_coord-1071"><a href="#sort_coord-1071"><span class="linenos">1071</span></a><span class="sd">	Args:</span>
</span><span id="sort_coord-1072"><a href="#sort_coord-1072"><span class="linenos">1072</span></a><span class="sd">		coord_xyz: Coord file loaded with load_xyz_file</span>
</span><span id="sort_coord-1073"><a href="#sort_coord-1073"><span class="linenos">1073</span></a><span class="sd">		axis: Axis (x=0, y=1, z=2)</span>
</span><span id="sort_coord-1074"><a href="#sort_coord-1074"><span class="linenos">1074</span></a>
</span><span id="sort_coord-1075"><a href="#sort_coord-1075"><span class="linenos">1075</span></a><span class="sd">	Returns:</span>
</span><span id="sort_coord-1076"><a href="#sort_coord-1076"><span class="linenos">1076</span></a><span class="sd">		coord_xyz: Sorted coord_xyz</span>
</span><span id="sort_coord-1077"><a href="#sort_coord-1077"><span class="linenos">1077</span></a><span class="sd">	&quot;&quot;&quot;</span>
</span><span id="sort_coord-1078"><a href="#sort_coord-1078"><span class="linenos">1078</span></a>	<span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</span><span id="sort_coord-1079"><a href="#sort_coord-1079"><span class="linenos">1079</span></a>	<span class="k">if</span><span class="p">(</span><span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed</span><span class="p">):</span>
</span><span id="sort_coord-1080"><a href="#sort_coord-1080"><span class="linenos">1080</span></a>		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Axis </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2"> not valid.&quot;</span><span class="p">)</span>
</span><span id="sort_coord-1081"><a href="#sort_coord-1081"><span class="linenos">1081</span></a>
</span><span id="sort_coord-1082"><a href="#sort_coord-1082"><span class="linenos">1082</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="sort_coord-1083"><a href="#sort_coord-1083"><span class="linenos">1083</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
</span><span id="sort_coord-1084"><a href="#sort_coord-1084"><span class="linenos">1084</span></a>	<span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
</span><span id="sort_coord-1085"><a href="#sort_coord-1085"><span class="linenos">1085</span></a>
</span><span id="sort_coord-1086"><a href="#sort_coord-1086"><span class="linenos">1086</span></a>	<span class="k">return</span> <span class="n">coord</span>
</span></pre></div>


            <div class="docstring"><p>Sort coord_xyz according to axis (x=0, y=1, z=2)</p>

<h6 id="args">Args</h6>

<ul>
<li><strong>coord_xyz:</strong>  Coord file loaded with load_xyz_file</li>
<li><strong>axis:</strong>  Axis (x=0, y=1, z=2)</li>
</ul>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>coord_xyz: Sorted coord_xyz</p>
</blockquote>
</div>


                </section>
    </main>
</body>
</html>